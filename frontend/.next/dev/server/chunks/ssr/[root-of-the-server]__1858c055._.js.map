{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/ted/vivid/frontend/src/components/canvas/CustomNodes.tsx"],"sourcesContent":["\"use client\";\n\nimport { memo } from \"react\";\nimport { Handle, Node, NodeProps, Position } from \"@xyflow/react\";\nimport {\n  Cpu,\n  Database,\n  FileCode,\n  FileInput,\n  FileOutput,\n  Lock,\n  Palette,\n  Settings,\n  Sparkles,\n  Workflow,\n} from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\n// Utility for cleaner classes\nfunction cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport type CanvasNodeKind =\n  | \"input\"\n  | \"style\"\n  | \"customization\"\n  | \"processing\"\n  | \"output\"\n  | \"capsule\";\n\nexport interface CanvasNodeData extends Record<string, unknown> {\n  label: string;\n  subtitle?: string;\n  // Optional: override icon or add explicit status\n  status?: \"idle\" | \"running\" | \"error\" | \"success\";\n  // Capsule node specific\n  capsuleId?: string;\n  capsuleVersion?: string;\n  params?: Record<string, unknown>;\n  locked?: boolean;\n}\n\n// Visual configuration for each node type\nconst NODE_CONFIG: Record<\n  CanvasNodeKind,\n  {\n    icon: React.ElementType;\n    gradient: string;\n    glow: string;\n    text: string;\n    badge: string;\n  }\n> = {\n  input: {\n    icon: FileInput,\n    gradient: \"from-sky-400 to-blue-600\",\n    glow: \"shadow-sky-500/20\",\n    text: \"text-sky-100\",\n    badge: \"bg-sky-500/20 text-sky-200 border-sky-500/30\",\n  },\n  style: {\n    icon: Palette,\n    gradient: \"from-amber-300 to-orange-500\",\n    glow: \"shadow-amber-500/20\",\n    text: \"text-amber-100\",\n    badge: \"bg-amber-500/20 text-amber-200 border-amber-500/30\",\n  },\n  customization: {\n    icon: Settings,\n    gradient: \"from-slate-400 to-zinc-600\",\n    glow: \"shadow-slate-500/20\",\n    text: \"text-slate-100\",\n    badge: \"bg-slate-500/20 text-slate-200 border-slate-500/30\",\n  },\n  processing: {\n    icon: Sparkles,\n    gradient: \"from-fuchsia-400 to-purple-600\",\n    glow: \"shadow-purple-500/30\",\n    text: \"text-purple-100\",\n    badge: \"bg-purple-500/20 text-purple-200 border-purple-500/30\",\n  },\n  output: {\n    icon: FileOutput,\n    gradient: \"from-emerald-400 to-teal-600\",\n    glow: \"shadow-emerald-500/20\",\n    text: \"text-emerald-100\",\n    badge: \"bg-emerald-500/20 text-emerald-200 border-emerald-500/30\",\n  },\n  capsule: {\n    icon: Workflow,\n    gradient: \"from-rose-400 to-pink-600\",\n    glow: \"shadow-rose-500/30\",\n    text: \"text-rose-100\",\n    badge: \"bg-rose-500/20 text-rose-200 border-rose-500/30\",\n  },\n};\n\nfunction BaseNode({ data, type, selected }: NodeProps<Node<CanvasNodeData>>) {\n  const kind = (type as CanvasNodeKind) || \"customization\";\n  const config = NODE_CONFIG[kind];\n  const Icon = config.icon;\n\n  const canReceive = kind !== \"input\";\n  const canSend = kind !== \"output\";\n  const isCapsule = kind === \"capsule\";\n  const isLocked = isCapsule && Boolean(data.locked);\n  const status = data.status ?? \"idle\";\n  const statusLabel =\n    status === \"running\"\n      ? \"RUNNING\"\n      : status === \"success\"\n        ? \"DONE\"\n        : status === \"error\"\n          ? \"ERROR\"\n          : \"ACTIVE\";\n  const statusClass =\n    status === \"running\"\n      ? \"bg-amber-500/20 text-amber-200 border-amber-500/30\"\n      : status === \"success\"\n        ? \"bg-emerald-500/20 text-emerald-200 border-emerald-500/30\"\n        : status === \"error\"\n          ? \"bg-rose-500/20 text-rose-200 border-rose-500/30\"\n          : config.badge;\n\n  return (\n    <motion.div\n      initial={{ scale: 0.9, opacity: 0 }}\n      animate={{ scale: 1, opacity: 1 }}\n      whileHover={{ scale: 1.02, y: -2 }}\n      transition={{ duration: 0.2 }}\n      className={cn(\n        \"relative min-w-[240px] rounded-2xl border bg-slate-950/80 px-4 py-4 backdrop-blur-xl transition-all duration-300\",\n        selected\n          ? `border-transparent ring-2 ring-offset-2 ring-offset-slate-950 ring-${config.gradient.split(\"-\")[1]}-400`\n          : \"border-slate-800\",\n        config.glow,\n        selected && \"shadow-2xl\"\n      )}\n    >\n      {/* Gradient border effect via pseudo-element container if desired, or simple border for MVP */}\n      {selected && (\n        <div\n          className={cn(\n            \"absolute inset-0 -z-10 rounded-2xl opacity-20 bg-gradient-to-br\",\n            config.gradient\n          )}\n        />\n      )}\n\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-3\">\n        <div className=\"flex items-center gap-3\">\n          <div\n            className={cn(\n              \"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br shadow-inner\",\n              config.gradient\n            )}\n          >\n            <Icon className=\"h-4 w-4 text-white\" strokeWidth={2.5} />\n          </div>\n          <div>\n            <div\n              className={cn(\n                \"text-xs font-bold uppercase tracking-wider opacity-60\",\n                config.text\n              )}\n            >\n              {kind}\n            </div>\n            <div className=\"text-sm font-bold text-slate-100 leading-tight\">\n              {data.label}\n            </div>\n          </div>\n        </div>\n        {isCapsule && (\n          <div className=\"flex items-center gap-1 text-[10px] uppercase tracking-widest\">\n            <span className=\"rounded-full border border-rose-400/30 bg-rose-500/10 px-2 py-0.5 text-rose-200\">\n              Sealed\n            </span>\n            {isLocked && (\n              <span className=\"flex items-center gap-1 rounded-full border border-slate-400/30 bg-slate-500/10 px-2 py-0.5 text-slate-200\">\n                <Lock className=\"h-3 w-3\" />\n                Locked\n              </span>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Body / Content */}\n      {data.subtitle && (\n        <div className=\"mb-2 rounded-md bg-slate-900/50 px-3 py-2 text-xs font-medium text-slate-400\">\n          {data.subtitle}\n        </div>\n      )}\n\n      {/* Status indicator if needed */}\n      <div className=\"flex items-center justify-between mt-2\">\n        <span className={cn(\"px-2 py-0.5 rounded text-[10px] font-medium border\", statusClass)}>\n          {statusLabel}\n        </span>\n        {/* Could add processing spinners here */}\n      </div>\n\n      {/* Handles with improved styling */}\n      {canReceive && (\n        <Handle\n          type=\"target\"\n          position={Position.Left}\n          className={cn(\n            \"!h-4 !w-2 !rounded-full !border-2 !border-slate-950 transition-colors\",\n            \"bg-slate-400 hover:bg-white\"\n          )}\n        />\n      )}\n      {canSend && (\n        <Handle\n          type=\"source\"\n          position={Position.Right}\n          className={cn(\n            \"!h-4 !w-2 !rounded-full !border-2 !border-slate-950 transition-colors\",\n            \"bg-slate-400 hover:bg-white\"\n          )}\n        />\n      )}\n    </motion.div>\n  );\n}\n\nexport const CanvasNode = memo(BaseNode);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":["file:///Users/ted/vivid/frontend/src/lib/api.ts"],"sourcesContent":["import type { Edge, Node } from \"@xyflow/react\";\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || \"\";\n\ninterface ApiError {\n  detail?: string;\n}\n\nexport interface CanvasGraph {\n  nodes: Node[];\n  edges: Edge[];\n}\n\nexport interface Canvas {\n  id: string;\n  title: string;\n  graph_data: CanvasGraph;\n  is_public: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CanvasCreate {\n  title: string;\n  graph_data: CanvasGraph;\n  is_public?: boolean;\n}\n\nexport interface Template {\n  id: string;\n  slug: string;\n  title: string;\n  description: string;\n  tags: string[];\n  graph_data: CanvasGraph;\n  is_public: boolean;\n  preview_video_url?: string;\n}\n\nexport interface CapsuleSpec {\n  id: string;\n  capsule_key: string;\n  version: string;\n  display_name: string;\n  description: string;\n  spec: Record<string, unknown>;\n  is_active: boolean;\n}\n\nexport interface CapsuleRun {\n  run_id: string;\n  status: string;\n  summary: Record<string, unknown>;\n  evidence_refs: string[];\n  version: string;\n}\n\nexport interface CapsuleRunRequest {\n  canvas_id?: string;\n  node_id?: string;\n  capsule_id: string;\n  capsule_version: string;\n  inputs: Record<string, unknown>;\n  params: Record<string, unknown>;\n}\n\nexport interface ScenePreview {\n  scene_number: number;\n  composition: string;\n  dominant_color: string;\n  accent_color: string;\n  pacing_note: string;\n  duration_hint: string;\n}\n\nexport interface StoryboardPreview {\n  run_id: string;\n  capsule_id: string;\n  scenes: ScenePreview[];\n  palette: string[];\n  style_vector: number[];\n}\n\nclass ApiClient {\n  private async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      ...options,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...(options.headers || {}),\n      },\n    });\n\n    if (!response.ok) {\n      const error: ApiError = await response.json().catch(() => ({}));\n      throw new Error(error.detail || \"Request failed\");\n    }\n\n    return response.json();\n  }\n\n  async listCanvases(): Promise<Canvas[]> {\n    return this.request<Canvas[]>(\"/api/v1/canvases/\");\n  }\n\n  async createCanvas(data: CanvasCreate): Promise<Canvas> {\n    return this.request<Canvas>(\"/api/v1/canvases/\", {\n      method: \"POST\",\n      body: JSON.stringify(data),\n    });\n  }\n\n  async loadCanvas(id: string): Promise<Canvas> {\n    return this.request<Canvas>(`/api/v1/canvases/${id}`);\n  }\n\n  async updateCanvas(id: string, data: Partial<CanvasCreate>): Promise<Canvas> {\n    return this.request<Canvas>(`/api/v1/canvases/${id}`, {\n      method: \"PATCH\",\n      body: JSON.stringify(data),\n    });\n  }\n\n  async listTemplates(): Promise<Template[]> {\n    return this.request<Template[]>(\"/api/v1/templates/\");\n  }\n\n  async getTemplate(id: string): Promise<Template> {\n    return this.request<Template>(`/api/v1/templates/${id}`);\n  }\n\n  async createCanvasFromTemplate(templateId: string, title?: string): Promise<Canvas> {\n    return this.request<Canvas>(\"/api/v1/canvases/from-template\", {\n      method: \"POST\",\n      body: JSON.stringify({ template_id: templateId, title }),\n    });\n  }\n\n  async getCapsuleSpec(capsuleKey: string, version?: string): Promise<CapsuleSpec> {\n    const params = version ? `?version=${encodeURIComponent(version)}` : \"\";\n    return this.request<CapsuleSpec>(`/api/v1/capsules/${capsuleKey}${params}`);\n  }\n\n  async runCapsule(payload: CapsuleRunRequest): Promise<CapsuleRun> {\n    return this.request<CapsuleRun>(\"/api/v1/capsules/run\", {\n      method: \"POST\",\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async computeSpec(nodes: Node[], edges: Edge[]): Promise<{ spec: Record<string, unknown>; generated: boolean }> {\n    return this.request(\"/api/v1/spec/compute\", {\n      method: \"POST\",\n      body: JSON.stringify({ nodes, edges }),\n    });\n  }\n\n  async optimizeParams(\n    nodes: Node[],\n    edges: Edge[],\n    targetProfile: string = \"balanced\"\n  ): Promise<{\n    recommendations: Array<{\n      params: Record<string, unknown>;\n      fitness_score: number;\n      profile: string;\n    }>;\n  }> {\n    return this.request(\"/api/v1/spec/optimize\", {\n      method: \"POST\",\n      body: JSON.stringify({ nodes, edges, target_profile: targetProfile }),\n    });\n  }\n\n  async getStoryboardPreview(\n    capsuleKey: string,\n    runId: string,\n    sceneCount: number = 3\n  ): Promise<StoryboardPreview> {\n    return this.request<StoryboardPreview>(\n      `/api/v1/capsules/${capsuleKey}/runs/${runId}/preview?scene_count=${sceneCount}`\n    );\n  }\n}\n\nexport const api = new ApiClient();\n"],"names":[],"mappings":";;;;AAEA,MAAM,eAAe,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAiFxD,MAAM;IACJ,MAAc,QAAW,QAAgB,EAAE,UAAuB,CAAC,CAAC,EAAc;QAChF,MAAM,WAAW,MAAM,MAAM,GAAG,eAAe,UAAU,EAAE;YACzD,GAAG,OAAO;YACV,SAAS;gBACP,gBAAgB;gBAChB,GAAI,QAAQ,OAAO,IAAI,CAAC,CAAC;YAC3B;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,QAAkB,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7D,MAAM,IAAI,MAAM,MAAM,MAAM,IAAI;QAClC;QAEA,OAAO,SAAS,IAAI;IACtB;IAEA,MAAM,eAAkC;QACtC,OAAO,IAAI,CAAC,OAAO,CAAW;IAChC;IAEA,MAAM,aAAa,IAAkB,EAAmB;QACtD,OAAO,IAAI,CAAC,OAAO,CAAS,qBAAqB;YAC/C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,WAAW,EAAU,EAAmB;QAC5C,OAAO,IAAI,CAAC,OAAO,CAAS,CAAC,iBAAiB,EAAE,IAAI;IACtD;IAEA,MAAM,aAAa,EAAU,EAAE,IAA2B,EAAmB;QAC3E,OAAO,IAAI,CAAC,OAAO,CAAS,CAAC,iBAAiB,EAAE,IAAI,EAAE;YACpD,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,gBAAqC;QACzC,OAAO,IAAI,CAAC,OAAO,CAAa;IAClC;IAEA,MAAM,YAAY,EAAU,EAAqB;QAC/C,OAAO,IAAI,CAAC,OAAO,CAAW,CAAC,kBAAkB,EAAE,IAAI;IACzD;IAEA,MAAM,yBAAyB,UAAkB,EAAE,KAAc,EAAmB;QAClF,OAAO,IAAI,CAAC,OAAO,CAAS,kCAAkC;YAC5D,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE,aAAa;gBAAY;YAAM;QACxD;IACF;IAEA,MAAM,eAAe,UAAkB,EAAE,OAAgB,EAAwB;QAC/E,MAAM,SAAS,UAAU,CAAC,SAAS,EAAE,mBAAmB,UAAU,GAAG;QACrE,OAAO,IAAI,CAAC,OAAO,CAAc,CAAC,iBAAiB,EAAE,aAAa,QAAQ;IAC5E;IAEA,MAAM,WAAW,OAA0B,EAAuB;QAChE,OAAO,IAAI,CAAC,OAAO,CAAa,wBAAwB;YACtD,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACF;IAEA,MAAM,YAAY,KAAa,EAAE,KAAa,EAAkE;QAC9G,OAAO,IAAI,CAAC,OAAO,CAAC,wBAAwB;YAC1C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;YAAM;QACtC;IACF;IAEA,MAAM,eACJ,KAAa,EACb,KAAa,EACb,gBAAwB,UAAU,EAOjC;QACD,OAAO,IAAI,CAAC,OAAO,CAAC,yBAAyB;YAC3C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;gBAAO,gBAAgB;YAAc;QACrE;IACF;IAEA,MAAM,qBACJ,UAAkB,EAClB,KAAa,EACb,aAAqB,CAAC,EACM;QAC5B,OAAO,IAAI,CAAC,OAAO,CACjB,CAAC,iBAAiB,EAAE,WAAW,MAAM,EAAE,MAAM,qBAAqB,EAAE,YAAY;IAEpF;AACF;AAEO,MAAM,MAAM,IAAI"}},
    {"offset": {"line": 374, "column": 0}, "map": {"version":3,"sources":["file:///Users/ted/vivid/frontend/src/components/canvas/Inspector.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { Node } from \"@xyflow/react\";\nimport { CanvasNodeData } from \"./CustomNodes\";\nimport { api, CapsuleRun, CapsuleSpec } from \"@/lib/api\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { X, Trash2, Sliders, Play, Lock } from \"lucide-react\";\n\ninterface InspectorProps {\n  selectedNode: Node<CanvasNodeData> | null;\n  onClose: () => void;\n  onUpdate: (nodeId: string, data: Partial<CanvasNodeData>) => void;\n  onDelete?: (nodeId: string) => void;\n}\n\ntype CapsuleParamDef = {\n  type: \"enum\" | \"number\" | \"boolean\" | \"string\";\n  options?: string[];\n  min?: number;\n  max?: number;\n  step?: number;\n  default?: unknown;\n  visibility?: \"public\" | \"admin\";\n};\n\nexport function Inspector({\n  selectedNode,\n  onClose,\n  onUpdate,\n  onDelete,\n}: InspectorProps) {\n  const [capsuleSpec, setCapsuleSpec] = useState<CapsuleSpec | null>(null);\n  const [capsuleError, setCapsuleError] = useState<string | null>(null);\n  const [capsuleLoading, setCapsuleLoading] = useState(false);\n  const [runStatus, setRunStatus] = useState<\n    \"idle\" | \"running\" | \"success\" | \"error\"\n  >(\"idle\");\n  const [runError, setRunError] = useState<string | null>(null);\n  const [runResult, setRunResult] = useState<CapsuleRun | null>(null);\n\n  useEffect(() => {\n    if (!selectedNode || selectedNode.type !== \"capsule\" || !selectedNode.data.capsuleId) {\n      setCapsuleSpec(null);\n      setCapsuleError(null);\n      setCapsuleLoading(false);\n      return;\n    }\n\n    let isActive = true;\n    setCapsuleLoading(true);\n    setCapsuleError(null);\n\n    api\n      .getCapsuleSpec(\n        selectedNode.data.capsuleId,\n        selectedNode.data.capsuleVersion\n      )\n      .then((spec) => {\n        if (!isActive) return;\n        setCapsuleSpec(spec);\n      })\n      .catch((err) => {\n        if (!isActive) return;\n        setCapsuleError(err instanceof Error ? err.message : \"Failed to load capsule spec\");\n      })\n      .finally(() => {\n        if (isActive) setCapsuleLoading(false);\n      });\n\n    return () => {\n      isActive = false;\n    };\n  }, [selectedNode]);\n\n  useEffect(() => {\n    setRunStatus(\"idle\");\n    setRunError(null);\n    setRunResult(null);\n  }, [selectedNode?.id]);\n\n  const exposedParams = useMemo(() => {\n    const spec = capsuleSpec?.spec as { exposedParams?: Record<string, CapsuleParamDef> } | undefined;\n    return spec?.exposedParams || null;\n  }, [capsuleSpec]);\n\n  useEffect(() => {\n    if (!selectedNode || selectedNode.type !== \"capsule\" || !exposedParams) return;\n    if (selectedNode.data.params) return;\n\n    const defaults: Record<string, unknown> = {};\n    Object.entries(exposedParams).forEach(([key, def]) => {\n      if (def.default !== undefined) {\n        defaults[key] = def.default;\n        return;\n      }\n      if (def.type === \"number\") {\n        defaults[key] = typeof def.min === \"number\" ? def.min : 0;\n      } else if (def.type === \"enum\") {\n        defaults[key] = def.options?.[0] ?? \"\";\n      } else if (def.type === \"boolean\") {\n        defaults[key] = false;\n      } else {\n        defaults[key] = \"\";\n      }\n    });\n    onUpdate(selectedNode.id, { params: defaults });\n  }, [selectedNode, exposedParams, onUpdate]);\n\n  const params = selectedNode?.data?.params || {};\n  const capsuleVersion =\n    selectedNode?.data?.capsuleVersion || capsuleSpec?.version || \"latest\";\n\n  const handleRunCapsule = async () => {\n    if (!selectedNode || selectedNode.type !== \"capsule\" || !selectedNode.data.capsuleId) {\n      return;\n    }\n\n    setRunStatus(\"running\");\n    setRunError(null);\n    onUpdate(selectedNode.id, { status: \"running\" });\n\n    if (!selectedNode.data.capsuleVersion && capsuleSpec?.version) {\n      onUpdate(selectedNode.id, { capsuleVersion: capsuleSpec.version });\n    }\n\n    try {\n      const result = await api.runCapsule({\n        capsule_id: selectedNode.data.capsuleId,\n        capsule_version: capsuleVersion,\n        inputs: {},\n        params: params as Record<string, unknown>,\n        node_id: selectedNode.id,\n      });\n      setRunResult(result);\n      setRunStatus(\"success\");\n      onUpdate(selectedNode.id, { status: \"success\" });\n    } catch (err) {\n      setRunError(err instanceof Error ? err.message : \"Capsule run failed\");\n      setRunStatus(\"error\");\n      onUpdate(selectedNode.id, { status: \"error\" });\n    }\n  };\n\n  return (\n    <AnimatePresence>\n      {selectedNode && (\n        <motion.aside\n          initial={{ x: \"100%\", opacity: 0 }}\n          animate={{ x: 0, opacity: 1 }}\n          exit={{ x: \"100%\", opacity: 0 }}\n          transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n          className=\"absolute right-0 top-0 h-full w-80 border-l border-white/10 bg-slate-950/80 p-6 backdrop-blur-2xl shadow-2xl z-20\"\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between mb-8\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-sky-500/20 text-sky-400\">\n                <Sliders className=\"h-4 w-4\" />\n              </div>\n              <div>\n                <p className=\"text-[10px] font-bold uppercase tracking-widest text-slate-500\">\n                  Inspector\n                </p>\n                <p className=\"text-base font-bold text-slate-100 capitalize\">\n                  {selectedNode.type} Node\n                </p>\n              </div>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"rounded-full p-2 text-slate-400 hover:bg-white/5 hover:text-white transition-colors\"\n            >\n              <X className=\"h-4 w-4\" />\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Label Input */}\n            <div className=\"space-y-2\">\n              <label className=\"text-[10px] font-bold uppercase tracking-widest text-slate-500\">\n                Label\n              </label>\n              <input\n                className=\"w-full rounded-lg border border-white/10 bg-slate-900/50 px-3 py-2.5 text-sm text-slate-100 placeholder:text-slate-600 focus:border-sky-500/50 focus:outline-none focus:ring-1 focus:ring-sky-500/50 transition-all\"\n                value={selectedNode.data.label}\n                onChange={(event) =>\n                  onUpdate(selectedNode.id, { label: event.target.value })\n                }\n                placeholder=\"Node Label\"\n              />\n            </div>\n\n            {/* Subtitle Input */}\n            <div className=\"space-y-2\">\n              <label className=\"text-[10px] font-bold uppercase tracking-widest text-slate-500\">\n                Description\n              </label>\n              <textarea\n                className=\"w-full resize-none rounded-lg border border-white/10 bg-slate-900/50 px-3 py-2.5 text-sm text-slate-100 placeholder:text-slate-600 focus:border-sky-500/50 focus:outline-none focus:ring-1 focus:ring-sky-500/50 transition-all\"\n                rows={3}\n                value={selectedNode.data.subtitle || \"\"}\n                onChange={(event) =>\n                  onUpdate(selectedNode.id, { subtitle: event.target.value })\n                }\n                placeholder=\"Add a brief description...\"\n              />\n            </div>\n\n            {/* Read-only Metadata */}\n            <div className=\"rounded-lg bg-black/20 p-4 border border-white/5 space-y-2\">\n              <div className=\"flex justify-between text-xs\">\n                <span className=\"text-slate-500\">ID</span>\n                <span className=\"font-mono text-slate-300\">{selectedNode.id}</span>\n              </div>\n              <div className=\"flex justify-between text-xs\">\n                <span className=\"text-slate-500\">X, Y</span>\n                <span className=\"font-mono text-slate-300\">\n                  {Math.round(selectedNode.position.x)},{\" \"}\n                  {Math.round(selectedNode.position.y)}\n                </span>\n              </div>\n            </div>\n\n            {/* Capsule Node Params */}\n            {selectedNode.type === \"capsule\" && selectedNode.data.capsuleId && (\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"h-1 w-1 rounded-full bg-rose-400\" />\n                  <span className=\"text-[10px] font-bold uppercase tracking-widest text-rose-400\">\n                    Capsule Parameters\n                  </span>\n                </div>\n\n                <div className=\"rounded-lg border border-rose-500/20 bg-rose-500/5 p-4 space-y-3\">\n                  <div className=\"flex items-start gap-2 rounded-md border border-white/5 bg-black/20 px-3 py-2 text-[11px] text-slate-300\">\n                    <Lock className=\"mt-0.5 h-3 w-3 text-rose-300\" />\n                    <div>\n                      <div className=\"text-slate-200\">Sealed capsule. Internal chain is hidden.</div>\n                      {selectedNode.data.locked && (\n                        <div className=\"text-slate-400\">Template locked. Only exposed params are editable.</div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex justify-between text-xs\">\n                    <span className=\"text-slate-400\">Capsule</span>\n                    <span className=\"font-mono text-rose-200\">\n                      {selectedNode.data.capsuleId}\n                    </span>\n                  </div>\n                  {selectedNode.data.capsuleVersion && (\n                    <div className=\"flex justify-between text-xs\">\n                      <span className=\"text-slate-400\">Version</span>\n                      <span className=\"font-mono text-rose-200\">\n                        {String(selectedNode.data.capsuleVersion)}\n                      </span>\n                    </div>\n                  )}\n\n                  {capsuleLoading && (\n                    <div className=\"text-xs text-slate-400\">Loading capsule spec...</div>\n                  )}\n                  {capsuleError && (\n                    <div className=\"text-xs text-rose-300\">{capsuleError}</div>\n                  )}\n\n                  {/* Editable Params */}\n                  {exposedParams && (\n                    <div className=\"space-y-3 pt-2 border-t border-white/5\">\n                      {Object.entries(exposedParams).map(([key, def]) => (\n                        <div key={key} className=\"space-y-1\">\n                          <label className=\"text-[10px] font-medium text-slate-400 uppercase\">\n                            {key.replace(/_/g, \" \")}\n                          </label>\n                          {def.type === \"enum\" ? (\n                            <select\n                              value={String(params[key] ?? def.options?.[0] ?? \"\")}\n                              onChange={(e) =>\n                                onUpdate(selectedNode.id, {\n                                  params: {\n                                    ...params,\n                                    [key]: e.target.value,\n                                  },\n                                })\n                              }\n                              className=\"w-full rounded border border-white/10 bg-slate-900/50 px-2 py-1.5 text-xs text-slate-100\"\n                            >\n                              {(def.options || []).map((option) => (\n                                <option key={option} value={option}>\n                                  {option}\n                                </option>\n                              ))}\n                            </select>\n                          ) : def.type === \"boolean\" ? (\n                            <button\n                              onClick={() =>\n                                onUpdate(selectedNode.id, {\n                                  params: {\n                                    ...params,\n                                    [key]: !params[key],\n                                  },\n                                })\n                              }\n                              className={`w-full rounded border px-2 py-1.5 text-xs ${\n                                params[key]\n                                  ? \"border-emerald-400/40 bg-emerald-500/10 text-emerald-200\"\n                                  : \"border-white/10 bg-slate-900/50 text-slate-400\"\n                              }`}\n                            >\n                              {params[key] ? \"Enabled\" : \"Disabled\"}\n                            </button>\n                          ) : def.type === \"number\" ? (\n                            <input\n                              type=\"range\"\n                              min={def.min ?? 0}\n                              max={def.max ?? 1}\n                              step={def.step ?? 0.05}\n                              value={Number(params[key] ?? def.default ?? def.min ?? 0)}\n                              onChange={(e) =>\n                                onUpdate(selectedNode.id, {\n                                  params: {\n                                    ...params,\n                                    [key]: parseFloat(e.target.value),\n                                  },\n                                })\n                              }\n                              className=\"w-full accent-rose-400\"\n                            />\n                          ) : (\n                            <input\n                              type=\"text\"\n                              value={String(params[key] ?? \"\")}\n                              onChange={(e) =>\n                                onUpdate(selectedNode.id, {\n                                  params: {\n                                    ...params,\n                                    [key]: e.target.value,\n                                  },\n                                })\n                              }\n                              className=\"w-full rounded border border-white/10 bg-slate-900/50 px-2 py-1.5 text-xs text-slate-100\"\n                            />\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <button\n                    onClick={handleRunCapsule}\n                    disabled={runStatus === \"running\"}\n                    className=\"w-full rounded-lg border border-rose-500/30 bg-rose-500/10 px-3 py-2 text-xs font-semibold text-rose-100 hover:bg-rose-500/20 transition-colors disabled:opacity-50 flex items-center justify-center gap-2\"\n                  >\n                    {runStatus === \"running\" ? (\n                      <span className=\"h-4 w-4 animate-spin rounded-full border-2 border-rose-200 border-t-transparent\" />\n                    ) : (\n                      <Play className=\"h-4 w-4\" />\n                    )}\n                    {runStatus === \"running\" ? \"Running...\" : \"Run Capsule\"}\n                  </button>\n                  {runError && <div className=\"text-xs text-rose-300\">{runError}</div>}\n                  {runResult && (\n                    <div className=\"rounded-lg border border-emerald-500/20 bg-emerald-500/5 p-3 text-xs\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"font-semibold text-emerald-200\">Run Summary</span>\n                        <span className=\"text-slate-400 uppercase\">{runResult.status}</span>\n                      </div>\n                      <div className=\"mt-2 text-slate-200\">\n                        {String(runResult.summary?.message ?? \"Capsule executed\")}\n                      </div>\n                      <div className=\"mt-2 text-[10px] text-slate-400\">\n                        Run ID: {runResult.run_id}\n                      </div>\n                      <div className=\"mt-1 text-[10px] text-slate-500\">\n                        Evidence refs: {runResult.evidence_refs?.length ?? 0}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Footer Actions */}\n          <div className=\"absolute bottom-6 left-6 right-6\">\n            {onDelete && (\n              <button\n                onClick={() => onDelete(selectedNode.id)}\n                className=\"group flex w-full items-center justify-center gap-2 rounded-lg border border-rose-500/20 bg-rose-500/10 px-4 py-3 text-sm font-semibold text-rose-200 hover:bg-rose-500/20 hover:border-rose-500/30 transition-all\"\n              >\n                <Trash2 className=\"h-4 w-4 opacity-70 group-hover:opacity-100\" />\n                Delete Node\n              </button>\n            )}\n          </div>\n        </motion.aside>\n      )}\n    </AnimatePresence>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1115, "column": 0}, "map": {"version":3,"sources":["file:///Users/ted/vivid/frontend/src/hooks/useUndoRedo.ts"],"sourcesContent":["import { useCallback, useState } from \"react\";\nimport { Edge, Node } from \"@xyflow/react\";\n\ninterface HistoryState {\n  nodes: Node[];\n  edges: Edge[];\n}\n\nexport function useUndoRedo() {\n  const [past, setPast] = useState<HistoryState[]>([]);\n  const [future, setFuture] = useState<HistoryState[]>([]);\n\n  const takeSnapshot = useCallback((nodes: Node[], edges: Edge[]) => {\n    setPast((old) => {\n      const newPast = [\n        ...old,\n        {\n          nodes: nodes.map((node) => ({ ...node })),\n          edges: edges.map((edge) => ({ ...edge })),\n        },\n      ];\n      if (newPast.length > 50) newPast.shift();\n      return newPast;\n    });\n    setFuture([]);\n  }, []);\n\n  const undo = useCallback(\n    (currentNodes: Node[], currentEdges: Edge[]) => {\n      if (past.length === 0) return null;\n\n      const newPast = [...past];\n      const previousState = newPast.pop();\n      if (!previousState) return null;\n\n      setPast(newPast);\n      setFuture((old) => [{ nodes: currentNodes, edges: currentEdges }, ...old]);\n      return previousState;\n    },\n    [past]\n  );\n\n  const redo = useCallback(\n    (currentNodes: Node[], currentEdges: Edge[]) => {\n      if (future.length === 0) return null;\n\n      const newFuture = [...future];\n      const nextState = newFuture.shift();\n      if (!nextState) return null;\n\n      setFuture(newFuture);\n      setPast((old) => [...old, { nodes: currentNodes, edges: currentEdges }]);\n      return nextState;\n    },\n    [future]\n  );\n\n  return {\n    takeSnapshot,\n    undo,\n    redo,\n    canUndo: past.length > 0,\n    canRedo: future.length > 0,\n    pastDepth: past.length,\n  };\n}\n"],"names":[],"mappings":";;;;AAAA;;AAQO,SAAS;IACd,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAiB,EAAE;IACnD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAiB,EAAE;IAEvD,MAAM,eAAe,IAAA,oNAAW,EAAC,CAAC,OAAe;QAC/C,QAAQ,CAAC;YACP,MAAM,UAAU;mBACX;gBACH;oBACE,OAAO,MAAM,GAAG,CAAC,CAAC,OAAS,CAAC;4BAAE,GAAG,IAAI;wBAAC,CAAC;oBACvC,OAAO,MAAM,GAAG,CAAC,CAAC,OAAS,CAAC;4BAAE,GAAG,IAAI;wBAAC,CAAC;gBACzC;aACD;YACD,IAAI,QAAQ,MAAM,GAAG,IAAI,QAAQ,KAAK;YACtC,OAAO;QACT;QACA,UAAU,EAAE;IACd,GAAG,EAAE;IAEL,MAAM,OAAO,IAAA,oNAAW,EACtB,CAAC,cAAsB;QACrB,IAAI,KAAK,MAAM,KAAK,GAAG,OAAO;QAE9B,MAAM,UAAU;eAAI;SAAK;QACzB,MAAM,gBAAgB,QAAQ,GAAG;QACjC,IAAI,CAAC,eAAe,OAAO;QAE3B,QAAQ;QACR,UAAU,CAAC,MAAQ;gBAAC;oBAAE,OAAO;oBAAc,OAAO;gBAAa;mBAAM;aAAI;QACzE,OAAO;IACT,GACA;QAAC;KAAK;IAGR,MAAM,OAAO,IAAA,oNAAW,EACtB,CAAC,cAAsB;QACrB,IAAI,OAAO,MAAM,KAAK,GAAG,OAAO;QAEhC,MAAM,YAAY;eAAI;SAAO;QAC7B,MAAM,YAAY,UAAU,KAAK;QACjC,IAAI,CAAC,WAAW,OAAO;QAEvB,UAAU;QACV,QAAQ,CAAC,MAAQ;mBAAI;gBAAK;oBAAE,OAAO;oBAAc,OAAO;gBAAa;aAAE;QACvE,OAAO;IACT,GACA;QAAC;KAAO;IAGV,OAAO;QACL;QACA;QACA;QACA,SAAS,KAAK,MAAM,GAAG;QACvB,SAAS,OAAO,MAAM,GAAG;QACzB,WAAW,KAAK,MAAM;IACxB;AACF"}},
    {"offset": {"line": 1193, "column": 0}, "map": {"version":3,"sources":["file:///Users/ted/vivid/frontend/src/app/canvas/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useSearchParams } from \"next/navigation\";\nimport {\n  ReactFlow,\n  addEdge,\n  Background,\n  Connection,\n  Controls,\n  Edge,\n  Node,\n  ReactFlowProvider,\n  useEdgesState,\n  useNodesState,\n  Panel,\n} from \"@xyflow/react\";\nimport \"@xyflow/react/dist/style.css\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport {\n  Save,\n  FolderOpen,\n  Plus,\n  Undo,\n  Redo,\n  Share2,\n  MoreHorizontal,\n  MousePointer2,\n  Maximize2,\n  ZoomIn,\n  ZoomOut,\n  Play,\n  Box,\n  X,\n} from \"lucide-react\";\n\nimport {\n  CanvasNode,\n  CanvasNodeData,\n  CanvasNodeKind,\n} from \"@/components/canvas/CustomNodes\";\nimport { Inspector } from \"@/components/canvas/Inspector\";\nimport { api, Canvas } from \"@/lib/api\";\nimport { useUndoRedo } from \"@/hooks/useUndoRedo\";\n\n// @ts-ignore - nodeTypes typing is strict with generics\nconst nodeTypes = {\n  input: CanvasNode,\n  style: CanvasNode,\n  customization: CanvasNode,\n  processing: CanvasNode,\n  output: CanvasNode,\n  capsule: CanvasNode,\n};\n\nconst initialNodes: Node<CanvasNodeData>[] = [\n  {\n    id: \"input-1\",\n    type: \"input\",\n    position: { x: 100, y: 300 },\n    data: { label: \"Prompt Input\", subtitle: \"User request\" },\n  },\n  {\n    id: \"processing-1\",\n    type: \"processing\",\n    position: { x: 450, y: 300 },\n    data: { label: \"Reasoning Core\", subtitle: \"LLM + GA\" },\n  },\n  {\n    id: \"output-1\",\n    type: \"output\",\n    position: { x: 800, y: 300 },\n    data: { label: \"Final Response\", subtitle: \"Rendered Output\" },\n  },\n];\n\nconst initialEdges: Edge[] = [];\n\nconst createNodeId = () => {\n  if (typeof crypto !== \"undefined\" && \"randomUUID\" in crypto) {\n    return crypto.randomUUID();\n  }\n  return `node-${Date.now()}`;\n};\n\nfunction CanvasFlow() {\n  const searchParams = useSearchParams();\n  const urlCanvasId = searchParams.get(\"id\");\n\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);\n  const [selectedNode, setSelectedNode] = useState<Node<CanvasNodeData> | null>(\n    null\n  );\n\n  const [canvasId, setCanvasId] = useState<string | null>(null);\n  const [title, setTitle] = useState(\"Untitled Project\");\n  const [isPublic, setIsPublic] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [canvases, setCanvases] = useState<Canvas[]>([]);\n  const [showLoadModal, setShowLoadModal] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isOptimizing, setIsOptimizing] = useState(false);\n  const [recommendations, setRecommendations] = useState<\n    Array<{\n      params: Record<string, unknown>;\n      fitness_score: number;\n      profile: string;\n    }>\n  >([]);\n  const [showRecommendations, setShowRecommendations] = useState(false);\n\n  const { takeSnapshot, undo, redo, canUndo, canRedo } = useUndoRedo();\n\n  const handleRun = useCallback(async () => {\n    setIsOptimizing(true);\n    setError(null);\n    try {\n      const result = await api.optimizeParams(nodes, edges, \"balanced\");\n      setRecommendations(result.recommendations);\n      setShowRecommendations(true);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Optimization failed\");\n    } finally {\n      setIsOptimizing(false);\n    }\n  }, [nodes, edges]);\n\n  const applyRecommendation = useCallback(\n    (params: Record<string, unknown>) => {\n      // Find capsule nodes and update their params\n      const nextNodes = nodes.map((node) => {\n        if (node.type === \"capsule\") {\n          return {\n            ...node,\n            data: {\n              ...node.data,\n              params: { ...node.data.params, ...params },\n            },\n          };\n        }\n        return node;\n      });\n      setNodes(nextNodes);\n      takeSnapshot(nextNodes, edges);\n      setShowRecommendations(false);\n    },\n    [nodes, edges, setNodes, takeSnapshot]\n  );\n\n  // Load canvas from URL param (from template flow)\n  useEffect(() => {\n    if (urlCanvasId && !canvasId) {\n      setIsLoading(true);\n      api.loadCanvas(urlCanvasId)\n        .then((loaded) => {\n          setCanvasId(loaded.id);\n          setTitle(loaded.title);\n          setIsPublic(loaded.is_public);\n          setNodes(loaded.graph_data.nodes as Node<CanvasNodeData>[]);\n          setEdges(loaded.graph_data.edges);\n          takeSnapshot(loaded.graph_data.nodes, loaded.graph_data.edges);\n        })\n        .catch((err) => {\n          setError(err instanceof Error ? err.message : \"Failed to load canvas\");\n        })\n        .finally(() => setIsLoading(false));\n    }\n  }, [urlCanvasId, canvasId, setNodes, setEdges, takeSnapshot]);\n\n  // Initial snapshot (only if not loading from URL)\n  useEffect(() => {\n    if (!urlCanvasId) {\n      takeSnapshot(initialNodes, initialEdges);\n    }\n  }, [takeSnapshot, urlCanvasId]);\n\n  const onConnect = useCallback(\n    (connection: Connection) => {\n      setEdges((eds) => {\n        const nextEdges = addEdge(\n          {\n            ...connection,\n            animated: true,\n            style: { stroke: \"#38bdf8\", strokeWidth: 2.5 },\n          },\n          eds\n        );\n        takeSnapshot(nodes, nextEdges);\n        return nextEdges;\n      });\n    },\n    [nodes, setEdges, takeSnapshot]\n  );\n\n  const handleAddNode = useCallback(\n    (kind: CanvasNodeKind) => {\n      const newNode: Node<CanvasNodeData> = {\n        id: createNodeId(),\n        type: kind,\n        position: {\n          x: 400 + Math.random() * 100,\n          y: 300 + Math.random() * 100,\n        },\n        data: {\n          label: `New ${kind}`,\n          subtitle: \"Configure in inspector\",\n        },\n      };\n      const nextNodes = [...nodes, newNode];\n      setNodes(nextNodes);\n      takeSnapshot(nextNodes, edges);\n    },\n    [edges, nodes, setNodes, takeSnapshot]\n  );\n\n  const handleUndo = useCallback(() => {\n    const previous = undo(nodes, edges);\n    if (previous) {\n      setNodes(previous.nodes as Node<CanvasNodeData>[]);\n      setEdges(previous.edges);\n    }\n  }, [undo, nodes, edges, setNodes, setEdges]);\n\n  const handleRedo = useCallback(() => {\n    const next = redo(nodes, edges);\n    if (next) {\n      setNodes(next.nodes as Node<CanvasNodeData>[]);\n      setEdges(next.edges);\n    }\n  }, [redo, nodes, edges, setNodes, setEdges]);\n\n  const handleUpdateNode = useCallback(\n    (nodeId: string, data: Partial<CanvasNodeData>) => {\n      const nextNodes = nodes.map((node) =>\n        node.id === nodeId\n          ? { ...node, data: { ...node.data, ...data } }\n          : node\n      );\n      setNodes(nextNodes);\n      setSelectedNode((current) =>\n        current && current.id === nodeId\n          ? ({ ...current, data: { ...current.data, ...data } } as Node<CanvasNodeData>)\n          : current\n      );\n    },\n    [nodes, setNodes]\n  );\n\n  const handleDeleteNode = useCallback(\n    (nodeId: string) => {\n      const nextNodes = nodes.filter((node) => node.id !== nodeId);\n      const nextEdges = edges.filter(\n        (edge) => edge.source !== nodeId && edge.target !== nodeId\n      );\n      setNodes(nextNodes);\n      setEdges(nextEdges);\n      setSelectedNode(null);\n      takeSnapshot(nextNodes, nextEdges);\n    },\n    [edges, nodes, setEdges, setNodes, takeSnapshot]\n  );\n\n  const handleSave = useCallback(async () => {\n    setIsSaving(true);\n    setError(null);\n    try {\n      const payload = {\n        title,\n        graph_data: { nodes, edges },\n        is_public: isPublic,\n      };\n      const saved = canvasId\n        ? await api.updateCanvas(canvasId, payload)\n        : await api.createCanvas(payload);\n      setCanvasId(saved.id);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Save failed\");\n    } finally {\n      setIsSaving(false);\n    }\n  }, [canvasId, edges, isPublic, nodes, title]);\n\n  const handleOpenLoad = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const list = await api.listCanvases();\n      setCanvases(list);\n      setShowLoadModal(true);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Load failed\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const handleLoadCanvas = useCallback(\n    async (canvas: Canvas) => {\n      setIsLoading(true);\n      setError(null);\n      try {\n        const loaded = await api.loadCanvas(canvas.id);\n        setCanvasId(loaded.id);\n        setTitle(loaded.title);\n        setIsPublic(loaded.is_public);\n        setNodes(loaded.graph_data.nodes as Node<CanvasNodeData>[]);\n        setEdges(loaded.graph_data.edges);\n        setShowLoadModal(false);\n        takeSnapshot(loaded.graph_data.nodes, loaded.graph_data.edges);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : \"Load failed\");\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [setEdges, setNodes, takeSnapshot]\n  );\n\n  const handleNewCanvas = useCallback(() => {\n    setCanvasId(null);\n    setTitle(\"New Project\");\n    setIsPublic(false);\n    setNodes(initialNodes);\n    setEdges(initialEdges);\n    setSelectedNode(null);\n    takeSnapshot(initialNodes, initialEdges);\n  }, [setEdges, setNodes, takeSnapshot]);\n\n  const toolbarButtons = useMemo(\n    () =>\n      [\n        { kind: \"input\", label: \"Input\" },\n        { kind: \"style\", label: \"Style\" },\n        { kind: \"customization\", label: \"Custom\" },\n        { kind: \"processing\", label: \"Logic\" },\n        { kind: \"output\", label: \"Output\" },\n      ] as const,\n    []\n  );\n\n  return (\n    <div className=\"h-screen w-screen bg-slate-950 text-slate-100 overflow-hidden relative\">\n      {/* --- HEADER --- */}\n      <header className=\"absolute top-0 left-0 right-0 z-10 px-6 py-4 flex items-center justify-between pointer-events-none\">\n        <div className=\"pointer-events-auto flex items-center gap-4 bg-slate-950/50 backdrop-blur-md p-2 rounded-2xl border border-white/10 shadow-xl\">\n          <div className=\"flex flex-col px-2\">\n            <span className=\"text-[10px] uppercase tracking-widest text-sky-400 font-bold\">\n              Vivid\n            </span>\n            <input\n              className=\"bg-transparent text-sm font-bold text-slate-100 focus:outline-none w-40\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              placeholder=\"Project Name\"\n            />\n          </div>\n          <div className=\"h-6 w-px bg-white/10\" />\n          <div className=\"flex gap-1\">\n            <button\n              onClick={handleSave}\n              disabled={isSaving}\n              className=\"group p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white transition-colors\"\n              title=\"Save Project\"\n            >\n              <Save\n                className={`h-4 w-4 ${isSaving ? \"animate-spin\" : \"\"}`}\n              />\n            </button>\n            <button\n              onClick={handleOpenLoad}\n              disabled={isLoading}\n              className=\"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white transition-colors\"\n              title=\"Load Project\"\n            >\n              <FolderOpen className=\"h-4 w-4\" />\n            </button>\n            <button\n              onClick={handleNewCanvas}\n              className=\"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white transition-colors\"\n              title=\"New Project\"\n            >\n              <Plus className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n        <div className=\"pointer-events-auto flex gap-2\">\n          {/* Center or Right aligned controls can go here */}\n          <div className=\"bg-slate-950/50 backdrop-blur-md p-2 rounded-2xl border border-white/10 shadow-xl flex gap-1\">\n            <button\n              onClick={handleUndo}\n              disabled={!canUndo}\n              className=\"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white disabled:opacity-30\"\n            >\n              <Undo className=\"h-4 w-4\" />\n            </button>\n            <button\n              onClick={handleRedo}\n              disabled={!canRedo}\n              className=\"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white disabled:opacity-30\"\n            >\n              <Redo className=\"h-4 w-4\" />\n            </button>\n          </div>\n\n          <button\n            onClick={handleRun}\n            disabled={isOptimizing}\n            className=\"bg-sky-500 hover:bg-sky-400 text-white px-4 py-2 rounded-xl text-sm font-semibold shadow-lg shadow-sky-500/20 transition-all flex items-center gap-2 disabled:opacity-50\"\n          >\n            {isOptimizing ? (\n              <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent\" />\n            ) : (\n              <Play className=\"h-4 w-4 fill-current\" />\n            )}\n            {isOptimizing ? \"Optimizing...\" : \"Run\"}\n          </button>\n        </div>\n      </header>\n\n      {/* Error Toast */}\n      <AnimatePresence>\n        {error && (\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n            className=\"absolute top-20 left-1/2 -translate-x-1/2 z-50 bg-rose-500/90 text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium backdrop-blur\"\n          >\n            {error}\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* --- CANVAS --- */}\n      <div className=\"absolute inset-0 z-0\">\n        <ReactFlow\n          nodes={nodes}\n          edges={edges}\n          onNodesChange={onNodesChange}\n          onEdgesChange={onEdgesChange}\n          onConnect={onConnect}\n          onNodeClick={(_, node) =>\n            setSelectedNode(node as Node<CanvasNodeData>)\n          }\n          fitView\n          nodeTypes={nodeTypes as any}\n          proOptions={{ hideAttribution: true }}\n          minZoom={0.2}\n          maxZoom={2}\n          onPaneClick={() => setSelectedNode(null)}\n        >\n          <Background color=\"#334155\" gap={40} size={1} />\n          {/* Custom Controls Positioned Bottom Right */}\n          <Panel position=\"bottom-right\" className=\"mb-8 mr-8 flex flex-col gap-2\">\n            <button className=\"bg-slate-900/80 p-2 rounded-lg border border-white/10 text-slate-400 hover:text-white hover:bg-white/10\" title=\"Zoom In\">\n              <ZoomIn className=\"h-5 w-5\" />\n            </button>\n            <button className=\"bg-slate-900/80 p-2 rounded-lg border border-white/10 text-slate-400 hover:text-white hover:bg-white/10\" title=\"Zoom Out\">\n              <ZoomOut className=\"h-5 w-5\" />\n            </button>\n            <button className=\"bg-slate-900/80 p-2 rounded-lg border border-white/10 text-slate-400 hover:text-white hover:bg-white/10\" title=\"Fit View\">\n              <Maximize2 className=\"h-5 w-5\" />\n            </button>\n          </Panel>\n        </ReactFlow>\n      </div>\n\n      {/* --- FLOATING DOCK TOOLBAR --- */}\n      <div className=\"absolute bottom-8 left-1/2 -translate-x-1/2 z-10\">\n        <motion.div\n          initial={{ y: 100, opacity: 0 }}\n          animate={{ y: 0, opacity: 1 }}\n          className=\"flex items-center gap-2 p-2 bg-slate-950/60 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-2xl\"\n        >\n          {toolbarButtons.map((btn) => (\n            <button\n              key={btn.kind}\n              onClick={() => handleAddNode(btn.kind)}\n              className=\"group relative flex flex-col items-center justify-center w-16 h-16 rounded-xl border border-transparent hover:border-white/10 hover:bg-white/5 transition-all\"\n            >\n              <div className=\"h-8 w-8 rounded bg-slate-800 group-hover:bg-sky-500/20 group-hover:text-sky-400 flex items-center justify-center transition-colors text-slate-400 mb-1\">\n                <Box className=\"h-5 w-5\" />\n              </div>\n              <span className=\"text-[10px] font-medium text-slate-400 group-hover:text-slate-100\">\n                {btn.label}\n              </span>\n\n              {/* Tooltip hint could go here */}\n            </button>\n          ))}\n        </motion.div>\n      </div>\n\n      {/* --- INSPECTOR PANEL --- */}\n      <Inspector\n        selectedNode={selectedNode}\n        onClose={() => setSelectedNode(null)}\n        onUpdate={handleUpdateNode}\n        onDelete={handleDeleteNode}\n      />\n\n      {/* --- LOAD MODAL --- */}\n      <AnimatePresence>\n        {showLoadModal && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\n            onClick={() => setShowLoadModal(false)}\n          >\n            <motion.div\n              initial={{ scale: 0.95, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.95, opacity: 0 }}\n              className=\"w-full max-w-lg rounded-2xl border border-white/10 bg-slate-950 shadow-2xl overflow-hidden\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <div className=\"flex items-center justify-between p-6 border-b border-white/5\">\n                <h2 className=\"text-lg font-semibold text-white\">Open Project</h2>\n                <button onClick={() => setShowLoadModal(false)} className=\"text-slate-400 hover:text-white\">\n                  <Maximize2 className=\"h-4 w-4 rotate-45\" /> {/* Close Icon */}\n                </button>\n              </div>\n              <div className=\"p-2 max-h-96 overflow-y-auto\">\n                {canvases.length === 0 ? (\n                  <div className=\"p-8 text-center text-slate-500\">\n                    No saved projects found.\n                  </div>\n                ) : (\n                  <div className=\"grid gap-1\">\n                    {canvases.map((canvas) => (\n                      <button\n                        key={canvas.id}\n                        onClick={() => handleLoadCanvas(canvas)}\n                        className=\"flex items-center justify-between w-full p-4 rounded-xl hover:bg-white/5 text-left border border-transparent hover:border-white/5 transition-all group\"\n                      >\n                        <div>\n                          <div className=\"font-semibold text-slate-200 group-hover:text-sky-400 transition-colors\">{canvas.title}</div>\n                          <div className=\"text-xs text-slate-500 mt-1\">Updated {new Date(canvas.updated_at).toLocaleDateString()}</div>\n                        </div>\n                        <div className=\"opacity-0 group-hover:opacity-100 transition-opacity\">\n                          <FolderOpen className=\"h-4 w-4 text-slate-400\" />\n                        </div>\n                      </button>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Recommendations Modal */}\n      <AnimatePresence>\n        {showRecommendations && recommendations.length > 0 && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\n          >\n            <motion.div\n              initial={{ scale: 0.95, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.95, opacity: 0 }}\n              className=\"w-full max-w-lg rounded-2xl border border-white/10 bg-slate-950/95 p-6 shadow-2xl backdrop-blur-xl\"\n            >\n              <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                  <h2 className=\"text-lg font-bold text-slate-100\">GA Recommendations</h2>\n                  <p className=\"text-sm text-slate-400\">Top 3 optimized parameter sets</p>\n                </div>\n                <button\n                  onClick={() => setShowRecommendations(false)}\n                  className=\"p-2 rounded-lg hover:bg-white/5 text-slate-400 hover:text-white\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </button>\n              </div>\n\n              <div className=\"space-y-3\">\n                {recommendations.map((rec, idx) => (\n                  <div\n                    key={idx}\n                    className=\"rounded-xl border border-white/10 bg-slate-900/50 p-4 hover:border-sky-500/30 transition-colors\"\n                  >\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <span className=\"text-xs font-bold text-sky-400 uppercase\">\n                        Recommendation {idx + 1}\n                      </span>\n                      <span className=\"text-xs font-mono text-slate-500\">\n                        Score: {rec.fitness_score.toFixed(1)}\n                      </span>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-2 text-xs mb-3\">\n                      {Object.entries(rec.params).slice(0, 4).map(([key, value]) => (\n                        <div key={key} className=\"flex justify-between\">\n                          <span className=\"text-slate-500\">{key.replace(/_/g, \" \")}</span>\n                          <span className=\"font-mono text-slate-300\">\n                            {typeof value === \"number\" ? value.toFixed(2) : String(value)}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                    <button\n                      onClick={() => applyRecommendation(rec.params)}\n                      className=\"w-full py-2 rounded-lg bg-sky-500/10 text-sky-400 text-xs font-semibold hover:bg-sky-500/20 transition-colors\"\n                    >\n                      Apply This Set\n                    </button>\n                  </div>\n                ))}\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n\nimport { Suspense } from \"react\";\n\nfunction CanvasPageContent() {\n  return (\n    <ReactFlowProvider>\n      <CanvasFlow />\n    </ReactFlowProvider>\n  );\n}\n\nexport default function CanvasPage() {\n  return (\n    <Suspense fallback={<div className=\"h-screen w-screen flex items-center justify-center bg-slate-950 text-slate-400\">Loading canvas...</div>}>\n      <CanvasPageContent />\n    </Suspense>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}