module.exports=[47349,(a,b,c)=>{"use strict";var d=a.r(72131);d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},87610,(a,b,c)=>{"use strict";b.exports=a.r(47349)},97514,(a,b,c)=>{"use strict";var d=a.r(72131),e=a.r(87610),f="function"==typeof Object.is?Object.is:function(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},g=e.useSyncExternalStore,h=d.useRef,i=d.useEffect,j=d.useMemo,k=d.useDebugValue;c.useSyncExternalStoreWithSelector=function(a,b,c,d,e){var l=h(null);if(null===l.current){var m={hasValue:!1,value:null};l.current=m}else m=l.current;var n=g(a,(l=j(function(){function a(a){if(!i){if(i=!0,g=a,a=d(a),void 0!==e&&m.hasValue){var b=m.value;if(e(b,a))return h=b}return h=a}if(b=h,f(g,a))return b;var c=d(a);return void 0!==e&&e(b,c)?(g=a,b):(g=a,h=c)}var g,h,i=!1,j=void 0===c?null:c;return[function(){return a(b())},null===j?void 0:function(){return a(j())}]},[b,c,d,e]))[0],l[1]);return i(function(){m.hasValue=!0,m.value=n},[n]),k(n),n}},64442,(a,b,c)=>{"use strict";b.exports=a.r(97514)},16646,a=>{"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=a.i(87924),t=a.i(72131),u=a.i(50944);function v(a){if("string"==typeof a||"number"==typeof a)return""+a;let b="";if(Array.isArray(a))for(let c=0,d;c<a.length;c++)""!==(d=v(a[c]))&&(b+=(b&&" ")+d);else for(let c in a)a[c]&&(b+=(b&&" ")+c);return b}var w={value:()=>{}};function x(){for(var a,b=0,c=arguments.length,d={};b<c;++b){if(!(a=arguments[b]+"")||a in d||/[\s.]/.test(a))throw Error("illegal type: "+a);d[a]=[]}return new y(d)}function y(a){this._=a}function z(a,b,c){for(var d=0,e=a.length;d<e;++d)if(a[d].name===b){a[d]=w,a=a.slice(0,d).concat(a.slice(d+1));break}return null!=c&&a.push({name:b,value:c}),a}function A(){}function B(a){return null==a?A:function(){return this.querySelector(a)}}function C(){return[]}function D(a){return null==a?C:function(){return this.querySelectorAll(a)}}function E(a){return function(){return this.matches(a)}}function F(a){return function(b){return b.matches(a)}}y.prototype=x.prototype={constructor:y,on:function(a,b){var c,d=this._,e=(a+"").trim().split(/^|\s+/).map(function(a){var b="",c=a.indexOf(".");if(c>=0&&(b=a.slice(c+1),a=a.slice(0,c)),a&&!d.hasOwnProperty(a))throw Error("unknown type: "+a);return{type:a,name:b}}),f=-1,g=e.length;if(arguments.length<2){for(;++f<g;)if((c=(a=e[f]).type)&&(c=function(a,b){for(var c,d=0,e=a.length;d<e;++d)if((c=a[d]).name===b)return c.value}(d[c],a.name)))return c;return}if(null!=b&&"function"!=typeof b)throw Error("invalid callback: "+b);for(;++f<g;)if(c=(a=e[f]).type)d[c]=z(d[c],a.name,b);else if(null==b)for(c in d)d[c]=z(d[c],a.name,null);return this},copy:function(){var a={},b=this._;for(var c in b)a[c]=b[c].slice();return new y(a)},call:function(a,b){if((c=arguments.length-2)>0)for(var c,d,e=Array(c),f=0;f<c;++f)e[f]=arguments[f+2];if(!this._.hasOwnProperty(a))throw Error("unknown type: "+a);for(d=this._[a],f=0,c=d.length;f<c;++f)d[f].value.apply(b,e)},apply:function(a,b,c){if(!this._.hasOwnProperty(a))throw Error("unknown type: "+a);for(var d=this._[a],e=0,f=d.length;e<f;++e)d[e].value.apply(b,c)}};var G=Array.prototype.find;function H(){return this.firstElementChild}var I=Array.prototype.filter;function J(){return Array.from(this.children)}function K(a){return Array(a.length)}function L(a,b){this.ownerDocument=a.ownerDocument,this.namespaceURI=a.namespaceURI,this._next=null,this._parent=a,this.__data__=b}function M(a,b,c,d,e,f){for(var g,h=0,i=b.length,j=f.length;h<j;++h)(g=b[h])?(g.__data__=f[h],d[h]=g):c[h]=new L(a,f[h]);for(;h<i;++h)(g=b[h])&&(e[h]=g)}function N(a,b,c,d,e,f,g){var h,i,j,k=new Map,l=b.length,m=f.length,n=Array(l);for(h=0;h<l;++h)(i=b[h])&&(n[h]=j=g.call(i,i.__data__,h,b)+"",k.has(j)?e[h]=i:k.set(j,i));for(h=0;h<m;++h)j=g.call(a,f[h],h,f)+"",(i=k.get(j))?(d[h]=i,i.__data__=f[h],k.delete(j)):c[h]=new L(a,f[h]);for(h=0;h<l;++h)(i=b[h])&&k.get(n[h])===i&&(e[h]=i)}function O(a){return a.__data__}function P(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}L.prototype={constructor:L,appendChild:function(a){return this._parent.insertBefore(a,this._next)},insertBefore:function(a,b){return this._parent.insertBefore(a,b)},querySelector:function(a){return this._parent.querySelector(a)},querySelectorAll:function(a){return this._parent.querySelectorAll(a)}};var Q="http://www.w3.org/1999/xhtml";let R={svg:"http://www.w3.org/2000/svg",xhtml:Q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function S(a){var b=a+="",c=b.indexOf(":");return c>=0&&"xmlns"!==(b=a.slice(0,c))&&(a=a.slice(c+1)),R.hasOwnProperty(b)?{space:R[b],local:a}:a}function T(a){return a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView}function U(a,b){return a.style.getPropertyValue(b)||T(a).getComputedStyle(a,null).getPropertyValue(b)}function V(a){return a.trim().split(/^|\s+/)}function W(a){return a.classList||new X(a)}function X(a){this._node=a,this._names=V(a.getAttribute("class")||"")}function Y(a,b){for(var c=W(a),d=-1,e=b.length;++d<e;)c.add(b[d])}function Z(a,b){for(var c=W(a),d=-1,e=b.length;++d<e;)c.remove(b[d])}function $(){this.textContent=""}function _(){this.innerHTML=""}function aa(){this.nextSibling&&this.parentNode.appendChild(this)}function ab(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ac(a){var b=S(a);return(b.local?function(a){return function(){return this.ownerDocument.createElementNS(a.space,a.local)}}:function(a){return function(){var b=this.ownerDocument,c=this.namespaceURI;return c===Q&&b.documentElement.namespaceURI===Q?b.createElement(a):b.createElementNS(c,a)}})(b)}function ad(){return null}function ae(){var a=this.parentNode;a&&a.removeChild(this)}function af(){var a=this.cloneNode(!1),b=this.parentNode;return b?b.insertBefore(a,this.nextSibling):a}function ag(){var a=this.cloneNode(!0),b=this.parentNode;return b?b.insertBefore(a,this.nextSibling):a}function ah(a){return function(){var b=this.__on;if(b){for(var c,d=0,e=-1,f=b.length;d<f;++d)(c=b[d],a.type&&c.type!==a.type||c.name!==a.name)?b[++e]=c:this.removeEventListener(c.type,c.listener,c.options);++e?b.length=e:delete this.__on}}}function ai(a,b,c){return function(){var d,e=this.__on,f=function(a){b.call(this,a,this.__data__)};if(e){for(var g=0,h=e.length;g<h;++g)if((d=e[g]).type===a.type&&d.name===a.name){this.removeEventListener(d.type,d.listener,d.options),this.addEventListener(d.type,d.listener=f,d.options=c),d.value=b;return}}this.addEventListener(a.type,f,c),d={type:a.type,name:a.name,value:b,listener:f,options:c},e?e.push(d):this.__on=[d]}}function aj(a,b,c){var d=T(a),e=d.CustomEvent;"function"==typeof e?e=new e(b,c):(e=d.document.createEvent("Event"),c?(e.initEvent(b,c.bubbles,c.cancelable),e.detail=c.detail):e.initEvent(b,!1,!1)),a.dispatchEvent(e)}X.prototype={add:function(a){0>this._names.indexOf(a)&&(this._names.push(a),this._node.setAttribute("class",this._names.join(" ")))},remove:function(a){var b=this._names.indexOf(a);b>=0&&(this._names.splice(b,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(a){return this._names.indexOf(a)>=0}};var ak=[null];function al(a,b){this._groups=a,this._parents=b}function am(){return new al([[document.documentElement]],ak)}function an(a){return"string"==typeof a?new al([[document.querySelector(a)]],[document.documentElement]):new al([[a]],ak)}function ao(a,b){if(a=function(a){let b;for(;b=a.sourceEvent;)a=b;return a}(a),void 0===b&&(b=a.currentTarget),b){var c=b.ownerSVGElement||b;if(c.createSVGPoint){var d=c.createSVGPoint();return d.x=a.clientX,d.y=a.clientY,[(d=d.matrixTransform(b.getScreenCTM().inverse())).x,d.y]}if(b.getBoundingClientRect){var e=b.getBoundingClientRect();return[a.clientX-e.left-b.clientLeft,a.clientY-e.top-b.clientTop]}}return[a.pageX,a.pageY]}al.prototype=am.prototype={constructor:al,select:function(a){"function"!=typeof a&&(a=B(a));for(var b=this._groups,c=b.length,d=Array(c),e=0;e<c;++e)for(var f,g,h=b[e],i=h.length,j=d[e]=Array(i),k=0;k<i;++k)(f=h[k])&&(g=a.call(f,f.__data__,k,h))&&("__data__"in f&&(g.__data__=f.__data__),j[k]=g);return new al(d,this._parents)},selectAll:function(a){if("function"==typeof a){var b;b=a,a=function(){var a;return a=b.apply(this,arguments),null==a?[]:Array.isArray(a)?a:Array.from(a)}}else a=D(a);for(var c=this._groups,d=c.length,e=[],f=[],g=0;g<d;++g)for(var h,i=c[g],j=i.length,k=0;k<j;++k)(h=i[k])&&(e.push(a.call(h,h.__data__,k,i)),f.push(h));return new al(e,f)},selectChild:function(a){var b;return this.select(null==a?H:(b="function"==typeof a?a:F(a),function(){return G.call(this.children,b)}))},selectChildren:function(a){var b;return this.selectAll(null==a?J:(b="function"==typeof a?a:F(a),function(){return I.call(this.children,b)}))},filter:function(a){"function"!=typeof a&&(a=E(a));for(var b=this._groups,c=b.length,d=Array(c),e=0;e<c;++e)for(var f,g=b[e],h=g.length,i=d[e]=[],j=0;j<h;++j)(f=g[j])&&a.call(f,f.__data__,j,g)&&i.push(f);return new al(d,this._parents)},data:function(a,b){if(!arguments.length)return Array.from(this,O);var c=b?N:M,d=this._parents,e=this._groups;"function"!=typeof a&&(s=a,a=function(){return s});for(var f=e.length,g=Array(f),h=Array(f),i=Array(f),j=0;j<f;++j){var k=d[j],l=e[j],m=l.length,n="object"==typeof(r=a.call(k,k&&k.__data__,j,d))&&"length"in r?r:Array.from(r),o=n.length,p=h[j]=Array(o),q=g[j]=Array(o);c(k,l,p,q,i[j]=Array(m),n,b);for(var r,s,t,u,v=0,w=0;v<o;++v)if(t=p[v]){for(v>=w&&(w=v+1);!(u=q[w])&&++w<o;);t._next=u||null}}return(g=new al(g,d))._enter=h,g._exit=i,g},enter:function(){return new al(this._enter||this._groups.map(K),this._parents)},exit:function(){return new al(this._exit||this._groups.map(K),this._parents)},join:function(a,b,c){var d=this.enter(),e=this,f=this.exit();return"function"==typeof a?(d=a(d))&&(d=d.selection()):d=d.append(a+""),null!=b&&(e=b(e))&&(e=e.selection()),null==c?f.remove():c(f),d&&e?d.merge(e).order():e},merge:function(a){for(var b=a.selection?a.selection():a,c=this._groups,d=b._groups,e=c.length,f=d.length,g=Math.min(e,f),h=Array(e),i=0;i<g;++i)for(var j,k=c[i],l=d[i],m=k.length,n=h[i]=Array(m),o=0;o<m;++o)(j=k[o]||l[o])&&(n[o]=j);for(;i<e;++i)h[i]=c[i];return new al(h,this._parents)},selection:function(){return this},order:function(){for(var a=this._groups,b=-1,c=a.length;++b<c;)for(var d,e=a[b],f=e.length-1,g=e[f];--f>=0;)(d=e[f])&&(g&&4^d.compareDocumentPosition(g)&&g.parentNode.insertBefore(d,g),g=d);return this},sort:function(a){function b(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}a||(a=P);for(var c=this._groups,d=c.length,e=Array(d),f=0;f<d;++f){for(var g,h=c[f],i=h.length,j=e[f]=Array(i),k=0;k<i;++k)(g=h[k])&&(j[k]=g);j.sort(b)}return new al(e,this._parents).order()},call:function(){var a=arguments[0];return arguments[0]=this,a.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var a=this._groups,b=0,c=a.length;b<c;++b)for(var d=a[b],e=0,f=d.length;e<f;++e){var g=d[e];if(g)return g}return null},size:function(){let a=0;for(let b of this)++a;return a},empty:function(){return!this.node()},each:function(a){for(var b=this._groups,c=0,d=b.length;c<d;++c)for(var e,f=b[c],g=0,h=f.length;g<h;++g)(e=f[g])&&a.call(e,e.__data__,g,f);return this},attr:function(a,b){var c=S(a);if(arguments.length<2){var d=this.node();return c.local?d.getAttributeNS(c.space,c.local):d.getAttribute(c)}return this.each((null==b?c.local?function(a){return function(){this.removeAttributeNS(a.space,a.local)}}:function(a){return function(){this.removeAttribute(a)}}:"function"==typeof b?c.local?function(a,b){return function(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}}:function(a,b){return function(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}}:c.local?function(a,b){return function(){this.setAttributeNS(a.space,a.local,b)}}:function(a,b){return function(){this.setAttribute(a,b)}})(c,b))},style:function(a,b,c){return arguments.length>1?this.each((null==b?function(a){return function(){this.style.removeProperty(a)}}:"function"==typeof b?function(a,b,c){return function(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}}:function(a,b,c){return function(){this.style.setProperty(a,b,c)}})(a,b,null==c?"":c)):U(this.node(),a)},property:function(a,b){return arguments.length>1?this.each((null==b?function(a){return function(){delete this[a]}}:"function"==typeof b?function(a,b){return function(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}}:function(a,b){return function(){this[a]=b}})(a,b)):this.node()[a]},classed:function(a,b){var c=V(a+"");if(arguments.length<2){for(var d=W(this.node()),e=-1,f=c.length;++e<f;)if(!d.contains(c[e]))return!1;return!0}return this.each(("function"==typeof b?function(a,b){return function(){(b.apply(this,arguments)?Y:Z)(this,a)}}:b?function(a){return function(){Y(this,a)}}:function(a){return function(){Z(this,a)}})(c,b))},text:function(a){return arguments.length?this.each(null==a?$:("function"==typeof a?function(a){return function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}}:function(a){return function(){this.textContent=a}})(a)):this.node().textContent},html:function(a){return arguments.length?this.each(null==a?_:("function"==typeof a?function(a){return function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}}:function(a){return function(){this.innerHTML=a}})(a)):this.node().innerHTML},raise:function(){return this.each(aa)},lower:function(){return this.each(ab)},append:function(a){var b="function"==typeof a?a:ac(a);return this.select(function(){return this.appendChild(b.apply(this,arguments))})},insert:function(a,b){var c="function"==typeof a?a:ac(a),d=null==b?ad:"function"==typeof b?b:B(b);return this.select(function(){return this.insertBefore(c.apply(this,arguments),d.apply(this,arguments)||null)})},remove:function(){return this.each(ae)},clone:function(a){return this.select(a?ag:af)},datum:function(a){return arguments.length?this.property("__data__",a):this.node().__data__},on:function(a,b,c){var d,e,f=(a+"").trim().split(/^|\s+/).map(function(a){var b="",c=a.indexOf(".");return c>=0&&(b=a.slice(c+1),a=a.slice(0,c)),{type:a,name:b}}),g=f.length;if(arguments.length<2){var h=this.node().__on;if(h){for(var i,j=0,k=h.length;j<k;++j)for(d=0,i=h[j];d<g;++d)if((e=f[d]).type===i.type&&e.name===i.name)return i.value}return}for(d=0,h=b?ai:ah;d<g;++d)this.each(h(f[d],b,c));return this},dispatch:function(a,b){return this.each(("function"==typeof b?function(a,b){return function(){return aj(this,a,b.apply(this,arguments))}}:function(a,b){return function(){return aj(this,a,b)}})(a,b))},[Symbol.iterator]:function*(){for(var a=this._groups,b=0,c=a.length;b<c;++b)for(var d,e=a[b],f=0,g=e.length;f<g;++f)(d=e[f])&&(yield d)}};let ap={passive:!1},aq={capture:!0,passive:!1};function ar(a){a.stopImmediatePropagation()}function as(a){a.preventDefault(),a.stopImmediatePropagation()}function at(a){var b=a.document.documentElement,c=an(a).on("dragstart.drag",as,aq);"onselectstart"in b?c.on("selectstart.drag",as,aq):(b.__noselect=b.style.MozUserSelect,b.style.MozUserSelect="none")}function au(a,b){var c=a.document.documentElement,d=an(a).on("dragstart.drag",null);b&&(d.on("click.drag",as,aq),setTimeout(function(){d.on("click.drag",null)},0)),"onselectstart"in c?d.on("selectstart.drag",null):(c.style.MozUserSelect=c.__noselect,delete c.__noselect)}let av=a=>()=>a;function aw(a,{sourceEvent:b,subject:c,target:d,identifier:e,active:f,x:g,y:h,dx:i,dy:j,dispatch:k}){Object.defineProperties(this,{type:{value:a,enumerable:!0,configurable:!0},sourceEvent:{value:b,enumerable:!0,configurable:!0},subject:{value:c,enumerable:!0,configurable:!0},target:{value:d,enumerable:!0,configurable:!0},identifier:{value:e,enumerable:!0,configurable:!0},active:{value:f,enumerable:!0,configurable:!0},x:{value:g,enumerable:!0,configurable:!0},y:{value:h,enumerable:!0,configurable:!0},dx:{value:i,enumerable:!0,configurable:!0},dy:{value:j,enumerable:!0,configurable:!0},_:{value:k}})}function ax(a){return!a.ctrlKey&&!a.button}function ay(){return this.parentNode}function az(a,b){return null==b?{x:a.x,y:a.y}:b}function aA(){return navigator.maxTouchPoints||"ontouchstart"in this}function aB(){var a,b,c,d,e=ax,f=ay,g=az,h=aA,i={},j=x("start","drag","end"),k=0,l=0;function m(a){a.on("mousedown.drag",n).filter(h).on("touchstart.drag",q).on("touchmove.drag",r,ap).on("touchend.drag touchcancel.drag",s).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function n(g,h){if(!d&&e.call(this,g,h)){var i=t(this,f.call(this,g,h),g,h,"mouse");i&&(an(g.view).on("mousemove.drag",o,aq).on("mouseup.drag",p,aq),at(g.view),ar(g),c=!1,a=g.clientX,b=g.clientY,i("start",g))}}function o(d){if(as(d),!c){var e=d.clientX-a,f=d.clientY-b;c=e*e+f*f>l}i.mouse("drag",d)}function p(a){an(a.view).on("mousemove.drag mouseup.drag",null),au(a.view,c),as(a),i.mouse("end",a)}function q(a,b){if(e.call(this,a,b)){var c,d,g=a.changedTouches,h=f.call(this,a,b),i=g.length;for(c=0;c<i;++c)(d=t(this,h,a,b,g[c].identifier,g[c]))&&(ar(a),d("start",a,g[c]))}}function r(a){var b,c,d=a.changedTouches,e=d.length;for(b=0;b<e;++b)(c=i[d[b].identifier])&&(as(a),c("drag",a,d[b]))}function s(a){var b,c,e=a.changedTouches,f=e.length;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),b=0;b<f;++b)(c=i[e[b].identifier])&&(ar(a),c("end",a,e[b]))}function t(a,b,c,d,e,f){var h,l,n,o=j.copy(),p=ao(f||c,b);if(null!=(n=g.call(a,new aw("beforestart",{sourceEvent:c,target:m,identifier:e,active:k,x:p[0],y:p[1],dx:0,dy:0,dispatch:o}),d)))return h=n.x-p[0]||0,l=n.y-p[1]||0,function c(f,g,j){var q,r=p;switch(f){case"start":i[e]=c,q=k++;break;case"end":delete i[e],--k;case"drag":p=ao(j||g,b),q=k}o.call(f,a,new aw(f,{sourceEvent:g,subject:n,target:m,identifier:e,active:q,x:p[0]+h,y:p[1]+l,dx:p[0]-r[0],dy:p[1]-r[1],dispatch:o}),d)}}return m.filter=function(a){return arguments.length?(e="function"==typeof a?a:av(!!a),m):e},m.container=function(a){return arguments.length?(f="function"==typeof a?a:av(a),m):f},m.subject=function(a){return arguments.length?(g="function"==typeof a?a:av(a),m):g},m.touchable=function(a){return arguments.length?(h="function"==typeof a?a:av(!!a),m):h},m.on=function(){var a=j.on.apply(j,arguments);return a===j?m:a},m.clickDistance=function(a){return arguments.length?(l=(a*=1)*a,m):Math.sqrt(l)},m}function aC(a){return((a=Math.exp(a))+1/a)/2}aw.prototype.on=function(){var a=this._.on.apply(this._,arguments);return a===this._?this:a};let aD=function a(b,c,d){function e(a,e){var f,g,h=a[0],i=a[1],j=a[2],k=e[0],l=e[1],m=e[2],n=k-h,o=l-i,p=n*n+o*o;if(p<1e-12)g=Math.log(m/j)/b,f=function(a){return[h+a*n,i+a*o,j*Math.exp(b*a*g)]};else{var q=Math.sqrt(p),r=(m*m-j*j+d*p)/(2*j*c*q),s=(m*m-j*j-d*p)/(2*m*c*q),t=Math.log(Math.sqrt(r*r+1)-r);g=(Math.log(Math.sqrt(s*s+1)-s)-t)/b,f=function(a){var d,e,f=a*g,k=aC(t),l=j/(c*q)*(k*(((d=Math.exp(2*(d=b*f+t)))-1)/(d+1))-((e=Math.exp(e=t))-1/e)/2);return[h+l*n,i+l*o,j*k/aC(b*f+t)]}}return f.duration=1e3*g*b/Math.SQRT2,f}return e.rho=function(b){var c=Math.max(.001,+b),d=c*c;return a(c,d,d*d)},e}(Math.SQRT2,2,4);var aE,aF,aG=0,aH=0,aI=0,aJ=0,aK=0,aL=0,aM="object"==typeof performance&&performance.now?performance:Date,aN=function(a){setTimeout(a,17)};function aO(){return aK||(aN(aP),aK=aM.now()+aL)}function aP(){aK=0}function aQ(){this._call=this._time=this._next=null}function aR(a,b,c){var d=new aQ;return d.restart(a,b,c),d}function aS(){aK=(aJ=aM.now())+aL,aG=aH=0;try{aO(),++aG;for(var a,b=aE;b;)(a=aK-b._time)>=0&&b._call.call(void 0,a),b=b._next;--aG}finally{aG=0,function(){for(var a,b,c=aE,d=1/0;c;)c._call?(d>c._time&&(d=c._time),a=c,c=c._next):(b=c._next,c._next=null,c=a?a._next=b:aE=b);aF=a,aU(d)}(),aK=0}}function aT(){var a=aM.now(),b=a-aJ;b>1e3&&(aL-=b,aJ=a)}function aU(a){!aG&&(aH&&(aH=clearTimeout(aH)),a-aK>24?(a<1/0&&(aH=setTimeout(aS,a-aM.now()-aL)),aI&&(aI=clearInterval(aI))):(aI||(aJ=aM.now(),aI=setInterval(aT,1e3)),aG=1,aN(aS)))}function aV(a,b,c){var d=new aQ;return b=null==b?0:+b,d.restart(c=>{d.stop(),a(c+b)},b,c),d}aQ.prototype=aR.prototype={constructor:aQ,restart:function(a,b,c){if("function"!=typeof a)throw TypeError("callback is not a function");c=(null==c?aO():+c)+(null==b?0:+b),this._next||aF===this||(aF?aF._next=this:aE=this,aF=this),this._call=a,this._time=c,aU()},stop:function(){this._call&&(this._call=null,this._time=1/0,aU())}};var aW=x("start","end","cancel","interrupt"),aX=[];function aY(a,b,c,d,e,f){var g=a.__transition;if(g){if(c in g)return}else a.__transition={};!function(a,b,c){var d,e=a.__transition;function f(i){var j,k,l,m;if(1!==c.state)return h();for(j in e)if((m=e[j]).name===c.name){if(3===m.state)return aV(f);4===m.state?(m.state=6,m.timer.stop(),m.on.call("interrupt",a,a.__data__,m.index,m.group),delete e[j]):+j<b&&(m.state=6,m.timer.stop(),m.on.call("cancel",a,a.__data__,m.index,m.group),delete e[j])}if(aV(function(){3===c.state&&(c.state=4,c.timer.restart(g,c.delay,c.time),g(i))}),c.state=2,c.on.call("start",a,a.__data__,c.index,c.group),2===c.state){for(j=0,c.state=3,d=Array(l=c.tween.length),k=-1;j<l;++j)(m=c.tween[j].value.call(a,a.__data__,c.index,c.group))&&(d[++k]=m);d.length=k+1}}function g(b){for(var e=b<c.duration?c.ease.call(null,b/c.duration):(c.timer.restart(h),c.state=5,1),f=-1,g=d.length;++f<g;)d[f].call(a,e);5===c.state&&(c.on.call("end",a,a.__data__,c.index,c.group),h())}function h(){for(var d in c.state=6,c.timer.stop(),delete e[b],e)return;delete a.__transition}e[b]=c,c.timer=aR(function(a){c.state=1,c.timer.restart(f,c.delay,c.time),c.delay<=a&&f(a-c.delay)},0,c.time)}(a,c,{name:b,index:d,group:e,on:aW,tween:aX,time:f.time,delay:f.delay,duration:f.duration,ease:f.ease,timer:null,state:0})}function aZ(a,b){var c=a_(a,b);if(c.state>0)throw Error("too late; already scheduled");return c}function a$(a,b){var c=a_(a,b);if(c.state>3)throw Error("too late; already running");return c}function a_(a,b){var c=a.__transition;if(!c||!(c=c[b]))throw Error("transition not found");return c}function a0(a,b){var c,d,e,f=a.__transition,g=!0;if(f){for(e in b=null==b?null:b+"",f){if((c=f[e]).name!==b){g=!1;continue}d=c.state>2&&c.state<5,c.state=6,c.timer.stop(),c.on.call(d?"interrupt":"cancel",a,a.__data__,c.index,c.group),delete f[e]}g&&delete a.__transition}}function a1(a,b){return a*=1,b*=1,function(c){return a*(1-c)+b*c}}var a2=180/Math.PI,a3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function a4(a,b,c,d,e,f){var g,h,i;return(g=Math.sqrt(a*a+b*b))&&(a/=g,b/=g),(i=a*c+b*d)&&(c-=a*i,d-=b*i),(h=Math.sqrt(c*c+d*d))&&(c/=h,d/=h,i/=h),a*d<b*c&&(a=-a,b=-b,i=-i,g=-g),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*a2,skewX:Math.atan(i)*a2,scaleX:g,scaleY:h}}function a5(a,b,c,d){function e(a){return a.length?a.pop()+" ":""}return function(f,g){var h,i,j,k,l=[],m=[];return f=a(f),g=a(g),!function(a,d,e,f,g,h){if(a!==e||d!==f){var i=g.push("translate(",null,b,null,c);h.push({i:i-4,x:a1(a,e)},{i:i-2,x:a1(d,f)})}else(e||f)&&g.push("translate("+e+b+f+c)}(f.translateX,f.translateY,g.translateX,g.translateY,l,m),h=f.rotate,i=g.rotate,h!==i?(h-i>180?i+=360:i-h>180&&(h+=360),m.push({i:l.push(e(l)+"rotate(",null,d)-2,x:a1(h,i)})):i&&l.push(e(l)+"rotate("+i+d),j=f.skewX,k=g.skewX,j!==k?m.push({i:l.push(e(l)+"skewX(",null,d)-2,x:a1(j,k)}):k&&l.push(e(l)+"skewX("+k+d),!function(a,b,c,d,f,g){if(a!==c||b!==d){var h=f.push(e(f)+"scale(",null,",",null,")");g.push({i:h-4,x:a1(a,c)},{i:h-2,x:a1(b,d)})}else(1!==c||1!==d)&&f.push(e(f)+"scale("+c+","+d+")")}(f.scaleX,f.scaleY,g.scaleX,g.scaleY,l,m),f=g=null,function(a){for(var b,c=-1,d=m.length;++c<d;)l[(b=m[c]).i]=b.x(a);return l.join("")}}}var a6=a5(function(a){let b=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(a+"");return b.isIdentity?a3:a4(b.a,b.b,b.c,b.d,b.e,b.f)},"px, ","px)","deg)"),a7=a5(function(a){return null==a?a3:(j||(j=document.createElementNS("http://www.w3.org/2000/svg","g")),j.setAttribute("transform",a),a=j.transform.baseVal.consolidate())?a4((a=a.matrix).a,a.b,a.c,a.d,a.e,a.f):a3},", ",")",")");function a8(a,b,c){var d=a._id;return a.each(function(){var a=a$(this,d);(a.value||(a.value={}))[b]=c.apply(this,arguments)}),function(a){return a_(a,d).value[b]}}function a9(a,b,c){a.prototype=b.prototype=c,c.constructor=a}function ba(a,b){var c=Object.create(a.prototype);for(var d in b)c[d]=b[d];return c}function bb(){}var bc="\\s*([+-]?\\d+)\\s*",bd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",be="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bf=/^#([0-9a-f]{3,8})$/,bg=RegExp(`^rgb\\(${bc},${bc},${bc}\\)$`),bh=RegExp(`^rgb\\(${be},${be},${be}\\)$`),bi=RegExp(`^rgba\\(${bc},${bc},${bc},${bd}\\)$`),bj=RegExp(`^rgba\\(${be},${be},${be},${bd}\\)$`),bk=RegExp(`^hsl\\(${bd},${be},${be}\\)$`),bl=RegExp(`^hsla\\(${bd},${be},${be},${bd}\\)$`),bm={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function bn(){return this.rgb().formatHex()}function bo(){return this.rgb().formatRgb()}function bp(a){var b,c;return a=(a+"").trim().toLowerCase(),(b=bf.exec(a))?(c=b[1].length,b=parseInt(b[1],16),6===c?bq(b):3===c?new bt(b>>8&15|b>>4&240,b>>4&15|240&b,(15&b)<<4|15&b,1):8===c?br(b>>24&255,b>>16&255,b>>8&255,(255&b)/255):4===c?br(b>>12&15|b>>8&240,b>>8&15|b>>4&240,b>>4&15|240&b,((15&b)<<4|15&b)/255):null):(b=bg.exec(a))?new bt(b[1],b[2],b[3],1):(b=bh.exec(a))?new bt(255*b[1]/100,255*b[2]/100,255*b[3]/100,1):(b=bi.exec(a))?br(b[1],b[2],b[3],b[4]):(b=bj.exec(a))?br(255*b[1]/100,255*b[2]/100,255*b[3]/100,b[4]):(b=bk.exec(a))?bz(b[1],b[2]/100,b[3]/100,1):(b=bl.exec(a))?bz(b[1],b[2]/100,b[3]/100,b[4]):bm.hasOwnProperty(a)?bq(bm[a]):"transparent"===a?new bt(NaN,NaN,NaN,0):null}function bq(a){return new bt(a>>16&255,a>>8&255,255&a,1)}function br(a,b,c,d){return d<=0&&(a=b=c=NaN),new bt(a,b,c,d)}function bs(a,b,c,d){var e;return 1==arguments.length?((e=a)instanceof bb||(e=bp(e)),e)?new bt((e=e.rgb()).r,e.g,e.b,e.opacity):new bt:new bt(a,b,c,null==d?1:d)}function bt(a,b,c,d){this.r=+a,this.g=+b,this.b=+c,this.opacity=+d}function bu(){return`#${by(this.r)}${by(this.g)}${by(this.b)}`}function bv(){let a=bw(this.opacity);return`${1===a?"rgb(":"rgba("}${bx(this.r)}, ${bx(this.g)}, ${bx(this.b)}${1===a?")":`, ${a})`}`}function bw(a){return isNaN(a)?1:Math.max(0,Math.min(1,a))}function bx(a){return Math.max(0,Math.min(255,Math.round(a)||0))}function by(a){return((a=bx(a))<16?"0":"")+a.toString(16)}function bz(a,b,c,d){return d<=0?a=b=c=NaN:c<=0||c>=1?a=b=NaN:b<=0&&(a=NaN),new bB(a,b,c,d)}function bA(a){if(a instanceof bB)return new bB(a.h,a.s,a.l,a.opacity);if(a instanceof bb||(a=bp(a)),!a)return new bB;if(a instanceof bB)return a;var b=(a=a.rgb()).r/255,c=a.g/255,d=a.b/255,e=Math.min(b,c,d),f=Math.max(b,c,d),g=NaN,h=f-e,i=(f+e)/2;return h?(g=b===f?(c-d)/h+(c<d)*6:c===f?(d-b)/h+2:(b-c)/h+4,h/=i<.5?f+e:2-f-e,g*=60):h=i>0&&i<1?0:g,new bB(g,h,i,a.opacity)}function bB(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function bC(a){return(a=(a||0)%360)<0?a+360:a}function bD(a){return Math.max(0,Math.min(1,a||0))}function bE(a,b,c){return(a<60?b+(c-b)*a/60:a<180?c:a<240?b+(c-b)*(240-a)/60:b)*255}function bF(a,b,c,d,e){var f=a*a,g=f*a;return((1-3*a+3*f-g)*b+(4-6*f+3*g)*c+(1+3*a+3*f-3*g)*d+g*e)/6}a9(bb,bp,{copy(a){return Object.assign(new this.constructor,this,a)},displayable(){return this.rgb().displayable()},hex:bn,formatHex:bn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return bA(this).formatHsl()},formatRgb:bo,toString:bo}),a9(bt,bs,ba(bb,{brighter(a){return a=null==a?1.4285714285714286:Math.pow(1.4285714285714286,a),new bt(this.r*a,this.g*a,this.b*a,this.opacity)},darker(a){return a=null==a?.7:Math.pow(.7,a),new bt(this.r*a,this.g*a,this.b*a,this.opacity)},rgb(){return this},clamp(){return new bt(bx(this.r),bx(this.g),bx(this.b),bw(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bu,formatHex:bu,formatHex8:function(){return`#${by(this.r)}${by(this.g)}${by(this.b)}${by((isNaN(this.opacity)?1:this.opacity)*255)}`},formatRgb:bv,toString:bv})),a9(bB,function(a,b,c,d){return 1==arguments.length?bA(a):new bB(a,b,c,null==d?1:d)},ba(bb,{brighter(a){return a=null==a?1.4285714285714286:Math.pow(1.4285714285714286,a),new bB(this.h,this.s,this.l*a,this.opacity)},darker(a){return a=null==a?.7:Math.pow(.7,a),new bB(this.h,this.s,this.l*a,this.opacity)},rgb(){var a=this.h%360+(this.h<0)*360,b=isNaN(a)||isNaN(this.s)?0:this.s,c=this.l,d=c+(c<.5?c:1-c)*b,e=2*c-d;return new bt(bE(a>=240?a-240:a+120,e,d),bE(a,e,d),bE(a<120?a+240:a-120,e,d),this.opacity)},clamp(){return new bB(bC(this.h),bD(this.s),bD(this.l),bw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let a=bw(this.opacity);return`${1===a?"hsl(":"hsla("}${bC(this.h)}, ${100*bD(this.s)}%, ${100*bD(this.l)}%${1===a?")":`, ${a})`}`}}));let bG=a=>()=>a;function bH(a,b){var c=b-a;return c?function(b){return a+b*c}:bG(isNaN(a)?b:a)}let bI=function a(b){var c,d=1==(c=+b)?bH:function(a,b){var d,e,f;return b-a?(d=a,e=b,d=Math.pow(d,f=c),e=Math.pow(e,f)-d,f=1/f,function(a){return Math.pow(d+a*e,f)}):bG(isNaN(a)?b:a)};function e(a,b){var c=d((a=bs(a)).r,(b=bs(b)).r),e=d(a.g,b.g),f=d(a.b,b.b),g=bH(a.opacity,b.opacity);return function(b){return a.r=c(b),a.g=e(b),a.b=f(b),a.opacity=g(b),a+""}}return e.gamma=a,e}(1);function bJ(a){return function(b){var c,d,e=b.length,f=Array(e),g=Array(e),h=Array(e);for(c=0;c<e;++c)d=bs(b[c]),f[c]=d.r||0,g[c]=d.g||0,h[c]=d.b||0;return f=a(f),g=a(g),h=a(h),d.opacity=1,function(a){return d.r=f(a),d.g=g(a),d.b=h(a),d+""}}}bJ(function(a){var b=a.length-1;return function(c){var d=c<=0?c=0:c>=1?(c=1,b-1):Math.floor(c*b),e=a[d],f=a[d+1],g=d>0?a[d-1]:2*e-f,h=d<b-1?a[d+2]:2*f-e;return bF((c-d/b)*b,g,e,f,h)}}),bJ(function(a){var b=a.length;return function(c){var d=Math.floor(((c%=1)<0?++c:c)*b),e=a[(d+b-1)%b],f=a[d%b],g=a[(d+1)%b],h=a[(d+2)%b];return bF((c-d/b)*b,e,f,g,h)}});var bK=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bL=RegExp(bK.source,"g");function bM(a,b){var c,d,e,f,g,h=bK.lastIndex=bL.lastIndex=0,i=-1,j=[],k=[];for(a+="",b+="";(e=bK.exec(a))&&(f=bL.exec(b));)(g=f.index)>h&&(g=b.slice(h,g),j[i]?j[i]+=g:j[++i]=g),(e=e[0])===(f=f[0])?j[i]?j[i]+=f:j[++i]=f:(j[++i]=null,k.push({i:i,x:a1(e,f)})),h=bL.lastIndex;return h<b.length&&(g=b.slice(h),j[i]?j[i]+=g:j[++i]=g),j.length<2?k[0]?(c=k[0].x,function(a){return c(a)+""}):(d=b,function(){return d}):(b=k.length,function(a){for(var c,d=0;d<b;++d)j[(c=k[d]).i]=c.x(a);return j.join("")})}function bN(a,b){var c;return("number"==typeof b?a1:b instanceof bp?bI:(c=bp(b))?(b=c,bI):bM)(a,b)}var bO=am.prototype.constructor;function bP(a){return function(){this.style.removeProperty(a)}}var bQ=0;function bR(a,b,c,d){this._groups=a,this._parents=b,this._name=c,this._id=d}var bS=am.prototype;bR.prototype=(function(a){return am().transition(a)}).prototype={constructor:bR,select:function(a){var b=this._name,c=this._id;"function"!=typeof a&&(a=B(a));for(var d=this._groups,e=d.length,f=Array(e),g=0;g<e;++g)for(var h,i,j=d[g],k=j.length,l=f[g]=Array(k),m=0;m<k;++m)(h=j[m])&&(i=a.call(h,h.__data__,m,j))&&("__data__"in h&&(i.__data__=h.__data__),l[m]=i,aY(l[m],b,c,m,l,a_(h,c)));return new bR(f,this._parents,b,c)},selectAll:function(a){var b=this._name,c=this._id;"function"!=typeof a&&(a=D(a));for(var d=this._groups,e=d.length,f=[],g=[],h=0;h<e;++h)for(var i,j=d[h],k=j.length,l=0;l<k;++l)if(i=j[l]){for(var m,n=a.call(i,i.__data__,l,j),o=a_(i,c),p=0,q=n.length;p<q;++p)(m=n[p])&&aY(m,b,c,p,n,o);f.push(n),g.push(i)}return new bR(f,g,b,c)},selectChild:bS.selectChild,selectChildren:bS.selectChildren,filter:function(a){"function"!=typeof a&&(a=E(a));for(var b=this._groups,c=b.length,d=Array(c),e=0;e<c;++e)for(var f,g=b[e],h=g.length,i=d[e]=[],j=0;j<h;++j)(f=g[j])&&a.call(f,f.__data__,j,g)&&i.push(f);return new bR(d,this._parents,this._name,this._id)},merge:function(a){if(a._id!==this._id)throw Error();for(var b=this._groups,c=a._groups,d=b.length,e=c.length,f=Math.min(d,e),g=Array(d),h=0;h<f;++h)for(var i,j=b[h],k=c[h],l=j.length,m=g[h]=Array(l),n=0;n<l;++n)(i=j[n]||k[n])&&(m[n]=i);for(;h<d;++h)g[h]=b[h];return new bR(g,this._parents,this._name,this._id)},selection:function(){return new bO(this._groups,this._parents)},transition:function(){for(var a=this._name,b=this._id,c=++bQ,d=this._groups,e=d.length,f=0;f<e;++f)for(var g,h=d[f],i=h.length,j=0;j<i;++j)if(g=h[j]){var k=a_(g,b);aY(g,a,c,j,h,{time:k.time+k.delay+k.duration,delay:0,duration:k.duration,ease:k.ease})}return new bR(d,this._parents,a,c)},call:bS.call,nodes:bS.nodes,node:bS.node,size:bS.size,empty:bS.empty,each:bS.each,on:function(a,b){var c,d,e,f,g,h,i=this._id;return arguments.length<2?a_(this.node(),i).on.on(a):this.each((c=i,d=a,e=b,h=(d+"").trim().split(/^|\s+/).every(function(a){var b=a.indexOf(".");return b>=0&&(a=a.slice(0,b)),!a||"start"===a})?aZ:a$,function(){var a=h(this,c),b=a.on;b!==f&&(g=(f=b).copy()).on(d,e),a.on=g}))},attr:function(a,b){var c=S(a),d="transform"===c?a7:bN;return this.attrTween(a,"function"==typeof b?(c.local?function(a,b,c){var d,e,f;return function(){var g,h,i=c(this);return null==i?void this.removeAttributeNS(a.space,a.local):(g=this.getAttributeNS(a.space,a.local))===(h=i+"")?null:g===d&&h===e?f:(e=h,f=b(d=g,i))}}:function(a,b,c){var d,e,f;return function(){var g,h,i=c(this);return null==i?void this.removeAttribute(a):(g=this.getAttribute(a))===(h=i+"")?null:g===d&&h===e?f:(e=h,f=b(d=g,i))}})(c,d,a8(this,"attr."+a,b)):null==b?(c.local?function(a){return function(){this.removeAttributeNS(a.space,a.local)}}:function(a){return function(){this.removeAttribute(a)}})(c):(c.local?function(a,b,c){var d,e,f=c+"";return function(){var g=this.getAttributeNS(a.space,a.local);return g===f?null:g===d?e:e=b(d=g,c)}}:function(a,b,c){var d,e,f=c+"";return function(){var g=this.getAttribute(a);return g===f?null:g===d?e:e=b(d=g,c)}})(c,d,b))},attrTween:function(a,b){var c="attr."+a;if(arguments.length<2)return(c=this.tween(c))&&c._value;if(null==b)return this.tween(c,null);if("function"!=typeof b)throw Error();var d=S(a);return this.tween(c,(d.local?function(a,b){var c,d;function e(){var e=b.apply(this,arguments);return e!==d&&(c=(d=e)&&function(b){this.setAttributeNS(a.space,a.local,e.call(this,b))}),c}return e._value=b,e}:function(a,b){var c,d;function e(){var e=b.apply(this,arguments);return e!==d&&(c=(d=e)&&function(b){this.setAttribute(a,e.call(this,b))}),c}return e._value=b,e})(d,b))},style:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y="transform"==(a+="")?a6:bN;return null==b?this.styleTween(a,(d=a,function(){var a=U(this,d),b=(this.style.removeProperty(d),U(this,d));return a===b?null:a===e&&b===f?g:g=y(e=a,f=b)})).on("end.style."+a,bP(a)):"function"==typeof b?this.styleTween(a,(h=a,i=a8(this,"style."+a,b),function(){var a=U(this,h),b=i(this),c=b+"";return null==b&&(this.style.removeProperty(h),c=b=U(this,h)),a===c?null:a===j&&c===k?l:(k=c,l=y(j=a,b))})).each((m=this._id,t="end."+(s="style."+(n=a)),function(){var a=a$(this,m),b=a.on,c=null==a.value[s]?r||(r=bP(n)):void 0;(b!==o||q!==c)&&(p=(o=b).copy()).on(t,q=c),a.on=p})):this.styleTween(a,(u=a,x=b+"",function(){var a=U(this,u);return a===x?null:a===v?w:w=y(v=a,b)}),c).on("end.style."+a,null)},styleTween:function(a,b,c){var d="style."+(a+="");if(arguments.length<2)return(d=this.tween(d))&&d._value;if(null==b)return this.tween(d,null);if("function"!=typeof b)throw Error();return this.tween(d,function(a,b,c){var d,e;function f(){var f=b.apply(this,arguments);return f!==e&&(d=(e=f)&&function(b){this.style.setProperty(a,f.call(this,b),c)}),d}return f._value=b,f}(a,b,null==c?"":c))},text:function(a){var b,c;return this.tween("text","function"==typeof a?(b=a8(this,"text",a),function(){var a=b(this);this.textContent=null==a?"":a}):(c=null==a?"":a+"",function(){this.textContent=c}))},textTween:function(a){var b="text";if(arguments.length<1)return(b=this.tween(b))&&b._value;if(null==a)return this.tween(b,null);if("function"!=typeof a)throw Error();return this.tween(b,function(a){var b,c;function d(){var d=a.apply(this,arguments);return d!==c&&(b=(c=d)&&function(a){this.textContent=d.call(this,a)}),b}return d._value=a,d}(a))},remove:function(){var a;return this.on("end.remove",(a=this._id,function(){var b=this.parentNode;for(var c in this.__transition)if(+c!==a)return;b&&b.removeChild(this)}))},tween:function(a,b){var c=this._id;if(a+="",arguments.length<2){for(var d,e=a_(this.node(),c).tween,f=0,g=e.length;f<g;++f)if((d=e[f]).name===a)return d.value;return null}return this.each((null==b?function(a,b){var c,d;return function(){var e=a$(this,a),f=e.tween;if(f!==c){d=c=f;for(var g=0,h=d.length;g<h;++g)if(d[g].name===b){(d=d.slice()).splice(g,1);break}}e.tween=d}}:function(a,b,c){var d,e;if("function"!=typeof c)throw Error();return function(){var f=a$(this,a),g=f.tween;if(g!==d){e=(d=g).slice();for(var h={name:b,value:c},i=0,j=e.length;i<j;++i)if(e[i].name===b){e[i]=h;break}i===j&&e.push(h)}f.tween=e}})(c,a,b))},delay:function(a){var b=this._id;return arguments.length?this.each(("function"==typeof a?function(a,b){return function(){aZ(this,a).delay=+b.apply(this,arguments)}}:function(a,b){return b*=1,function(){aZ(this,a).delay=b}})(b,a)):a_(this.node(),b).delay},duration:function(a){var b=this._id;return arguments.length?this.each(("function"==typeof a?function(a,b){return function(){a$(this,a).duration=+b.apply(this,arguments)}}:function(a,b){return b*=1,function(){a$(this,a).duration=b}})(b,a)):a_(this.node(),b).duration},ease:function(a){var b=this._id;return arguments.length?this.each(function(a,b){if("function"!=typeof b)throw Error();return function(){a$(this,a).ease=b}}(b,a)):a_(this.node(),b).ease},easeVarying:function(a){var b;if("function"!=typeof a)throw Error();return this.each((b=this._id,function(){var c=a.apply(this,arguments);if("function"!=typeof c)throw Error();a$(this,b).ease=c}))},end:function(){var a,b,c=this,d=c._id,e=c.size();return new Promise(function(f,g){var h={value:g},i={value:function(){0==--e&&f()}};c.each(function(){var c=a$(this,d),e=c.on;e!==a&&((b=(a=e).copy())._.cancel.push(h),b._.interrupt.push(h),b._.end.push(i)),c.on=b}),0===e&&f()})},[Symbol.iterator]:bS[Symbol.iterator]};var bT={time:null,delay:0,duration:250,ease:function(a){return((a*=2)<=1?a*a*a:(a-=2)*a*a+2)/2}};am.prototype.interrupt=function(a){return this.each(function(){a0(this,a)})},am.prototype.transition=function(a){var b,c;a instanceof bR?(b=a._id,a=a._name):(b=++bQ,(c=bT).time=aO(),a=null==a?null:a+"");for(var d=this._groups,e=d.length,f=0;f<e;++f)for(var g,h=d[f],i=h.length,j=0;j<i;++j)(g=h[j])&&aY(g,a,b,j,h,c||function(a,b){for(var c;!(c=a.__transition)||!(c=c[b]);)if(!(a=a.parentNode))throw Error(`transition ${b} not found`);return c}(g,b));return new bR(d,this._parents,a,b)};let bU=a=>()=>a;function bV(a,{sourceEvent:b,target:c,transform:d,dispatch:e}){Object.defineProperties(this,{type:{value:a,enumerable:!0,configurable:!0},sourceEvent:{value:b,enumerable:!0,configurable:!0},target:{value:c,enumerable:!0,configurable:!0},transform:{value:d,enumerable:!0,configurable:!0},_:{value:e}})}function bW(a,b,c){this.k=a,this.x=b,this.y=c}bW.prototype={constructor:bW,scale:function(a){return 1===a?this:new bW(this.k*a,this.x,this.y)},translate:function(a,b){return 0===a&0===b?this:new bW(this.k,this.x+this.k*a,this.y+this.k*b)},apply:function(a){return[a[0]*this.k+this.x,a[1]*this.k+this.y]},applyX:function(a){return a*this.k+this.x},applyY:function(a){return a*this.k+this.y},invert:function(a){return[(a[0]-this.x)/this.k,(a[1]-this.y)/this.k]},invertX:function(a){return(a-this.x)/this.k},invertY:function(a){return(a-this.y)/this.k},rescaleX:function(a){return a.copy().domain(a.range().map(this.invertX,this).map(a.invert,a))},rescaleY:function(a){return a.copy().domain(a.range().map(this.invertY,this).map(a.invert,a))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bX=new bW(1,0,0);function bY(a){for(;!a.__zoom;)if(!(a=a.parentNode))return bX;return a.__zoom}function bZ(a){a.stopImmediatePropagation()}function b$(a){a.preventDefault(),a.stopImmediatePropagation()}function b_(a){return(!a.ctrlKey||"wheel"===a.type)&&!a.button}function b0(){var a=this;return a instanceof SVGElement?(a=a.ownerSVGElement||a).hasAttribute("viewBox")?[[(a=a.viewBox.baseVal).x,a.y],[a.x+a.width,a.y+a.height]]:[[0,0],[a.width.baseVal.value,a.height.baseVal.value]]:[[0,0],[a.clientWidth,a.clientHeight]]}function b1(){return this.__zoom||bX}function b2(a){return-a.deltaY*(1===a.deltaMode?.05:a.deltaMode?1:.002)*(a.ctrlKey?10:1)}function b3(){return navigator.maxTouchPoints||"ontouchstart"in this}function b4(a,b,c){var d=a.invertX(b[0][0])-c[0][0],e=a.invertX(b[1][0])-c[1][0],f=a.invertY(b[0][1])-c[0][1],g=a.invertY(b[1][1])-c[1][1];return a.translate(e>d?(d+e)/2:Math.min(0,d)||Math.max(0,e),g>f?(f+g)/2:Math.min(0,f)||Math.max(0,g))}function b5(){var a,b,c,d=b_,e=b0,f=b4,g=b2,h=b3,i=[0,1/0],j=[[-1/0,-1/0],[1/0,1/0]],k=250,l=aD,m=x("start","zoom","end"),n=0,o=10;function p(a){a.property("__zoom",b1).on("wheel.zoom",w,{passive:!1}).on("mousedown.zoom",y).on("dblclick.zoom",z).filter(h).on("touchstart.zoom",A).on("touchmove.zoom",B).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function q(a,b){return(b=Math.max(i[0],Math.min(i[1],b)))===a.k?a:new bW(b,a.x,a.y)}function r(a,b,c){var d=b[0]-c[0]*a.k,e=b[1]-c[1]*a.k;return d===a.x&&e===a.y?a:new bW(a.k,d,e)}function s(a){return[(+a[0][0]+ +a[1][0])/2,(+a[0][1]+ +a[1][1])/2]}function t(a,b,c,d){a.on("start.zoom",function(){u(this,arguments).event(d).start()}).on("interrupt.zoom end.zoom",function(){u(this,arguments).event(d).end()}).tween("zoom",function(){var a=arguments,f=u(this,a).event(d),g=e.apply(this,a),h=null==c?s(g):"function"==typeof c?c.apply(this,a):c,i=Math.max(g[1][0]-g[0][0],g[1][1]-g[0][1]),j=this.__zoom,k="function"==typeof b?b.apply(this,a):b,m=l(j.invert(h).concat(i/j.k),k.invert(h).concat(i/k.k));return function(a){if(1===a)a=k;else{var b=m(a),c=i/b[2];a=new bW(c,h[0]-b[0]*c,h[1]-b[1]*c)}f.zoom(null,a)}})}function u(a,b,c){return!c&&a.__zooming||new v(a,b)}function v(a,b){this.that=a,this.args=b,this.active=0,this.sourceEvent=null,this.extent=e.apply(a,b),this.taps=0}function w(a,...b){if(d.apply(this,arguments)){var c=u(this,b).event(a),e=this.__zoom,h=Math.max(i[0],Math.min(i[1],e.k*Math.pow(2,g.apply(this,arguments)))),k=ao(a);if(c.wheel)(c.mouse[0][0]!==k[0]||c.mouse[0][1]!==k[1])&&(c.mouse[1]=e.invert(c.mouse[0]=k)),clearTimeout(c.wheel);else{if(e.k===h)return;c.mouse=[k,e.invert(k)],a0(this),c.start()}b$(a),c.wheel=setTimeout(function(){c.wheel=null,c.end()},150),c.zoom("mouse",f(r(q(e,h),c.mouse[0],c.mouse[1]),c.extent,j))}}function y(a,...b){if(!c&&d.apply(this,arguments)){var e=a.currentTarget,g=u(this,b,!0).event(a),h=an(a.view).on("mousemove.zoom",function(a){if(b$(a),!g.moved){var b=a.clientX-k,c=a.clientY-l;g.moved=b*b+c*c>n}g.event(a).zoom("mouse",f(r(g.that.__zoom,g.mouse[0]=ao(a,e),g.mouse[1]),g.extent,j))},!0).on("mouseup.zoom",function(a){h.on("mousemove.zoom mouseup.zoom",null),au(a.view,g.moved),b$(a),g.event(a).end()},!0),i=ao(a,e),k=a.clientX,l=a.clientY;at(a.view),bZ(a),g.mouse=[i,this.__zoom.invert(i)],a0(this),g.start()}}function z(a,...b){if(d.apply(this,arguments)){var c=this.__zoom,g=ao(a.changedTouches?a.changedTouches[0]:a,this),h=c.invert(g),i=c.k*(a.shiftKey?.5:2),l=f(r(q(c,i),g,h),e.apply(this,b),j);b$(a),k>0?an(this).transition().duration(k).call(t,l,g,a):an(this).call(p.transform,l,g,a)}}function A(c,...e){if(d.apply(this,arguments)){var f,g,h,i,j=c.touches,k=j.length,l=u(this,e,c.changedTouches.length===k).event(c);for(bZ(c),g=0;g<k;++g)i=[i=ao(h=j[g],this),this.__zoom.invert(i),h.identifier],l.touch0?l.touch1||l.touch0[2]===i[2]||(l.touch1=i,l.taps=0):(l.touch0=i,f=!0,l.taps=1+!!a);a&&(a=clearTimeout(a)),f&&(l.taps<2&&(b=i[0],a=setTimeout(function(){a=null},500)),a0(this),l.start())}}function B(a,...b){if(this.__zooming){var c,d,e,g,h=u(this,b).event(a),i=a.changedTouches,k=i.length;for(b$(a),c=0;c<k;++c)e=ao(d=i[c],this),h.touch0&&h.touch0[2]===d.identifier?h.touch0[0]=e:h.touch1&&h.touch1[2]===d.identifier&&(h.touch1[0]=e);if(d=h.that.__zoom,h.touch1){var l=h.touch0[0],m=h.touch0[1],n=h.touch1[0],o=h.touch1[1],p=(p=n[0]-l[0])*p+(p=n[1]-l[1])*p,s=(s=o[0]-m[0])*s+(s=o[1]-m[1])*s;d=q(d,Math.sqrt(p/s)),e=[(l[0]+n[0])/2,(l[1]+n[1])/2],g=[(m[0]+o[0])/2,(m[1]+o[1])/2]}else{if(!h.touch0)return;e=h.touch0[0],g=h.touch0[1]}h.zoom("touch",f(r(d,e,g),h.extent,j))}}function C(a,...d){if(this.__zooming){var e,f,g=u(this,d).event(a),h=a.changedTouches,i=h.length;for(bZ(a),c&&clearTimeout(c),c=setTimeout(function(){c=null},500),e=0;e<i;++e)f=h[e],g.touch0&&g.touch0[2]===f.identifier?delete g.touch0:g.touch1&&g.touch1[2]===f.identifier&&delete g.touch1;if(g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0)g.touch0[1]=this.__zoom.invert(g.touch0[0]);else if(g.end(),2===g.taps&&(f=ao(f,this),Math.hypot(b[0]-f[0],b[1]-f[1])<o)){var j=an(this).on("dblclick.zoom");j&&j.apply(this,arguments)}}}return p.transform=function(a,b,c,d){var e=a.selection?a.selection():a;e.property("__zoom",b1),a!==e?t(a,b,c,d):e.interrupt().each(function(){u(this,arguments).event(d).start().zoom(null,"function"==typeof b?b.apply(this,arguments):b).end()})},p.scaleBy=function(a,b,c,d){p.scaleTo(a,function(){var a=this.__zoom.k,c="function"==typeof b?b.apply(this,arguments):b;return a*c},c,d)},p.scaleTo=function(a,b,c,d){p.transform(a,function(){var a=e.apply(this,arguments),d=this.__zoom,g=null==c?s(a):"function"==typeof c?c.apply(this,arguments):c,h=d.invert(g),i="function"==typeof b?b.apply(this,arguments):b;return f(r(q(d,i),g,h),a,j)},c,d)},p.translateBy=function(a,b,c,d){p.transform(a,function(){return f(this.__zoom.translate("function"==typeof b?b.apply(this,arguments):b,"function"==typeof c?c.apply(this,arguments):c),e.apply(this,arguments),j)},null,d)},p.translateTo=function(a,b,c,d,g){p.transform(a,function(){var a=e.apply(this,arguments),g=this.__zoom,h=null==d?s(a):"function"==typeof d?d.apply(this,arguments):d;return f(bX.translate(h[0],h[1]).scale(g.k).translate("function"==typeof b?-b.apply(this,arguments):-b,"function"==typeof c?-c.apply(this,arguments):-c),a,j)},d,g)},v.prototype={event:function(a){return a&&(this.sourceEvent=a),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(a,b){return this.mouse&&"mouse"!==a&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&"touch"!==a&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&"touch"!==a&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(a){var b=an(this.that).datum();m.call(a,this.that,new bV(a,{sourceEvent:this.sourceEvent,target:p,type:a,transform:this.that.__zoom,dispatch:m}),b)}},p.wheelDelta=function(a){return arguments.length?(g="function"==typeof a?a:bU(+a),p):g},p.filter=function(a){return arguments.length?(d="function"==typeof a?a:bU(!!a),p):d},p.touchable=function(a){return arguments.length?(h="function"==typeof a?a:bU(!!a),p):h},p.extent=function(a){return arguments.length?(e="function"==typeof a?a:bU([[+a[0][0],+a[0][1]],[+a[1][0],+a[1][1]]]),p):e},p.scaleExtent=function(a){return arguments.length?(i[0]=+a[0],i[1]=+a[1],p):[i[0],i[1]]},p.translateExtent=function(a){return arguments.length?(j[0][0]=+a[0][0],j[1][0]=+a[1][0],j[0][1]=+a[0][1],j[1][1]=+a[1][1],p):[[j[0][0],j[0][1]],[j[1][0],j[1][1]]]},p.constrain=function(a){return arguments.length?(f=a,p):f},p.duration=function(a){return arguments.length?(k=+a,p):k},p.interpolate=function(a){return arguments.length?(l=a,p):l},p.on=function(){var a=m.on.apply(m,arguments);return a===m?p:a},p.clickDistance=function(a){return arguments.length?(n=(a*=1)*a,p):Math.sqrt(n)},p.tapDistance=function(a){return arguments.length?(o=+a,p):o},p}function b6(a,b){var c,d,e=typeof b;return null==b||"boolean"===e?bG(b):("number"===e?a1:"string"===e?(d=bp(b))?(b=d,bI):bM:b instanceof bp?bI:b instanceof Date?function(a,b){var c=new Date;return a*=1,b*=1,function(d){return c.setTime(a*(1-d)+b*d),c}}:!ArrayBuffer.isView(c=b)||c instanceof DataView?Array.isArray(b)?function(a,b){var c,d=b?b.length:0,e=a?Math.min(d,a.length):0,f=Array(e),g=Array(d);for(c=0;c<e;++c)f[c]=b6(a[c],b[c]);for(;c<d;++c)g[c]=b[c];return function(a){for(c=0;c<e;++c)g[c]=f[c](a);return g}}:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?function(a,b){var c,d={},e={};for(c in(null===a||"object"!=typeof a)&&(a={}),(null===b||"object"!=typeof b)&&(b={}),b)c in a?d[c]=b6(a[c],b[c]):e[c]=b[c];return function(a){for(c in d)e[c]=d[c](a);return e}}:a1:function(a,b){b||(b=[]);var c,d=a?Math.min(b.length,a.length):0,e=b.slice();return function(f){for(c=0;c<d;++c)e[c]=a[c]*(1-f)+b[c]*f;return e}})(a,b)}bY.prototype=bW.prototype;let b7=[[-1/0,-1/0],[1/0,1/0]],b8=["Enter"," ","Escape"],b9={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:a,x:b,y:c})=>`Moved selected node ${a}. New position, x: ${b}, y: ${c}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};(b=k||(k={})).Strict="strict",b.Loose="loose",(c=l||(l={})).Free="free",c.Vertical="vertical",c.Horizontal="horizontal",(d=m||(m={})).Partial="partial",d.Full="full";let ca={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};(e=n||(n={})).Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier",(f=o||(o={})).Arrow="arrow",f.ArrowClosed="arrowclosed",(g=p||(p={})).Left="left",g.Top="top",g.Right="right",g.Bottom="bottom";let cb={[p.Left]:p.Right,[p.Right]:p.Left,[p.Top]:p.Bottom,[p.Bottom]:p.Top};function cc(a){return null===a?null:a?"valid":"invalid"}let cd=a=>"id"in a&&"source"in a&&"target"in a,ce=a=>"id"in a&&"internals"in a&&!("source"in a)&&!("target"in a),cf=(a,b=[0,0])=>{let{width:c,height:d}=cH(a),e=a.origin??b,f=c*e[0],g=d*e[1];return{x:a.position.x-f,y:a.position.y-g}},cg=(a,b={})=>{let c={x:1/0,y:1/0,x2:-1/0,y2:-1/0},d=!1;return a.forEach(a=>{(void 0===b.filter||b.filter(a))&&(c=cq(c,cu(a)),d=!0)}),d?cs(c):{x:0,y:0,width:0,height:0}},ch=(a,b,[c,d,e]=[0,0,1],f=!1,g=!1)=>{let h={...cB(b,[c,d,e]),width:b.width/e,height:b.height/e},i=[];for(let b of a.values()){let{measured:a,selectable:c=!0,hidden:d=!1}=b;if(g&&!c||d)continue;let e=a.width??b.width??b.initialWidth??null,j=a.height??b.height??b.initialHeight??null,k=cw(h,ct(b)),l=(e??0)*(j??0),m=f&&k>0;(!b.internals.handleBounds||m||k>=l||b.dragging)&&i.push(b)}return i};async function ci({nodes:a,width:b,height:c,panZoom:d,minZoom:e,maxZoom:f},g){let h,i;if(0===a.size)return Promise.resolve(!0);let j=cE(cg((h=new Map,i=g?.nodes?new Set(g.nodes.map(a=>a.id)):null,a.forEach(a=>{a.measured.width&&a.measured.height&&(g?.includeHiddenNodes||!a.hidden)&&(!i||i.has(a.id))&&h.set(a.id,a)}),h)),b,c,g?.minZoom??e,g?.maxZoom??f,g?.padding??.1);return await d.setViewport(j,{duration:g?.duration,ease:g?.ease,interpolate:g?.interpolate}),Promise.resolve(!0)}function cj({nodeId:a,nextPosition:b,nodeLookup:c,nodeOrigin:d=[0,0],nodeExtent:e,onError:f}){let g=c.get(a),h=g.parentId?c.get(g.parentId):void 0,{x:i,y:j}=h?h.internals.positionAbsolute:{x:0,y:0},k=g.origin??d,l=g.extent||e;if("parent"!==g.extent||g.expandParent)h&&cG(g.extent)&&(l=[[g.extent[0][0]+i,g.extent[0][1]+j],[g.extent[1][0]+i,g.extent[1][1]+j]]);else if(h){let a=h.measured.width,b=h.measured.height;a&&b&&(l=[[i,j],[i+a,j+b]])}else f?.("005","Only child nodes can use a parent extent.");let m=cG(l)?cm(b,l,g.measured):b;return(void 0===g.measured.width||void 0===g.measured.height)&&f?.("015","It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."),{position:{x:m.x-i+(g.measured.width??0)*k[0],y:m.y-j+(g.measured.height??0)*k[1]},positionAbsolute:m}}async function ck({nodesToRemove:a=[],edgesToRemove:b=[],nodes:c,edges:d,onBeforeDelete:e}){let f,g=new Set(a.map(a=>a.id)),h=[];for(let a of c){if(!1===a.deletable)continue;let b=g.has(a.id),c=!b&&a.parentId&&h.find(b=>b.id===a.parentId);(b||c)&&h.push(a)}let i=new Set(b.map(a=>a.id)),j=d.filter(a=>!1!==a.deletable),k=(f=new Set,h.forEach(a=>{f.add(a.id)}),j.filter(a=>f.has(a.source)||f.has(a.target)));for(let a of j)i.has(a.id)&&!k.find(b=>b.id===a.id)&&k.push(a);if(!e)return{edges:k,nodes:h};let l=await e({nodes:h,edges:k});return"boolean"==typeof l?l?{edges:k,nodes:h}:{edges:[],nodes:[]}:l}let cl=(a,b=0,c=1)=>Math.min(Math.max(a,b),c),cm=(a={x:0,y:0},b,c)=>({x:cl(a.x,b[0][0],b[1][0]-(c?.width??0)),y:cl(a.y,b[0][1],b[1][1]-(c?.height??0))});function cn(a,b,c){let{width:d,height:e}=cH(c),{x:f,y:g}=c.internals.positionAbsolute;return cm(a,[[f,g],[f+d,g+e]],b)}let co=(a,b,c)=>a<b?cl(Math.abs(a-b),1,b)/b:a>c?-cl(Math.abs(a-c),1,b)/b:0,cp=(a,b,c=15,d=40)=>[co(a.x,d,b.width-d)*c,co(a.y,d,b.height-d)*c],cq=(a,b)=>({x:Math.min(a.x,b.x),y:Math.min(a.y,b.y),x2:Math.max(a.x2,b.x2),y2:Math.max(a.y2,b.y2)}),cr=({x:a,y:b,width:c,height:d})=>({x:a,y:b,x2:a+c,y2:b+d}),cs=({x:a,y:b,x2:c,y2:d})=>({x:a,y:b,width:c-a,height:d-b}),ct=(a,b=[0,0])=>{let{x:c,y:d}=ce(a)?a.internals.positionAbsolute:cf(a,b);return{x:c,y:d,width:a.measured?.width??a.width??a.initialWidth??0,height:a.measured?.height??a.height??a.initialHeight??0}},cu=(a,b=[0,0])=>{let{x:c,y:d}=ce(a)?a.internals.positionAbsolute:cf(a,b);return{x:c,y:d,x2:c+(a.measured?.width??a.width??a.initialWidth??0),y2:d+(a.measured?.height??a.height??a.initialHeight??0)}},cv=(a,b)=>cs(cq(cr(a),cr(b))),cw=(a,b)=>Math.ceil(Math.max(0,Math.min(a.x+a.width,b.x+b.width)-Math.max(a.x,b.x))*Math.max(0,Math.min(a.y+a.height,b.y+b.height)-Math.max(a.y,b.y))),cx=a=>cy(a.width)&&cy(a.height)&&cy(a.x)&&cy(a.y),cy=a=>!isNaN(a)&&isFinite(a),cz=(a,b)=>{},cA=(a,b=[1,1])=>({x:b[0]*Math.round(a.x/b[0]),y:b[1]*Math.round(a.y/b[1])}),cB=({x:a,y:b},[c,d,e],f=!1,g=[1,1])=>{let h={x:(a-c)/e,y:(b-d)/e};return f?cA(h,g):h},cC=({x:a,y:b},[c,d,e])=>({x:a*e+c,y:b*e+d});function cD(a,b){if("number"==typeof a)return Math.floor((b-b/(1+a))*.5);if("string"==typeof a&&a.endsWith("px")){let b=parseFloat(a);if(!Number.isNaN(b))return Math.floor(b)}if("string"==typeof a&&a.endsWith("%")){let c=parseFloat(a);if(!Number.isNaN(c))return Math.floor(b*c*.01)}return console.error(`[React Flow] The padding value "${a}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}let cE=(a,b,c,d,e,f)=>{let g=function(a,b,c){if("string"==typeof a||"number"==typeof a){let d=cD(a,c),e=cD(a,b);return{top:d,right:e,bottom:d,left:e,x:2*e,y:2*d}}if("object"==typeof a){let d=cD(a.top??a.y??0,c),e=cD(a.bottom??a.y??0,c),f=cD(a.left??a.x??0,b),g=cD(a.right??a.x??0,b);return{top:d,right:g,bottom:e,left:f,x:f+g,y:d+e}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(f,b,c),h=cl(Math.min((b-g.x)/a.width,(c-g.y)/a.height),d,e),i=a.x+a.width/2,j=a.y+a.height/2,k=b/2-i*h,l=c/2-j*h,m=function(a,b,c,d,e,f){let{x:g,y:h}=cC(a,[b,c,d]),{x:i,y:j}=cC({x:a.x+a.width,y:a.y+a.height},[b,c,d]);return{left:Math.floor(g),top:Math.floor(h),right:Math.floor(e-i),bottom:Math.floor(f-j)}}(a,k,l,h,b,c),n={left:Math.min(m.left-g.left,0),top:Math.min(m.top-g.top,0),right:Math.min(m.right-g.right,0),bottom:Math.min(m.bottom-g.bottom,0)};return{x:k-n.left+n.right,y:l-n.top+n.bottom,zoom:h}},cF=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0;function cG(a){return null!=a&&"parent"!==a}function cH(a){return{width:a.measured?.width??a.width??a.initialWidth??0,height:a.measured?.height??a.height??a.initialHeight??0}}function cI(a){return(a.measured?.width??a.width??a.initialWidth)!==void 0&&(a.measured?.height??a.height??a.initialHeight)!==void 0}function cJ(a,b={width:0,height:0},c,d,e){let f={...a},g=d.get(c);if(g){let a=g.origin||e;f.x+=g.internals.positionAbsolute.x-(b.width??0)*a[0],f.y+=g.internals.positionAbsolute.y-(b.height??0)*a[1]}return f}function cK(a,b){if(a.size!==b.size)return!1;for(let c of a)if(!b.has(c))return!1;return!0}function cL(a,{snapGrid:b=[0,0],snapToGrid:c=!1,transform:d,containerBounds:e}){let{x:f,y:g}=cQ(a),h=cB({x:f-(e?.left??0),y:g-(e?.top??0)},d),{x:i,y:j}=c?cA(h,b):h;return{xSnapped:i,ySnapped:j,...h}}let cM=a=>({width:a.offsetWidth,height:a.offsetHeight}),cN=a=>a?.getRootNode?.()||window?.document,cO=["INPUT","SELECT","TEXTAREA"];function cP(a){let b=a.composedPath?.()?.[0]||a.target;return b?.nodeType===1&&(cO.includes(b.nodeName)||b.hasAttribute("contenteditable")||!!b.closest(".nokey"))}let cQ=(a,b)=>{let c="clientX"in a,d=c?a.clientX:a.touches?.[0].clientX,e=c?a.clientY:a.touches?.[0].clientY;return{x:d-(b?.left??0),y:e-(b?.top??0)}},cR=(a,b,c,d,e)=>{let f=b.querySelectorAll(`.${a}`);return f&&f.length?Array.from(f).map(b=>{let f=b.getBoundingClientRect();return{id:b.getAttribute("data-handleid"),type:a,nodeId:e,position:b.getAttribute("data-handlepos"),x:(f.left-c.left)/d,y:(f.top-c.top)/d,...cM(b)}}):null};function cS({sourceX:a,sourceY:b,targetX:c,targetY:d,sourceControlX:e,sourceControlY:f,targetControlX:g,targetControlY:h}){let i=.125*a+.375*e+.375*g+.125*c,j=.125*b+.375*f+.375*h+.125*d,k=Math.abs(i-a),l=Math.abs(j-b);return[i,j,k,l]}function cT(a,b){return a>=0?.5*a:25*b*Math.sqrt(-a)}function cU({pos:a,x1:b,y1:c,x2:d,y2:e,c:f}){switch(a){case p.Left:return[b-cT(b-d,f),c];case p.Right:return[b+cT(d-b,f),c];case p.Top:return[b,c-cT(c-e,f)];case p.Bottom:return[b,c+cT(e-c,f)]}}function cV({sourceX:a,sourceY:b,sourcePosition:c=p.Bottom,targetX:d,targetY:e,targetPosition:f=p.Top,curvature:g=.25}){let[h,i]=cU({pos:c,x1:a,y1:b,x2:d,y2:e,c:g}),[j,k]=cU({pos:f,x1:d,y1:e,x2:a,y2:b,c:g}),[l,m,n,o]=cS({sourceX:a,sourceY:b,targetX:d,targetY:e,sourceControlX:h,sourceControlY:i,targetControlX:j,targetControlY:k});return[`M${a},${b} C${h},${i} ${j},${k} ${d},${e}`,l,m,n,o]}function cW({sourceX:a,sourceY:b,targetX:c,targetY:d}){let e=Math.abs(c-a)/2,f=Math.abs(d-b)/2;return[c<a?c+e:c-e,d<b?d+f:d-f,e,f]}let cX=({source:a,sourceHandle:b,target:c,targetHandle:d})=>`xy-edge__${a}${b||""}-${c}${d||""}`,cY=(a,b,c={})=>{let d,e;if(!a.source||!a.target)return cz("006","Can't create edge. An edge needs a source and a target."),b;let f=c.getEdgeId||cX;return(e=d=cd(a)?{...a}:{...a,id:f(a)},b.some(a=>a.source===e.source&&a.target===e.target&&(a.sourceHandle===e.sourceHandle||!a.sourceHandle&&!e.sourceHandle)&&(a.targetHandle===e.targetHandle||!a.targetHandle&&!e.targetHandle)))?b:(null===d.sourceHandle&&delete d.sourceHandle,null===d.targetHandle&&delete d.targetHandle,b.concat(d))};function cZ({sourceX:a,sourceY:b,targetX:c,targetY:d}){let[e,f,g,h]=cW({sourceX:a,sourceY:b,targetX:c,targetY:d});return[`M ${a},${b}L ${c},${d}`,e,f,g,h]}let c$={[p.Left]:{x:-1,y:0},[p.Right]:{x:1,y:0},[p.Top]:{x:0,y:-1},[p.Bottom]:{x:0,y:1}},c_=({source:a,sourcePosition:b=p.Bottom,target:c})=>b===p.Left||b===p.Right?a.x<c.x?{x:1,y:0}:{x:-1,y:0}:a.y<c.y?{x:0,y:1}:{x:0,y:-1},c0=(a,b)=>Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2));function c1({sourceX:a,sourceY:b,sourcePosition:c=p.Bottom,targetX:d,targetY:e,targetPosition:f=p.Top,borderRadius:g=5,centerX:h,centerY:i,offset:j=20,stepPosition:k=.5}){let[l,m,n,o,q]=function({source:a,sourcePosition:b=p.Bottom,target:c,targetPosition:d=p.Top,center:e,offset:f,stepPosition:g}){let h,i,j=c$[b],k=c$[d],l={x:a.x+j.x*f,y:a.y+j.y*f},m={x:c.x+k.x*f,y:c.y+k.y*f},n=c_({source:l,sourcePosition:b,target:m}),o=0!==n.x?"x":"y",q=n[o],r=[],s={x:0,y:0},t={x:0,y:0},[,,u,v]=cW({sourceX:a.x,sourceY:a.y,targetX:c.x,targetY:c.y});if(j[o]*k[o]==-1){"x"===o?(h=e.x??l.x+(m.x-l.x)*g,i=e.y??(l.y+m.y)/2):(h=e.x??(l.x+m.x)/2,i=e.y??l.y+(m.y-l.y)*g);let a=[{x:h,y:l.y},{x:h,y:m.y}],b=[{x:l.x,y:i},{x:m.x,y:i}];r=j[o]===q?"x"===o?a:b:"x"===o?b:a}else{let e=[{x:l.x,y:m.y}],g=[{x:m.x,y:l.y}];if(r="x"===o?j.x===q?g:e:j.y===q?e:g,b===d){let b=Math.abs(a[o]-c[o]);if(b<=f){let d=Math.min(f-1,f-b);j[o]===q?s[o]=(l[o]>a[o]?-1:1)*d:t[o]=(m[o]>c[o]?-1:1)*d}}if(b!==d){let a="x"===o?"y":"x",b=j[o]===k[a],c=l[a]>m[a],d=l[a]<m[a];(1===j[o]&&(!b&&c||b&&d)||1!==j[o]&&(!b&&d||b&&c))&&(r="x"===o?e:g)}let n={x:l.x+s.x,y:l.y+s.y},p={x:m.x+t.x,y:m.y+t.y};Math.max(Math.abs(n.x-r[0].x),Math.abs(p.x-r[0].x))>=Math.max(Math.abs(n.y-r[0].y),Math.abs(p.y-r[0].y))?(h=(n.x+p.x)/2,i=r[0].y):(h=r[0].x,i=(n.y+p.y)/2)}return[[a,{x:l.x+s.x,y:l.y+s.y},...r,{x:m.x+t.x,y:m.y+t.y},c],h,i,u,v]}({source:{x:a,y:b},sourcePosition:c,target:{x:d,y:e},targetPosition:f,center:{x:h,y:i},offset:j,stepPosition:k});return[l.reduce((a,b,c)=>a+(c>0&&c<l.length-1?function(a,b,c,d){let e=Math.min(c0(a,b)/2,c0(b,c)/2,d),{x:f,y:g}=b;if(a.x===f&&f===c.x||a.y===g&&g===c.y)return`L${f} ${g}`;if(a.y===g){let b=a.x<c.x?-1:1,d=a.y<c.y?1:-1;return`L ${f+e*b},${g}Q ${f},${g} ${f},${g+e*d}`}let h=a.x<c.x?1:-1,i=a.y<c.y?-1:1;return`L ${f},${g+e*i}Q ${f},${g} ${f+e*h},${g}`}(l[c-1],b,l[c+1],g):`${0===c?"M":"L"}${b.x} ${b.y}`),""),m,n,o,q]}function c2(a){return a&&!!(a.internals.handleBounds||a.handles?.length)&&!!(a.measured.width||a.width||a.initialWidth)}function c3(a){if(!a)return null;let b=[],c=[];for(let d of a)d.width=d.width??1,d.height=d.height??1,"source"===d.type?b.push(d):"target"===d.type&&c.push(d);return{source:b,target:c}}function c4(a,b,c=p.Left,d=!1){let e=(b?.x??0)+a.internals.positionAbsolute.x,f=(b?.y??0)+a.internals.positionAbsolute.y,{width:g,height:h}=b??cH(a);if(d)return{x:e+g/2,y:f+h/2};switch(b?.position??c){case p.Top:return{x:e+g/2,y:f};case p.Right:return{x:e+g,y:f+h/2};case p.Bottom:return{x:e+g/2,y:f+h};case p.Left:return{x:e,y:f+h/2}}}function c5(a,b){return a&&(b?a.find(a=>a.id===b):a[0])||null}function c6(a,b){if(!a)return"";if("string"==typeof a)return a;let c=b?`${b}__`:"";return`${c}${Object.keys(a).sort().map(b=>`${b}=${a[b]}`).join("&")}`}let c7={nodeOrigin:[0,0],nodeExtent:b7,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},c8={...c7,checkEquality:!0};function c9(a,b){let c={...a};for(let a in b)void 0!==b[a]&&(c[a]=b[a]);return c}function da(a){return"manual"===a}function db(a,b,c,d={}){let e=c9(c8,d),f={i:0},g=new Map(b),h=e?.elevateNodesOnSelect&&!da(e.zIndexMode)?1e3:0,i=a.length>0;for(let j of(b.clear(),c.clear(),a)){let a=g.get(j.id);if(e.checkEquality&&j===a?.internals.userNode)b.set(j.id,a);else{let c=cm(cf(j,e.nodeOrigin),cG(j.extent)?j.extent:e.nodeExtent,cH(j));a={...e.defaults,...j,measured:{width:j.measured?.width,height:j.measured?.height},internals:{positionAbsolute:c,handleBounds:function(a,b){if(!a.handles)return a.measured?b?.internals.handleBounds:void 0;let c=[],d=[];for(let b of a.handles){let e={id:b.id,width:b.width??1,height:b.height??1,nodeId:a.id,x:b.x,y:b.y,position:b.position,type:b.type};"source"===b.type?c.push(e):"target"===b.type&&d.push(e)}return{source:c,target:d}}(j,a),z:dd(j,h,e.zIndexMode),userNode:j}},b.set(j.id,a)}void 0!==a.measured&&void 0!==a.measured.width&&void 0!==a.measured.height||a.hidden||(i=!1),j.parentId&&dc(a,b,c,d,f)}return i}function dc(a,b,c,d,e){let{elevateNodesOnSelect:f,nodeOrigin:g,nodeExtent:h,zIndexMode:i}=c9(c7,d),j=a.parentId,k=b.get(j);if(!k)return void console.warn(`Parent node ${j} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);!function(a,b){if(!a.parentId)return;let c=b.get(a.parentId);c?c.set(a.id,a):b.set(a.parentId,new Map([[a.id,a]]))}(a,c),e&&!k.parentId&&void 0===k.internals.rootParentIndex&&"auto"===i&&(k.internals.rootParentIndex=++e.i,k.internals.z=k.internals.z+10*e.i),e&&void 0!==k.internals.rootParentIndex&&(e.i=k.internals.rootParentIndex);let{x:l,y:m,z:n}=function(a,b,c,d,e,f){let{x:g,y:h}=b.internals.positionAbsolute,i=cH(a),j=cf(a,c),k=cG(a.extent)?cm(j,a.extent,i):j,l=cm({x:g+k.x,y:h+k.y},d,i);"parent"===a.extent&&(l=cn(l,i,b));let m=dd(a,e,f),n=b.internals.z??0;return{x:l.x,y:l.y,z:n>=m?n+1:m}}(a,k,g,h,f&&!da(i)?1e3:0,i),{positionAbsolute:o}=a.internals,p=l!==o.x||m!==o.y;(p||n!==a.internals.z)&&b.set(a.id,{...a,internals:{...a.internals,positionAbsolute:p?{x:l,y:m}:o,z:n}})}function dd(a,b,c){let d=cy(a.zIndex)?a.zIndex:0;return da(c)?d:d+(a.selected?b:0)}function de(a,b,c,d=[0,0]){let e=[],f=new Map;for(let c of a){let a=b.get(c.parentId);if(!a)continue;let d=cv(f.get(c.parentId)?.expandedRect??ct(a),c.rect);f.set(c.parentId,{expandedRect:d,parent:a})}return f.size>0&&f.forEach(({expandedRect:b,parent:f},g)=>{let h=f.internals.positionAbsolute,i=cH(f),j=f.origin??d,k=b.x<h.x?Math.round(Math.abs(h.x-b.x)):0,l=b.y<h.y?Math.round(Math.abs(h.y-b.y)):0,m=Math.max(i.width,Math.round(b.width)),n=Math.max(i.height,Math.round(b.height)),o=(m-i.width)*j[0],p=(n-i.height)*j[1];(k>0||l>0||o||p)&&(e.push({id:g,type:"position",position:{x:f.position.x-k+o,y:f.position.y-l+p}}),c.get(g)?.forEach(b=>{a.some(a=>a.id===b.id)||e.push({id:b.id,type:"position",position:{x:b.position.x+k,y:b.position.y+l}})})),(i.width<b.width||i.height<b.height||k||l)&&e.push({id:g,type:"dimensions",setAttributes:!0,dimensions:{width:m+(k?j[0]*k-o:0),height:n+(l?j[1]*l-p:0)}})}),e}async function df({delta:a,panZoom:b,transform:c,translateExtent:d,width:e,height:f}){if(!b||!a.x&&!a.y)return Promise.resolve(!1);let g=await b.setViewportConstrained({x:c[0]+a.x,y:c[1]+a.y,zoom:c[2]},[[0,0],[e,f]],d);return Promise.resolve(!!g&&(g.x!==c[0]||g.y!==c[1]||g.k!==c[2]))}function dg(a,b,c,d,e,f){let g=e,h=d.get(g)||new Map;d.set(g,h.set(c,b)),g=`${e}-${a}`;let i=d.get(g)||new Map;if(d.set(g,i.set(c,b)),f){g=`${e}-${a}-${f}`;let h=d.get(g)||new Map;d.set(g,h.set(c,b))}}function dh(a,b,c){for(let d of(a.clear(),b.clear(),c)){let{source:c,target:e,sourceHandle:f=null,targetHandle:g=null}=d,h={edgeId:d.id,source:c,target:e,sourceHandle:f,targetHandle:g},i=`${c}-${f}--${e}-${g}`;dg("source",h,`${e}-${g}--${c}-${f}`,a,c,f),dg("target",h,i,a,e,g),b.set(d.id,d)}}function di(a,b,c){let d=a;do{if(d?.matches?.(b))return!0;if(d===c)break;d=d?.parentElement}while(d)return!1}function dj({nodeId:a,dragItems:b,nodeLookup:c,dragging:d=!0}){let e=[];for(let[a,f]of b){let b=c.get(a)?.internals.userNode;b&&e.push({...b,position:f.position,dragging:d})}if(!a)return[e[0],e];let f=c.get(a)?.internals.userNode;return[f?{...f,position:b.get(a)?.position||f.position,dragging:d}:e[0],e]}function dk(a,b,c,d,e,f=!1){let g=d.get(a);if(!g)return null;let h="strict"===e?g.internals.handleBounds?.[b]:[...g.internals.handleBounds?.source??[],...g.internals.handleBounds?.target??[]],i=(c?h?.find(a=>a.id===c):h?.[0])??null;return i&&f?{...i,...c4(g,i,i.position,!0)}:i}function dl(a,b){return a?a:b?.classList.contains("target")?"target":b?.classList.contains("source")?"source":null}let dm=()=>!0;function dn(a,{handle:b,connectionMode:c,fromNodeId:d,fromHandleId:e,fromType:f,doc:g,lib:h,flowId:i,isValidConnection:j=dm,nodeLookup:l}){let m="target"===f,n=b?g.querySelector(`.${h}-flow__handle[data-id="${i}-${b?.nodeId}-${b?.id}-${b?.type}"]`):null,{x:o,y:p}=cQ(a),q=g.elementFromPoint(o,p),r=q?.classList.contains(`${h}-flow__handle`)?q:n,s={handleDomNode:r,isValid:!1,connection:null,toHandle:null};if(r){let a=dl(void 0,r),b=r.getAttribute("data-nodeid"),f=r.getAttribute("data-handleid"),g=r.classList.contains("connectable"),h=r.classList.contains("connectableend");if(!b||!a)return s;let i={source:m?b:d,sourceHandle:m?f:e,target:m?d:b,targetHandle:m?e:f};s.connection=i,s.isValid=g&&h&&(c===k.Strict?m&&"source"===a||!m&&"target"===a:b!==d||f!==e)&&j(i),s.toHandle=dk(b,a,f,l,c,!0)}return s}let dp=function(a,{connectionMode:b,connectionRadius:c,handleId:d,nodeId:e,edgeUpdaterType:f,isTarget:g,domNode:h,nodeLookup:i,lib:j,autoPanOnConnect:k,flowId:l,panBy:m,cancelConnection:n,onConnectStart:o,onConnect:q,onConnectEnd:r,isValidConnection:s=dm,onReconnectEnd:t,updateConnection:u,getTransform:v,getFromHandle:w,autoPanSpeed:x,dragThreshold:y=1,handleDomNode:z}){let A,B=cN(a.target),C=0,{x:D,y:E}=cQ(a),F=dl(f,z),G=h?.getBoundingClientRect(),H=!1;if(!G||!F)return;let I=dk(e,F,d,i,b);if(!I)return;let J=cQ(a,G),K=!1,L=null,M=!1,N=null,O={...I,nodeId:e,type:F,position:I.position},P=i.get(e),Q={inProgress:!0,isValid:null,from:c4(P,O,p.Left,!0),fromHandle:O,fromPosition:O.position,fromNode:P,to:J,toHandle:null,toPosition:cb[O.position],toNode:null,pointer:J};function R(){H=!0,u(Q),o?.(a,{nodeId:e,handleId:d,handleType:F})}function S(a){var f,h;let n;if(!H){let{x:b,y:c}=cQ(a),d=b-D,e=c-E;if(!(d*d+e*e>y*y))return;R()}if(!w()||!O)return void T(a);let o=v();A=function(a,b,c,d){let e=[],f=1/0;for(let g of function(a,b,c){let d=[],e={x:a.x-c,y:a.y-c,width:2*c,height:2*c};for(let a of b.values())cw(e,ct(a))>0&&d.push(a);return d}(a,c,b+250))for(let c of[...g.internals.handleBounds?.source??[],...g.internals.handleBounds?.target??[]]){if(d.nodeId===c.nodeId&&d.type===c.type&&d.id===c.id)continue;let{x:h,y:i}=c4(g,c,c.position,!0),j=Math.sqrt(Math.pow(h-a.x,2)+Math.pow(i-a.y,2));j>b||(j<f?(e=[{...c,x:h,y:i}],f=j):j===f&&e.push({...c,x:h,y:i}))}if(!e.length)return null;if(e.length>1){let a="source"===d.type?"target":"source";return e.find(b=>b.type===a)??e[0]}return e[0]}(cB(J=cQ(a,G),o,!1,[1,1]),c,i,O),K||(!function a(){if(!k||!G)return;let[b,c]=cp(J,G,x);m({x:b,y:c}),C=requestAnimationFrame(a)}(),K=!0);let q=dn(a,{handle:A,connectionMode:b,fromNodeId:e,fromHandleId:d,fromType:g?"target":"source",isValidConnection:s,doc:B,lib:j,flowId:l,nodeLookup:i});N=q.handleDomNode,L=q.connection,f=!!A,h=q.isValid,n=null,h?n=!0:f&&!h&&(n=!1),M=n;let r=i.get(e),t=r?c4(r,O,p.Left,!0):Q.from,z={...Q,from:t,isValid:M,to:q.toHandle&&M?cC({x:q.toHandle.x,y:q.toHandle.y},o):J,toHandle:q.toHandle,toPosition:M&&q.toHandle?q.toHandle.position:cb[O.position],toNode:q.toHandle?i.get(q.toHandle.nodeId):null,pointer:J};u(z),Q=z}function T(a){if(!("touches"in a)||!(a.touches.length>0)){if(H){(A||N)&&L&&M&&q?.(L);let{inProgress:b,...c}=Q,d={...c,toPosition:Q.toHandle?Q.toPosition:null};r?.(a,d),f&&t?.(a,d)}n(),cancelAnimationFrame(C),K=!1,M=!1,L=null,N=null,B.removeEventListener("mousemove",S),B.removeEventListener("mouseup",T),B.removeEventListener("touchmove",S),B.removeEventListener("touchend",T)}}0===y&&R(),B.addEventListener("mousemove",S),B.addEventListener("mouseup",T),B.addEventListener("touchmove",S),B.addEventListener("touchend",T)},dq=a=>({x:a.x,y:a.y,zoom:a.k}),dr=({x:a,y:b,zoom:c})=>bX.translate(a,b).scale(c),ds=(a,b)=>a.target.closest(`.${b}`),dt=(a,b)=>2===b&&Array.isArray(a)&&a.includes(2),du=a=>((a*=2)<=1?a*a*a:(a-=2)*a*a+2)/2,dv=(a,b=0,c=du,d=()=>{})=>{let e="number"==typeof b&&b>0;return e||d(),e?a.transition().duration(b).ease(c).on("end",d):a},dw=a=>{let b=a.ctrlKey&&cF()?10:1;return-a.deltaY*(1===a.deltaMode?.05:a.deltaMode?1:.002)*b};function dx(a){let b=a.includes("right")||a.includes("left"),c=a.includes("bottom")||a.includes("top");return{isHorizontal:b,isVertical:c,affectsX:a.includes("left"),affectsY:a.includes("top")}}function dy(a,b){return Math.max(0,b-a)}function dz(a,b){return Math.max(0,a-b)}function dA(a,b,c){return Math.max(0,b-a,a-c)}(h=q||(q={})).Line="line",h.Handle="handle";let dB={width:0,height:0,x:0,y:0},dC={...dB,pointerX:0,pointerY:0,aspectRatio:1};var dD=a.i(64442);let dE={get url(){return`file://${a.P("node_modules/zustand/esm/vanilla.mjs")}`}},dF=a=>{let b,c=new Set,d=(a,d)=>{let e="function"==typeof a?a(b):a;if(!Object.is(e,b)){let a=b;b=(null!=d?d:"object"!=typeof e||null===e)?e:Object.assign({},b,e),c.forEach(c=>c(b,a))}},e=()=>b,f={setState:d,getState:e,getInitialState:()=>g,subscribe:a=>(c.add(a),()=>c.delete(a)),destroy:()=>{(dE.env?dE.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),c.clear()}},g=b=a(d,e,f);return f},{useDebugValue:dG}=t.default,{useSyncExternalStoreWithSelector:dH}=dD.default,dI=a=>a;function dJ(a,b=dI,c){let d=dH(a.subscribe,a.getState,a.getServerState||a.getInitialState,b,c);return dG(d),d}let dK=(a,b)=>{let c=a?dF(a):dF,d=(a,d=b)=>dJ(c,a,d);return Object.assign(d,c),d};function dL(a,b){if(Object.is(a,b))return!0;if("object"!=typeof a||null===a||"object"!=typeof b||null===b)return!1;if(a instanceof Map&&b instanceof Map){if(a.size!==b.size)return!1;for(let[c,d]of a)if(!Object.is(d,b.get(c)))return!1;return!0}if(a instanceof Set&&b instanceof Set){if(a.size!==b.size)return!1;for(let c of a)if(!b.has(c))return!1;return!0}let c=Object.keys(a);if(c.length!==Object.keys(b).length)return!1;for(let d of c)if(!Object.prototype.hasOwnProperty.call(b,d)||!Object.is(a[d],b[d]))return!1;return!0}a.i(35112);let dM=(0,t.createContext)(null),dN=dM.Provider,dO="[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001";function dP(a,b){let c=(0,t.useContext)(dM);if(null===c)throw Error(dO);return dJ(c,a,b)}function dQ(){let a=(0,t.useContext)(dM);if(null===a)throw Error(dO);return(0,t.useMemo)(()=>({getState:a.getState,setState:a.setState,subscribe:a.subscribe}),[a])}let dR={display:"none"},dS={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},dT="react-flow__node-desc",dU="react-flow__edge-desc",dV=a=>a.ariaLiveMessage,dW=a=>a.ariaLabelConfig;function dX({rfId:a}){let b=dP(dV);return(0,s.jsx)("div",{id:`react-flow__aria-live-${a}`,"aria-live":"assertive","aria-atomic":"true",style:dS,children:b})}function dY({rfId:a,disableKeyboardA11y:b}){let c=dP(dW);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{id:`${dT}-${a}`,style:dR,children:b?c["node.a11yDescription.default"]:c["node.a11yDescription.keyboardDisabled"]}),(0,s.jsx)("div",{id:`${dU}-${a}`,style:dR,children:c["edge.a11yDescription.default"]}),!b&&(0,s.jsx)(dX,{rfId:a})]})}let dZ=(0,t.forwardRef)(({position:a="top-left",children:b,className:c,style:d,...e},f)=>{let g=`${a}`.split("-");return(0,s.jsx)("div",{className:v(["react-flow__panel",c,...g]),style:d,ref:f,...e,children:b})});function d$({proOptions:a,position:b="bottom-right"}){return a?.hideAttribution?null:(0,s.jsx)(dZ,{position:b,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,s.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}dZ.displayName="Panel";let d_=a=>{let b=[],c=[];for(let[,c]of a.nodeLookup)c.selected&&b.push(c.internals.userNode);for(let[,b]of a.edgeLookup)b.selected&&c.push(b);return{selectedNodes:b,selectedEdges:c}},d0=a=>a.id;function d1(a,b){return dL(a.selectedNodes.map(d0),b.selectedNodes.map(d0))&&dL(a.selectedEdges.map(d0),b.selectedEdges.map(d0))}function d2({onSelectionChange:a}){let b=dQ(),{selectedNodes:c,selectedEdges:d}=dP(d_,d1);return(0,t.useEffect)(()=>{let e={nodes:c,edges:d};a?.(e),b.getState().onSelectionChangeHandlers.forEach(a=>a(e))},[c,d,a]),null}let d3=a=>!!a.onSelectionChangeHandlers;function d4({onSelectionChange:a}){let b=dP(d3);return a||b?(0,s.jsx)(d2,{onSelectionChange:a}):null}let d5=[0,0],d6={x:0,y:0,zoom:1},d7=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode","rfId"],d8=a=>({setNodes:a.setNodes,setEdges:a.setEdges,setMinZoom:a.setMinZoom,setMaxZoom:a.setMaxZoom,setTranslateExtent:a.setTranslateExtent,setNodeExtent:a.setNodeExtent,reset:a.reset,setDefaultNodesAndEdges:a.setDefaultNodesAndEdges}),d9={translateExtent:b7,nodeOrigin:d5,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function ea(a){let{setNodes:b,setEdges:c,setMinZoom:d,setMaxZoom:e,setTranslateExtent:f,setNodeExtent:g,reset:h,setDefaultNodesAndEdges:i}=dP(d8,dL),j=dQ();(0,t.useEffect)(()=>(i(a.defaultNodes,a.defaultEdges),()=>{k.current=d9,h()}),[]);let k=(0,t.useRef)(d9);return(0,t.useEffect)(()=>{for(let h of d7){let i=a[h];if(i!==k.current[h]&&void 0!==a[h])if("nodes"===h)b(i);else if("edges"===h)c(i);else if("minZoom"===h)d(i);else if("maxZoom"===h)e(i);else if("translateExtent"===h)f(i);else if("nodeExtent"===h)g(i);else if("ariaLabelConfig"===h)j.setState({ariaLabelConfig:{...b9,...i||{}}});else"fitView"===h?j.setState({fitViewQueued:i}):"fitViewOptions"===h?j.setState({fitViewOptions:i}):j.setState({[h]:i})}k.current=a},d7.map(b=>a[b])),null}let eb="undefined"!=typeof document?document:null;function ec(a=null,b={target:eb,actInsideInputWithModifier:!0}){let[c,d]=(0,t.useState)(!1),e=(0,t.useRef)(!1),f=(0,t.useRef)(new Set([])),[g,h]=(0,t.useMemo)(()=>{if(null!==a){let b=(Array.isArray(a)?a:[a]).filter(a=>"string"==typeof a).map(a=>a.replace("+","\n").replace("\n\n","\n+").split("\n")),c=b.reduce((a,b)=>a.concat(...b),[]);return[b,c]}return[[],[]]},[a]);return(0,t.useEffect)(()=>{let c=b?.target??eb,i=b?.actInsideInputWithModifier??!0;if(null!==a){let a=a=>{if(e.current=a.ctrlKey||a.metaKey||a.shiftKey||a.altKey,(!e.current||e.current&&!i)&&cP(a))return!1;let c=ee(a.code,h);if(f.current.add(a[c]),ed(g,f.current,!1)){let c=a.composedPath?.()?.[0]||a.target,f=c?.nodeName==="BUTTON"||c?.nodeName==="A";!1!==b.preventDefault&&(e.current||!f)&&a.preventDefault(),d(!0)}},j=a=>{let b=ee(a.code,h);ed(g,f.current,!0)?(d(!1),f.current.clear()):f.current.delete(a[b]),"Meta"===a.key&&f.current.clear(),e.current=!1},k=()=>{f.current.clear(),d(!1)};return c?.addEventListener("keydown",a),c?.addEventListener("keyup",j),window.addEventListener("blur",k),window.addEventListener("contextmenu",k),()=>{c?.removeEventListener("keydown",a),c?.removeEventListener("keyup",j),window.removeEventListener("blur",k),window.removeEventListener("contextmenu",k)}}},[a,d]),c}function ed(a,b,c){return a.filter(a=>c||a.length===b.size).some(a=>a.every(a=>b.has(a)))}function ee(a,b){return b.includes(a)?"code":"key"}function ef(a,b){let c=[],d=new Map,e=[];for(let b of a)if("add"===b.type){e.push(b);continue}else if("remove"===b.type||"replace"===b.type)d.set(b.id,[b]);else{let a=d.get(b.id);a?a.push(b):d.set(b.id,[b])}for(let a of b){let b=d.get(a.id);if(!b){c.push(a);continue}if("remove"===b[0].type)continue;if("replace"===b[0].type){c.push({...b[0].item});continue}let e={...a};for(let a of b){var f=a,g=e;switch(f.type){case"select":g.selected=f.selected;break;case"position":void 0!==f.position&&(g.position=f.position),void 0!==f.dragging&&(g.dragging=f.dragging);break;case"dimensions":void 0!==f.dimensions&&(g.measured={...f.dimensions},f.setAttributes&&((!0===f.setAttributes||"width"===f.setAttributes)&&(g.width=f.dimensions.width),(!0===f.setAttributes||"height"===f.setAttributes)&&(g.height=f.dimensions.height))),"boolean"==typeof f.resizing&&(g.resizing=f.resizing)}}c.push(e)}return e.length&&e.forEach(a=>{void 0!==a.index?c.splice(a.index,0,{...a.item}):c.push({...a.item})}),c}function eg(a,b){return{id:a,type:"select",selected:b}}function eh(a,b=new Set,c=!1){let d=[];for(let[e,f]of a){let a=b.has(e);(void 0!==f.selected||a)&&f.selected!==a&&(c&&(f.selected=a),d.push(eg(f.id,a)))}return d}function ei({items:a=[],lookup:b}){let c=[],d=new Map(a.map(a=>[a.id,a]));for(let[d,e]of a.entries()){let a=b.get(e.id),f=a?.internals?.userNode??a;void 0!==f&&f!==e&&c.push({id:e.id,item:e,type:"replace"}),void 0===f&&c.push({item:e,type:"add",index:d})}for(let[a]of b)void 0===d.get(a)&&c.push({id:a,type:"remove"});return c}function ej(a){return{id:a.id,type:"remove"}}let ek=a=>"id"in a&&"position"in a&&!("source"in a)&&!("target"in a);function el(a){return(0,t.forwardRef)(a)}let em=t.useEffect;function en(a){let[b,c]=(0,t.useState)(BigInt(0)),[d]=(0,t.useState)(()=>{var a;let b;return a=()=>c(a=>a+BigInt(1)),b=[],{get:()=>b,reset:()=>{b=[]},push:c=>{b.push(c),a()}}});return em(()=>{let b=d.get();b.length&&(a(b),d.reset())},[b]),d}let eo=(0,t.createContext)(null);function ep({children:a}){let b=dQ(),c=en((0,t.useCallback)(a=>{let{nodes:c=[],setNodes:d,hasDefaultNodes:e,onNodesChange:f,nodeLookup:g,fitViewQueued:h,onNodesChangeMiddlewareMap:i}=b.getState(),j=c;for(let b of a)j="function"==typeof b?b(j):b;let k=ei({items:j,lookup:g});for(let a of i.values())k=a(k);e&&d(j),k.length>0?f?.(k):h&&window.requestAnimationFrame(()=>{let{fitViewQueued:a,nodes:c,setNodes:d}=b.getState();a&&d(c)})},[])),d=en((0,t.useCallback)(a=>{let{edges:c=[],setEdges:d,hasDefaultEdges:e,onEdgesChange:f,edgeLookup:g}=b.getState(),h=c;for(let b of a)h="function"==typeof b?b(h):b;e?d(h):f&&f(ei({items:h,lookup:g}))},[])),e=(0,t.useMemo)(()=>({nodeQueue:c,edgeQueue:d}),[]);return(0,s.jsx)(eo.Provider,{value:e,children:a})}let eq=a=>!!a.panZoom;function er(){let a,b=(a=dQ(),(0,t.useMemo)(()=>({zoomIn:b=>{let{panZoom:c}=a.getState();return c?c.scaleBy(1.2,{duration:b?.duration}):Promise.resolve(!1)},zoomOut:b=>{let{panZoom:c}=a.getState();return c?c.scaleBy(1/1.2,{duration:b?.duration}):Promise.resolve(!1)},zoomTo:(b,c)=>{let{panZoom:d}=a.getState();return d?d.scaleTo(b,{duration:c?.duration}):Promise.resolve(!1)},getZoom:()=>a.getState().transform[2],setViewport:async(b,c)=>{let{transform:[d,e,f],panZoom:g}=a.getState();return g?(await g.setViewport({x:b.x??d,y:b.y??e,zoom:b.zoom??f},c),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[b,c,d]=a.getState().transform;return{x:b,y:c,zoom:d}},setCenter:async(b,c,d)=>a.getState().setCenter(b,c,d),fitBounds:async(b,c)=>{let{width:d,height:e,minZoom:f,maxZoom:g,panZoom:h}=a.getState(),i=cE(b,d,e,f,g,c?.padding??.1);return h?(await h.setViewport(i,{duration:c?.duration,ease:c?.ease,interpolate:c?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(b,c={})=>{let{transform:d,snapGrid:e,snapToGrid:f,domNode:g}=a.getState();if(!g)return b;let{x:h,y:i}=g.getBoundingClientRect(),j={x:b.x-h,y:b.y-i},k=c.snapGrid??e;return cB(j,d,c.snapToGrid??f,k)},flowToScreenPosition:b=>{let{transform:c,domNode:d}=a.getState();if(!d)return b;let{x:e,y:f}=d.getBoundingClientRect(),g=cC(b,c);return{x:g.x+e,y:g.y+f}}}),[])),c=dQ(),d=function(){let a=(0,t.useContext)(eo);if(!a)throw Error("useBatchContext must be used within a BatchProvider");return a}(),e=dP(eq),f=(0,t.useMemo)(()=>{let a=a=>c.getState().nodeLookup.get(a),b=a=>{d.nodeQueue.push(a)},e=a=>{d.edgeQueue.push(a)},f=a=>{let{nodeLookup:b,nodeOrigin:d}=c.getState(),e=ek(a)?a:b.get(a.id),f=e.parentId?cJ(e.position,e.measured,e.parentId,b,d):e.position;return ct({...e,position:f,width:e.measured?.width??e.width,height:e.measured?.height??e.height})},g=(a,c,d={replace:!1})=>{b(b=>b.map(b=>{if(b.id===a){let a="function"==typeof c?c(b):c;return d.replace&&ek(a)?a:{...b,...a}}return b}))},h=(a,b,c={replace:!1})=>{e(d=>d.map(d=>{if(d.id===a){let a="function"==typeof b?b(d):b;return c.replace&&cd(a)?a:{...d,...a}}return d}))};return{getNodes:()=>c.getState().nodes.map(a=>({...a})),getNode:b=>a(b)?.internals.userNode,getInternalNode:a,getEdges:()=>{let{edges:a=[]}=c.getState();return a.map(a=>({...a}))},getEdge:a=>c.getState().edgeLookup.get(a),setNodes:b,setEdges:e,addNodes:a=>{let b=Array.isArray(a)?a:[a];d.nodeQueue.push(a=>[...a,...b])},addEdges:a=>{let b=Array.isArray(a)?a:[a];d.edgeQueue.push(a=>[...a,...b])},toObject:()=>{let{nodes:a=[],edges:b=[],transform:d}=c.getState(),[e,f,g]=d;return{nodes:a.map(a=>({...a})),edges:b.map(a=>({...a})),viewport:{x:e,y:f,zoom:g}}},deleteElements:async({nodes:a=[],edges:b=[]})=>{let{nodes:d,edges:e,onNodesDelete:f,onEdgesDelete:g,triggerNodeChanges:h,triggerEdgeChanges:i,onDelete:j,onBeforeDelete:k}=c.getState(),{nodes:l,edges:m}=await ck({nodesToRemove:a,edgesToRemove:b,nodes:d,edges:e,onBeforeDelete:k}),n=m.length>0,o=l.length>0;if(n){let a=m.map(ej);g?.(m),i(a)}if(o){let a=l.map(ej);f?.(l),h(a)}return(o||n)&&j?.({nodes:l,edges:m}),{deletedNodes:l,deletedEdges:m}},getIntersectingNodes:(a,b=!0,d)=>{let e=cx(a),g=e?a:f(a),h=void 0!==d;return g?(d||c.getState().nodes).filter(d=>{let f=c.getState().nodeLookup.get(d.id);if(f&&!e&&(d.id===a.id||!f.internals.positionAbsolute))return!1;let i=ct(h?d:f),j=cw(i,g);return b&&j>0||j>=i.width*i.height||j>=g.width*g.height}):[]},isNodeIntersecting:(a,b,c=!0)=>{let d=cx(a)?a:f(a);if(!d)return!1;let e=cw(d,b);return c&&e>0||e>=b.width*b.height||e>=d.width*d.height},updateNode:g,updateNodeData:(a,b,c={replace:!1})=>{g(a,a=>{let d="function"==typeof b?b(a):b;return c.replace?{...a,data:d}:{...a,data:{...a.data,...d}}},c)},updateEdge:h,updateEdgeData:(a,b,c={replace:!1})=>{h(a,a=>{let d="function"==typeof b?b(a):b;return c.replace?{...a,data:d}:{...a,data:{...a.data,...d}}},c)},getNodesBounds:a=>{let{nodeLookup:b,nodeOrigin:d}=c.getState();return((a,b={nodeOrigin:[0,0]})=>0===a.length?{x:0,y:0,width:0,height:0}:cs(a.reduce((a,c)=>{let d="string"==typeof c,e=b.nodeLookup||d?void 0:c;return b.nodeLookup&&(e=d?b.nodeLookup.get(c):ce(c)?c:b.nodeLookup.get(c.id)),cq(a,e?cu(e,b.nodeOrigin):{x:0,y:0,x2:0,y2:0})},{x:1/0,y:1/0,x2:-1/0,y2:-1/0})))(a,{nodeLookup:b,nodeOrigin:d})},getHandleConnections:({type:a,id:b,nodeId:d})=>Array.from(c.getState().connectionLookup.get(`${d}-${a}${b?`-${b}`:""}`)?.values()??[]),getNodeConnections:({type:a,handleId:b,nodeId:d})=>Array.from(c.getState().connectionLookup.get(`${d}${a?b?`-${a}-${b}`:`-${a}`:""}`)?.values()??[]),fitView:async a=>{let b,e,f=c.getState().fitViewResolver??{promise:new Promise((a,c)=>{b=a,e=c}),resolve:b,reject:e};return c.setState({fitViewQueued:!0,fitViewOptions:a,fitViewResolver:f}),d.nodeQueue.push(a=>[...a]),f.promise}}},[]);return(0,t.useMemo)(()=>({...f,...b,viewportInitialized:e}),[e])}let es=a=>a.selected,et,eu={position:"absolute",width:"100%",height:"100%",top:0,left:0},ev=a=>({userSelectionActive:a.userSelectionActive,lib:a.lib,connectionInProgress:a.connection.inProgress});function ew({onPaneContextMenu:a,zoomOnScroll:b=!0,zoomOnPinch:c=!0,panOnScroll:d=!1,panOnScrollSpeed:e=.5,panOnScrollMode:f=l.Free,zoomOnDoubleClick:g=!0,panOnDrag:h=!0,defaultViewport:i,translateExtent:j,minZoom:k,maxZoom:m,zoomActivationKeyCode:n,preventScrolling:o=!0,children:p,noWheelClassName:q,noPanClassName:r,onViewportChange:u,isControlledViewport:v,paneClickDistance:w,selectionOnDrag:x}){let y,z=dQ(),A=(0,t.useRef)(null),{userSelectionActive:B,lib:C,connectionInProgress:D}=dP(ev,dL),E=ec(n),F=(0,t.useRef)();y=dQ(),(0,t.useEffect)(()=>{let a=()=>{if(!A.current||!(A.current.checkVisibility?.()??!0))return!1;let a=cM(A.current);(0===a.height||0===a.width)&&y.getState().onError?.("004","The React Flow parent container needs a width and a height to render the graph."),y.setState({width:a.width||500,height:a.height||500})};if(A.current){a(),window.addEventListener("resize",a);let b=new ResizeObserver(()=>a());return b.observe(A.current),()=>{window.removeEventListener("resize",a),b&&A.current&&b.unobserve(A.current)}}},[]);let G=(0,t.useCallback)(a=>{u?.({x:a[0],y:a[1],zoom:a[2]}),v||z.setState({transform:a})},[u,v]);return(0,t.useEffect)(()=>{if(A.current){F.current=function({domNode:a,minZoom:b,maxZoom:c,translateExtent:d,viewport:e,onPanZoom:f,onPanZoomStart:g,onPanZoomEnd:h,onDraggingChange:i}){let j={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},k=a.getBoundingClientRect(),m=b5().scaleExtent([b,c]).translateExtent(d),n=an(a).call(m);s({x:e.x,y:e.y,zoom:cl(e.zoom,b,c)},[[0,0],[k.width,k.height]],d);let o=n.on("wheel.zoom"),p=n.on("dblclick.zoom");function q(a,b){return n?new Promise(c=>{m?.interpolate(b?.interpolate==="linear"?b6:aD).transform(dv(n,b?.duration,b?.ease,()=>c(!0)),a)}):Promise.resolve(!1)}function r(){m.on("zoom",null)}async function s(a,b,c){let d=dr(a),e=m?.constrain()(d,b,c);return e&&await q(e),new Promise(a=>a(e))}return m.wheelDelta(dw),{update:function({noWheelClassName:a,noPanClassName:b,onPaneContextMenu:c,userSelectionActive:d,panOnScroll:e,panOnDrag:k,panOnScrollMode:q,panOnScrollSpeed:s,preventScrolling:t,zoomOnPinch:u,zoomOnScroll:v,zoomOnDoubleClick:w,zoomActivationKeyPressed:x,lib:y,onTransformChange:z,connectionInProgress:A,paneClickDistance:B,selectionOnDrag:C}){d&&!j.isZoomingOrPanning&&r();let D=e&&!x&&!d;m.clickDistance(C?1/0:!cy(B)||B<0?0:B);let E=D?function({zoomPanValues:a,noWheelClassName:b,d3Selection:c,d3Zoom:d,panOnScrollMode:e,panOnScrollSpeed:f,zoomOnPinch:g,onPanZoomStart:h,onPanZoom:i,onPanZoomEnd:j}){return k=>{if(ds(k,b))return k.ctrlKey&&k.preventDefault(),!1;k.preventDefault(),k.stopImmediatePropagation();let m=c.property("__zoom").k||1;if(k.ctrlKey&&g){let a=ao(k),b=m*Math.pow(2,dw(k));d.scaleTo(c,b,a,k);return}let n=1===k.deltaMode?20:1,o=e===l.Vertical?0:k.deltaX*n,p=e===l.Horizontal?0:k.deltaY*n;!cF()&&k.shiftKey&&e!==l.Vertical&&(o=k.deltaY*n,p=0),d.translateBy(c,-(o/m)*f,-(p/m)*f,{internal:!0});let q=dq(c.property("__zoom"));clearTimeout(a.panScrollTimeout),a.isPanScrolling?(i?.(k,q),a.panScrollTimeout=setTimeout(()=>{j?.(k,q),a.isPanScrolling=!1},150)):(a.isPanScrolling=!0,h?.(k,q))}}({zoomPanValues:j,noWheelClassName:a,d3Selection:n,d3Zoom:m,panOnScrollMode:q,panOnScrollSpeed:s,zoomOnPinch:u,onPanZoomStart:g,onPanZoom:f,onPanZoomEnd:h}):function({noWheelClassName:a,preventScrolling:b,d3ZoomHandler:c}){return function(d,e){let f="wheel"===d.type,g=!b&&f&&!d.ctrlKey,h=ds(d,a);if(d.ctrlKey&&f&&h&&d.preventDefault(),g||h)return null;d.preventDefault(),c.call(this,d,e)}}({noWheelClassName:a,preventScrolling:t,d3ZoomHandler:o});if(n.on("wheel.zoom",E,{passive:!1}),!d){let a=function({zoomPanValues:a,onDraggingChange:b,onPanZoomStart:c}){return d=>{if(d.sourceEvent?.internal)return;let e=dq(d.transform);a.mouseButton=d.sourceEvent?.button||0,a.isZoomingOrPanning=!0,a.prevViewport=e,d.sourceEvent?.type==="mousedown"&&b(!0),c&&c?.(d.sourceEvent,e)}}({zoomPanValues:j,onDraggingChange:i,onPanZoomStart:g});m.on("start",a);let b=function({zoomPanValues:a,panOnDrag:b,onPaneContextMenu:c,onTransformChange:d,onPanZoom:e}){return f=>{a.usedRightMouseButton=!!(c&&dt(b,a.mouseButton??0)),f.sourceEvent?.sync||d([f.transform.x,f.transform.y,f.transform.k]),e&&!f.sourceEvent?.internal&&e?.(f.sourceEvent,dq(f.transform))}}({zoomPanValues:j,panOnDrag:k,onPaneContextMenu:!!c,onPanZoom:f,onTransformChange:z});m.on("zoom",b);let d=function({zoomPanValues:a,panOnDrag:b,panOnScroll:c,onDraggingChange:d,onPanZoomEnd:e,onPaneContextMenu:f}){return g=>{if(!g.sourceEvent?.internal&&(a.isZoomingOrPanning=!1,f&&dt(b,a.mouseButton??0)&&!a.usedRightMouseButton&&g.sourceEvent&&f(g.sourceEvent),a.usedRightMouseButton=!1,d(!1),e)){let b=dq(g.transform);a.prevViewport=b,clearTimeout(a.timerId),a.timerId=setTimeout(()=>{e?.(g.sourceEvent,b)},150*!!c)}}}({zoomPanValues:j,panOnDrag:k,panOnScroll:e,onPaneContextMenu:c,onPanZoomEnd:h,onDraggingChange:i});m.on("end",d)}let F=function({zoomActivationKeyPressed:a,zoomOnScroll:b,zoomOnPinch:c,panOnDrag:d,panOnScroll:e,zoomOnDoubleClick:f,userSelectionActive:g,noWheelClassName:h,noPanClassName:i,lib:j,connectionInProgress:k}){return l=>{let m=a||b,n=c&&l.ctrlKey,o="wheel"===l.type;if(1===l.button&&"mousedown"===l.type&&(ds(l,`${j}-flow__node`)||ds(l,`${j}-flow__edge`)))return!0;if(!d&&!m&&!e&&!f&&!c||g||k&&!o||ds(l,h)&&o||ds(l,i)&&(!o||e&&o&&!a)||!c&&l.ctrlKey&&o)return!1;if(!c&&"touchstart"===l.type&&l.touches?.length>1)return l.preventDefault(),!1;if(!m&&!e&&!n&&o||!d&&("mousedown"===l.type||"touchstart"===l.type)||Array.isArray(d)&&!d.includes(l.button)&&"mousedown"===l.type)return!1;let p=Array.isArray(d)&&d.includes(l.button)||!l.button||l.button<=1;return(!l.ctrlKey||o)&&p}}({zoomActivationKeyPressed:x,panOnDrag:k,zoomOnScroll:v,panOnScroll:e,zoomOnDoubleClick:w,zoomOnPinch:u,userSelectionActive:d,noPanClassName:b,noWheelClassName:a,lib:y,connectionInProgress:A});m.filter(F),w?n.on("dblclick.zoom",p):n.on("dblclick.zoom",null)},destroy:r,setViewport:async function a(a,b){let c=dr(a);return await q(c,b),new Promise(a=>a(c))},setViewportConstrained:s,getViewport:function(){let a=n?bY(n.node()):{x:0,y:0,k:1};return{x:a.x,y:a.y,zoom:a.k}},scaleTo:function(a,b){return n?new Promise(c=>{m?.interpolate(b?.interpolate==="linear"?b6:aD).scaleTo(dv(n,b?.duration,b?.ease,()=>c(!0)),a)}):Promise.resolve(!1)},scaleBy:function(a,b){return n?new Promise(c=>{m?.interpolate(b?.interpolate==="linear"?b6:aD).scaleBy(dv(n,b?.duration,b?.ease,()=>c(!0)),a)}):Promise.resolve(!1)},setScaleExtent:function(a){m?.scaleExtent(a)},setTranslateExtent:function(a){m?.translateExtent(a)},syncViewport:function(a){if(n){let b=dr(a),c=n.property("__zoom");(c.k!==a.zoom||c.x!==a.x||c.y!==a.y)&&m?.transform(n,b,null,{sync:!0})}},setClickDistance:function(a){let b=!cy(a)||a<0?0:a;m?.clickDistance(b)}}}({domNode:A.current,minZoom:k,maxZoom:m,translateExtent:j,viewport:i,onDraggingChange:a=>z.setState({paneDragging:a}),onPanZoomStart:(a,b)=>{let{onViewportChangeStart:c,onMoveStart:d}=z.getState();d?.(a,b),c?.(b)},onPanZoom:(a,b)=>{let{onViewportChange:c,onMove:d}=z.getState();d?.(a,b),c?.(b)},onPanZoomEnd:(a,b)=>{let{onViewportChangeEnd:c,onMoveEnd:d}=z.getState();d?.(a,b),c?.(b)}});let{x:a,y:b,zoom:c}=F.current.getViewport();return z.setState({panZoom:F.current,transform:[a,b,c],domNode:A.current.closest(".react-flow")}),()=>{F.current?.destroy()}}},[]),(0,t.useEffect)(()=>{F.current?.update({onPaneContextMenu:a,zoomOnScroll:b,zoomOnPinch:c,panOnScroll:d,panOnScrollSpeed:e,panOnScrollMode:f,zoomOnDoubleClick:g,panOnDrag:h,zoomActivationKeyPressed:E,preventScrolling:o,noPanClassName:r,userSelectionActive:B,noWheelClassName:q,lib:C,onTransformChange:G,connectionInProgress:D,selectionOnDrag:x,paneClickDistance:w})},[a,b,c,d,e,f,g,h,E,o,r,B,q,C,G,D,x,w]),(0,s.jsx)("div",{className:"react-flow__renderer",ref:A,style:eu,children:p})}let ex=a=>({userSelectionActive:a.userSelectionActive,userSelectionRect:a.userSelectionRect});function ey(){let{userSelectionActive:a,userSelectionRect:b}=dP(ex,dL);return a&&b?(0,s.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:b.width,height:b.height,transform:`translate(${b.x}px, ${b.y}px)`}}):null}let ez=(a,b)=>c=>{c.target===b.current&&a?.(c)},eA=a=>({userSelectionActive:a.userSelectionActive,elementsSelectable:a.elementsSelectable,connectionInProgress:a.connection.inProgress,dragging:a.paneDragging});function eB({isSelecting:a,selectionKeyPressed:b,selectionMode:c=m.Full,panOnDrag:d,paneClickDistance:e,selectionOnDrag:f,onSelectionStart:g,onSelectionEnd:h,onPaneClick:i,onPaneContextMenu:j,onPaneScroll:k,onPaneMouseEnter:l,onPaneMouseMove:n,onPaneMouseLeave:o,children:p}){let q=dQ(),{userSelectionActive:r,elementsSelectable:u,dragging:w,connectionInProgress:x}=dP(eA,dL),y=u&&(a||r),z=(0,t.useRef)(null),A=(0,t.useRef)(),B=(0,t.useRef)(new Set),C=(0,t.useRef)(new Set),D=(0,t.useRef)(!1),E=a=>{if(D.current||x){D.current=!1;return}i?.(a),q.getState().resetSelectedElements(),q.setState({nodesSelectionActive:!1})},F=!0===d||Array.isArray(d)&&d.includes(0);return(0,s.jsxs)("div",{className:v(["react-flow__pane",{draggable:F,dragging:w,selection:a}]),onClick:y?void 0:ez(E,z),onContextMenu:ez(a=>{Array.isArray(d)&&d?.includes(2)?a.preventDefault():j?.(a)},z),onWheel:ez(k?a=>k(a):void 0,z),onPointerEnter:y?void 0:l,onPointerMove:y?a=>{let{userSelectionRect:d,transform:f,nodeLookup:h,edgeLookup:i,connectionLookup:j,triggerNodeChanges:k,triggerEdgeChanges:l,defaultEdgeOptions:n,resetSelectedElements:o}=q.getState();if(!A.current||!d)return;let{x:p,y:r}=cQ(a.nativeEvent,A.current),{startX:s,startY:t}=d;if(!D.current){if(Math.hypot(p-s,r-t)<=(b?0:e))return;o(),g?.(a)}D.current=!0;let u={startX:s,startY:t,x:p<s?p:s,y:r<t?r:t,width:Math.abs(p-s),height:Math.abs(r-t)},v=B.current,w=C.current;B.current=new Set(ch(h,u,f,c===m.Partial,!0).map(a=>a.id)),C.current=new Set;let x=n?.selectable??!0;for(let a of B.current){let b=j.get(a);if(b)for(let{edgeId:a}of b.values()){let b=i.get(a);b&&(b.selectable??x)&&C.current.add(a)}}cK(v,B.current)||k(eh(h,B.current,!0)),cK(w,C.current)||l(eh(i,C.current)),q.setState({userSelectionRect:u,userSelectionActive:!0,nodesSelectionActive:!1})}:n,onPointerUp:y?a=>{0===a.button&&(a.target?.releasePointerCapture?.(a.pointerId),!r&&a.target===z.current&&q.getState().userSelectionRect&&E?.(a),q.setState({userSelectionActive:!1,userSelectionRect:null}),D.current&&(h?.(a),q.setState({nodesSelectionActive:B.current.size>0})))}:void 0,onPointerDownCapture:y?c=>{let{domNode:d}=q.getState();if(A.current=d?.getBoundingClientRect(),!A.current)return;let e=c.target===z.current;if(!e&&c.target.closest(".nokey")||!a||!(f&&e||b)||0!==c.button||!c.isPrimary)return;c.target?.setPointerCapture?.(c.pointerId),D.current=!1;let{x:g,y:h}=cQ(c.nativeEvent,A.current);q.setState({userSelectionRect:{width:0,height:0,startX:g,startY:h,x:g,y:h}}),e||(c.stopPropagation(),c.preventDefault())}:void 0,onClickCapture:y?a=>{D.current&&(a.stopPropagation(),D.current=!1)}:void 0,onPointerLeave:o,ref:z,style:eu,children:[p,(0,s.jsx)(ey,{})]})}function eC({id:a,store:b,unselect:c=!1,nodeRef:d}){let e,{addSelectedNodes:f,unselectNodesAndEdges:g,multiSelectionActive:h,nodeLookup:i,onError:j}=b.getState(),k=i.get(a);k?(b.setState({nodesSelectionActive:!1}),k.selected?(c||k.selected&&h)&&(g({nodes:[k],edges:[]}),requestAnimationFrame(()=>d?.current?.blur())):f([a])):j?.("012",(e=a,`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`))}function eD({nodeRef:a,disabled:b=!1,noDragClassName:c,handleSelector:d,nodeId:e,isSelectable:f,nodeClickDistance:g}){let h=dQ(),[i,j]=(0,t.useState)(!1),k=(0,t.useRef)();return(0,t.useEffect)(()=>{k.current=function({onNodeMouseDown:a,getStoreItems:b,onDragStart:c,onDrag:d,onDragStop:e}){let f={x:null,y:null},g=0,h=new Map,i=!1,j={x:0,y:0},k=null,l=!1,m=null,n=!1,o=!1,p=null;return{update:function({noDragClassName:q,handleSelector:r,domNode:s,isSelectable:t,nodeId:u,nodeClickDistance:v=0}){function w({x:a,y:c}){let{nodeLookup:e,nodeExtent:g,snapGrid:i,snapToGrid:j,nodeOrigin:k,onNodeDrag:l,onSelectionDrag:m,onError:n,updateNodePositions:q}=b();f={x:a,y:c};let r=!1,s=h.size>1,t=s&&g?cr(cg(h)):null,v=s&&j?function({dragItems:a,snapGrid:b,x:c,y:d}){let e=a.values().next().value;if(!e)return null;let f={x:c-e.distance.x,y:d-e.distance.y},g=cA(f,b);return{x:g.x-f.x,y:g.y-f.y}}({dragItems:h,snapGrid:i,x:a,y:c}):null;for(let[b,d]of h){if(!e.has(b))continue;let f={x:a-d.distance.x,y:c-d.distance.y};j&&(f=v?{x:Math.round(f.x+v.x),y:Math.round(f.y+v.y)}:cA(f,i));let h=null;if(s&&g&&!d.extent&&t){let{positionAbsolute:a}=d.internals,b=a.x-t.x+g[0][0],c=a.x+d.measured.width-t.x2+g[1][0];h=[[b,a.y-t.y+g[0][1]],[c,a.y+d.measured.height-t.y2+g[1][1]]]}let{position:l,positionAbsolute:m}=cj({nodeId:b,nextPosition:f,nodeLookup:e,nodeExtent:h||g,nodeOrigin:k,onError:n});r=r||d.position.x!==l.x||d.position.y!==l.y,d.position=l,d.internals.positionAbsolute=m}if(o=o||r,r&&(q(h,!0),p&&(d||l||!u&&m))){let[a,b]=dj({nodeId:u,dragItems:h,nodeLookup:e});d?.(p,h,a,b),l?.(p,a,b),u||m?.(p,b)}}async function x(){if(!k)return;let{transform:a,panBy:c,autoPanSpeed:d,autoPanOnNodeDrag:e}=b();if(!e){i=!1,cancelAnimationFrame(g);return}let[h,l]=cp(j,k,d);(0!==h||0!==l)&&(f.x=(f.x??0)-h/a[2],f.y=(f.y??0)-l/a[2],await c({x:h,y:l})&&w(f)),g=requestAnimationFrame(x)}function y(d){let{nodeLookup:e,multiSelectionActive:g,nodesDraggable:i,transform:j,snapGrid:m,snapToGrid:n,selectNodesOnDrag:o,onNodeDragStart:p,onSelectionDragStart:q,unselectNodesAndEdges:r}=b();l=!0,o&&t||g||!u||e.get(u)?.selected||r(),t&&o&&u&&a?.(u);let s=cL(d.sourceEvent,{transform:j,snapGrid:m,snapToGrid:n,containerBounds:k});if(f=s,(h=function(a,b,c,d){let e=new Map;for(let[f,g]of a)if((g.selected||g.id===d)&&(!g.parentId||!function a(b,c){if(!b.parentId)return!1;let d=c.get(b.parentId);return!!d&&(!!d.selected||a(d,c))}(g,a))&&(g.draggable||b&&void 0===g.draggable)){let b=a.get(f);b&&e.set(f,{id:f,position:b.position||{x:0,y:0},distance:{x:c.x-b.internals.positionAbsolute.x,y:c.y-b.internals.positionAbsolute.y},extent:b.extent,parentId:b.parentId,origin:b.origin,expandParent:b.expandParent,internals:{positionAbsolute:b.internals.positionAbsolute||{x:0,y:0}},measured:{width:b.measured.width??0,height:b.measured.height??0}})}return e}(e,i,s,u)).size>0&&(c||p||!u&&q)){let[a,b]=dj({nodeId:u,dragItems:h,nodeLookup:e});c?.(d.sourceEvent,h,a,b),p?.(d.sourceEvent,a,b),u||q?.(d.sourceEvent,b)}}m=an(s);let z=aB().clickDistance(v).on("start",a=>{let{domNode:c,nodeDragThreshold:d,transform:e,snapGrid:g,snapToGrid:h}=b();k=c?.getBoundingClientRect()||null,n=!1,o=!1,p=a.sourceEvent,0===d&&y(a),f=cL(a.sourceEvent,{transform:e,snapGrid:g,snapToGrid:h,containerBounds:k}),j=cQ(a.sourceEvent,k)}).on("drag",a=>{let{autoPanOnNodeDrag:c,transform:d,snapGrid:e,snapToGrid:g,nodeDragThreshold:m,nodeLookup:o}=b(),q=cL(a.sourceEvent,{transform:d,snapGrid:e,snapToGrid:g,containerBounds:k});if(p=a.sourceEvent,("touchmove"===a.sourceEvent.type&&a.sourceEvent.touches.length>1||u&&!o.has(u))&&(n=!0),!n){if(!i&&c&&l&&(i=!0,x()),!l){let b=cQ(a.sourceEvent,k),c=b.x-j.x,d=b.y-j.y;Math.sqrt(c*c+d*d)>m&&y(a)}(f.x!==q.xSnapped||f.y!==q.ySnapped)&&h&&l&&(j=cQ(a.sourceEvent,k),w(q))}}).on("end",a=>{if(l&&!n&&(i=!1,l=!1,cancelAnimationFrame(g),h.size>0)){let{nodeLookup:c,updateNodePositions:d,onNodeDragStop:f,onSelectionDragStop:g}=b();if(o&&(d(h,!1),o=!1),e||f||!u&&g){let[b,d]=dj({nodeId:u,dragItems:h,nodeLookup:c,dragging:!1});e?.(a.sourceEvent,h,b,d),f?.(a.sourceEvent,b,d),u||g?.(a.sourceEvent,d)}}}).filter(a=>{let b=a.target;return!a.button&&(!q||!di(b,`.${q}`,s))&&(!r||di(b,r,s))});m.call(z)},destroy:function(){m?.on(".drag",null)}}}({getStoreItems:()=>h.getState(),onNodeMouseDown:b=>{eC({id:b,store:h,nodeRef:a})},onDragStart:()=>{j(!0)},onDragStop:()=>{j(!1)}})},[]),(0,t.useEffect)(()=>{if(b)k.current?.destroy();else if(a.current)return k.current?.update({noDragClassName:c,handleSelector:d,domNode:a.current,isSelectable:f,nodeId:e,nodeClickDistance:g}),()=>{k.current?.destroy()}},[c,d,b,f,a,e]),i}function eE(){let a=dQ();return(0,t.useCallback)(b=>{let{nodeExtent:c,snapToGrid:d,snapGrid:e,nodesDraggable:f,onError:g,updateNodePositions:h,nodeLookup:i,nodeOrigin:j}=a.getState(),k=new Map,l=a=>a.selected&&(a.draggable||f&&void 0===a.draggable),m=d?e[0]:5,n=d?e[1]:5,o=b.direction.x*m*b.factor,p=b.direction.y*n*b.factor;for(let[,a]of i){if(!l(a))continue;let b={x:a.internals.positionAbsolute.x+o,y:a.internals.positionAbsolute.y+p};d&&(b=cA(b,e));let{position:f,positionAbsolute:h}=cj({nodeId:a.id,nextPosition:b,nodeLookup:i,nodeExtent:c,nodeOrigin:j,onError:g});a.position=f,a.internals.positionAbsolute=h,k.set(a.id,a)}h(k)},[])}let eF=(0,t.createContext)(null),eG=eF.Provider;eF.Consumer;let eH=()=>(0,t.useContext)(eF),eI=a=>({connectOnClick:a.connectOnClick,noPanClassName:a.noPanClassName,rfId:a.rfId}),eJ=(0,t.memo)(el(function({type:a="source",position:b=p.Top,isValidConnection:c,isConnectable:d=!0,isConnectableStart:e=!0,isConnectableEnd:f=!0,id:g,onConnect:h,children:i,className:j,onMouseDown:l,onTouchStart:m,...n},o){let q=g||null,r="target"===a,t=dQ(),u=eH(),{connectOnClick:w,noPanClassName:x,rfId:y}=dP(eI,dL),{connectingFrom:z,connectingTo:A,clickConnecting:B,isPossibleEndHandle:C,connectionInProcess:D,clickConnectionInProcess:E,valid:F}=dP(b=>{let{connectionClickStartHandle:c,connectionMode:d,connection:e}=b,{fromHandle:f,toHandle:g,isValid:h}=e,i=g?.nodeId===u&&g?.id===q&&g?.type===a;return{connectingFrom:f?.nodeId===u&&f?.id===q&&f?.type===a,connectingTo:i,clickConnecting:c?.nodeId===u&&c?.id===q&&c?.type===a,isPossibleEndHandle:d===k.Strict?f?.type!==a:u!==f?.nodeId||q!==f?.id,connectionInProcess:!!f,clickConnectionInProcess:!!c,valid:i&&h}},dL);u||t.getState().onError?.("010","Handle: No node id found. Make sure to only use a Handle inside a custom Node.");let G=a=>{let{defaultEdgeOptions:b,onConnect:c,hasDefaultEdges:d}=t.getState(),e={...b,...a};if(d){let{edges:a,setEdges:b}=t.getState();b(cY(e,a))}c?.(e),h?.(e)},H=a=>{if(!u)return;let b="clientX"in a.nativeEvent;if(e&&(b&&0===a.button||!b)){let b=t.getState();dp(a.nativeEvent,{handleDomNode:a.currentTarget,autoPanOnConnect:b.autoPanOnConnect,connectionMode:b.connectionMode,connectionRadius:b.connectionRadius,domNode:b.domNode,nodeLookup:b.nodeLookup,lib:b.lib,isTarget:r,handleId:q,nodeId:u,flowId:b.rfId,panBy:b.panBy,cancelConnection:b.cancelConnection,onConnectStart:b.onConnectStart,onConnectEnd:b.onConnectEnd,updateConnection:b.updateConnection,onConnect:G,isValidConnection:c||b.isValidConnection,getTransform:()=>t.getState().transform,getFromHandle:()=>t.getState().connection.fromHandle,autoPanSpeed:b.autoPanSpeed,dragThreshold:b.connectionDragThreshold})}b?l?.(a):m?.(a)};return(0,s.jsx)("div",{"data-handleid":q,"data-nodeid":u,"data-handlepos":b,"data-id":`${y}-${u}-${q}-${a}`,className:v(["react-flow__handle",`react-flow__handle-${b}`,"nodrag",x,j,{source:!r,target:r,connectable:d,connectablestart:e,connectableend:f,clickconnecting:B,connectingfrom:z,connectingto:A,valid:F,connectionindicator:d&&(!D||C)&&(D||E?f:e)}]),onMouseDown:H,onTouchStart:H,onClick:w?b=>{let{onClickConnectStart:d,onClickConnectEnd:f,connectionClickStartHandle:g,connectionMode:h,isValidConnection:i,lib:j,rfId:k,nodeLookup:l,connection:m}=t.getState();if(!u||!g&&!e)return;if(!g){d?.(b.nativeEvent,{nodeId:u,handleId:q,handleType:a}),t.setState({connectionClickStartHandle:{nodeId:u,type:a,id:q}});return}let n=cN(b.target),o=c||i,{connection:p,isValid:r}=dn(b.nativeEvent,{handle:{nodeId:u,id:q,type:a},connectionMode:h,fromNodeId:g.nodeId,fromHandleId:g.id||null,fromType:g.type,isValidConnection:o,flowId:k,doc:n,lib:j,nodeLookup:l});r&&p&&G(p);let s=structuredClone(m);delete s.inProgress,s.toPosition=s.toHandle?s.toHandle.position:null,f?.(b,s),t.setState({connectionClickStartHandle:null})}:void 0,ref:o,...n,children:i})})),eK={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},eL={input:function({data:a,isConnectable:b,sourcePosition:c=p.Bottom}){return(0,s.jsxs)(s.Fragment,{children:[a?.label,(0,s.jsx)(eJ,{type:"source",position:c,isConnectable:b})]})},default:function({data:a,isConnectable:b,targetPosition:c=p.Top,sourcePosition:d=p.Bottom}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eJ,{type:"target",position:c,isConnectable:b}),a?.label,(0,s.jsx)(eJ,{type:"source",position:d,isConnectable:b})]})},output:function({data:a,isConnectable:b,targetPosition:c=p.Top}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eJ,{type:"target",position:c,isConnectable:b}),a?.label]})},group:function(){return null}},eM=a=>{let{width:b,height:c,x:d,y:e}=cg(a.nodeLookup,{filter:a=>!!a.selected});return{width:cy(b)?b:null,height:cy(c)?c:null,userSelectionActive:a.userSelectionActive,transformString:`translate(${a.transform[0]}px,${a.transform[1]}px) scale(${a.transform[2]}) translate(${d}px,${e}px)`}};function eN({onSelectionContextMenu:a,noPanClassName:b,disableKeyboardA11y:c}){let d=dQ(),{width:e,height:f,transformString:g,userSelectionActive:h}=dP(eM,dL),i=eE(),j=(0,t.useRef)(null);if((0,t.useEffect)(()=>{c||j.current?.focus({preventScroll:!0})},[c]),eD({nodeRef:j}),h||!e||!f)return null;let k=a?b=>{a(b,d.getState().nodes.filter(a=>a.selected))}:void 0;return(0,s.jsx)("div",{className:v(["react-flow__nodesselection","react-flow__container",b]),style:{transform:g},children:(0,s.jsx)("div",{ref:j,className:"react-flow__nodesselection-rect",onContextMenu:k,tabIndex:c?void 0:-1,onKeyDown:c?void 0:a=>{Object.prototype.hasOwnProperty.call(eK,a.key)&&(a.preventDefault(),i({direction:eK[a.key],factor:a.shiftKey?4:1}))},style:{width:e,height:f}})})}let eO,eP=a=>({nodesSelectionActive:a.nodesSelectionActive,userSelectionActive:a.userSelectionActive});function eQ({children:a,onPaneClick:b,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:e,onPaneContextMenu:f,onPaneScroll:g,paneClickDistance:h,deleteKeyCode:i,selectionKeyCode:j,selectionOnDrag:k,selectionMode:l,onSelectionStart:m,onSelectionEnd:n,multiSelectionKeyCode:o,panActivationKeyCode:p,zoomActivationKeyCode:q,elementsSelectable:r,zoomOnScroll:u,zoomOnPinch:v,panOnScroll:w,panOnScrollSpeed:x,panOnScrollMode:y,zoomOnDoubleClick:z,panOnDrag:A,defaultViewport:B,translateExtent:C,minZoom:D,maxZoom:E,preventScrolling:F,onSelectionContextMenu:G,noWheelClassName:H,noPanClassName:I,disableKeyboardA11y:J,onViewportChange:K,isControlledViewport:L}){let{nodesSelectionActive:M,userSelectionActive:N}=dP(eP,dL),O=ec(j,{target:eO}),P=ec(p,{target:eO}),Q=P||A,R=P||w,S=k&&!0!==Q,T=O||N||S;return!function({deleteKeyCode:a,multiSelectionKeyCode:b}){let c=dQ(),{deleteElements:d}=er(),e=ec(a,{actInsideInputWithModifier:!1}),f=ec(b,{target:et});(0,t.useEffect)(()=>{if(e){let{edges:a,nodes:b}=c.getState();d({nodes:b.filter(es),edges:a.filter(es)}),c.setState({nodesSelectionActive:!1})}},[e]),(0,t.useEffect)(()=>{c.setState({multiSelectionActive:f})},[f])}({deleteKeyCode:i,multiSelectionKeyCode:o}),(0,s.jsx)(ew,{onPaneContextMenu:f,elementsSelectable:r,zoomOnScroll:u,zoomOnPinch:v,panOnScroll:R,panOnScrollSpeed:x,panOnScrollMode:y,zoomOnDoubleClick:z,panOnDrag:!O&&Q,defaultViewport:B,translateExtent:C,minZoom:D,maxZoom:E,zoomActivationKeyCode:q,preventScrolling:F,noWheelClassName:H,noPanClassName:I,onViewportChange:K,isControlledViewport:L,paneClickDistance:h,selectionOnDrag:S,children:(0,s.jsxs)(eB,{onSelectionStart:m,onSelectionEnd:n,onPaneClick:b,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:e,onPaneContextMenu:f,onPaneScroll:g,panOnDrag:Q,isSelecting:!!T,selectionMode:l,selectionKeyPressed:O,paneClickDistance:h,selectionOnDrag:S,children:[a,M&&(0,s.jsx)(eN,{onSelectionContextMenu:G,noPanClassName:I,disableKeyboardA11y:J})]})})}eQ.displayName="FlowRenderer";let eR=(0,t.memo)(eQ),eS=a=>a.updateNodeInternals;var eT=(0,t.memo)(function({id:a,onClick:b,onMouseEnter:c,onMouseMove:d,onMouseLeave:e,onContextMenu:f,onDoubleClick:g,nodesDraggable:h,elementsSelectable:i,nodesConnectable:j,nodesFocusable:k,resizeObserver:l,noDragClassName:m,noPanClassName:n,disableKeyboardA11y:o,rfId:p,nodeTypes:q,nodeClickDistance:r,onError:u}){let w,{node:x,internals:y,isParent:z}=dP(b=>{let c=b.nodeLookup.get(a),d=b.parentLookup.has(a);return{node:c,internals:c.internals,isParent:d}},dL),A=x.type||"default",B=q?.[A]||eL[A];void 0===B&&(u?.("003",(w=A,`Node type "${w}" not found. Using fallback type "default".`)),A="default",B=q?.default||eL.default);let C=!!(x.draggable||h&&void 0===x.draggable),D=!!(x.selectable||i&&void 0===x.selectable),E=!!(x.connectable||j&&void 0===x.connectable),F=!!(x.focusable||k&&void 0===x.focusable),G=dQ(),H=cI(x),I=function({node:a,nodeType:b,hasDimensions:c,resizeObserver:d}){let e=dQ(),f=(0,t.useRef)(null),g=(0,t.useRef)(null),h=(0,t.useRef)(a.sourcePosition),i=(0,t.useRef)(a.targetPosition),j=(0,t.useRef)(b),k=c&&!!a.internals.handleBounds;return(0,t.useEffect)(()=>{!f.current||a.hidden||k&&g.current===f.current||(g.current&&d?.unobserve(g.current),d?.observe(f.current),g.current=f.current)},[k,a.hidden]),(0,t.useEffect)(()=>()=>{g.current&&(d?.unobserve(g.current),g.current=null)},[]),(0,t.useEffect)(()=>{if(f.current){let c=j.current!==b,d=h.current!==a.sourcePosition,g=i.current!==a.targetPosition;(c||d||g)&&(j.current=b,h.current=a.sourcePosition,i.current=a.targetPosition,e.getState().updateNodeInternals(new Map([[a.id,{id:a.id,nodeElement:f.current,force:!0}]])))}},[a.id,b,a.sourcePosition,a.targetPosition]),f}({node:x,nodeType:A,hasDimensions:H,resizeObserver:l}),J=eD({nodeRef:I,disabled:x.hidden||!C,noDragClassName:m,handleSelector:x.dragHandle,nodeId:a,isSelectable:D,nodeClickDistance:r}),K=eE();if(x.hidden)return null;let L=cH(x),M=void 0===x.internals.handleBounds?{width:x.width??x.initialWidth??x.style?.width,height:x.height??x.initialHeight??x.style?.height}:{width:x.width??x.style?.width,height:x.height??x.style?.height},N=D||C||b||c||d||e,O=c?a=>c(a,{...y.userNode}):void 0,P=d?a=>d(a,{...y.userNode}):void 0,Q=e?a=>e(a,{...y.userNode}):void 0,R=f?a=>f(a,{...y.userNode}):void 0,S=g?a=>g(a,{...y.userNode}):void 0;return(0,s.jsx)("div",{className:v(["react-flow__node",`react-flow__node-${A}`,{[n]:C},x.className,{selected:x.selected,selectable:D,parent:z,draggable:C,dragging:J}]),ref:I,style:{zIndex:y.z,transform:`translate(${y.positionAbsolute.x}px,${y.positionAbsolute.y}px)`,pointerEvents:N?"all":"none",visibility:H?"visible":"hidden",...x.style,...M},"data-id":a,"data-testid":`rf__node-${a}`,onMouseEnter:O,onMouseMove:P,onMouseLeave:Q,onContextMenu:R,onClick:c=>{let{selectNodesOnDrag:d,nodeDragThreshold:e}=G.getState();D&&(!d||!C||e>0)&&eC({id:a,store:G,nodeRef:I}),b&&b(c,{...y.userNode})},onDoubleClick:S,onKeyDown:F?b=>{if(!cP(b.nativeEvent)&&!o){if(b8.includes(b.key)&&D)eC({id:a,store:G,unselect:"Escape"===b.key,nodeRef:I});else if(C&&x.selected&&Object.prototype.hasOwnProperty.call(eK,b.key)){b.preventDefault();let{ariaLabelConfig:a}=G.getState();G.setState({ariaLiveMessage:a["node.a11yDescription.ariaLiveMessage"]({direction:b.key.replace("Arrow","").toLowerCase(),x:~~y.positionAbsolute.x,y:~~y.positionAbsolute.y})}),K({direction:eK[b.key],factor:b.shiftKey?4:1})}}}:void 0,tabIndex:F?0:void 0,onFocus:F?()=>{if(o||!I.current?.matches(":focus-visible"))return;let{transform:b,width:c,height:d,autoPanOnNodeFocus:e,setCenter:f}=G.getState();!e||ch(new Map([[a,x]]),{x:0,y:0,width:c,height:d},b,!0).length>0||f(x.position.x+L.width/2,x.position.y+L.height/2,{zoom:b[2]})}:void 0,role:x.ariaRole??(F?"group":void 0),"aria-roledescription":"node","aria-describedby":o?void 0:`${dT}-${p}`,"aria-label":x.ariaLabel,...x.domAttributes,children:(0,s.jsx)(eG,{value:a,children:(0,s.jsx)(B,{id:a,data:x.data,type:A,positionAbsoluteX:y.positionAbsolute.x,positionAbsoluteY:y.positionAbsolute.y,selected:x.selected??!1,selectable:D,draggable:C,deletable:x.deletable??!0,isConnectable:E,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:J,dragHandle:x.dragHandle,zIndex:y.z,parentId:x.parentId,...L})})})});let eU=a=>({nodesDraggable:a.nodesDraggable,nodesConnectable:a.nodesConnectable,nodesFocusable:a.nodesFocusable,elementsSelectable:a.elementsSelectable,onError:a.onError});function eV(a){var b;let{nodesDraggable:c,nodesConnectable:d,nodesFocusable:e,elementsSelectable:f,onError:g}=dP(eU,dL),h=(b=a.onlyRenderVisibleElements,dP((0,t.useCallback)(a=>b?ch(a.nodeLookup,{x:0,y:0,width:a.width,height:a.height},a.transform,!0).map(a=>a.id):Array.from(a.nodeLookup.keys()),[b]),dL)),i=function(){let a=dP(eS),[b]=(0,t.useState)(()=>"undefined"==typeof ResizeObserver?null:new ResizeObserver(b=>{let c=new Map;b.forEach(a=>{let b=a.target.getAttribute("data-id");c.set(b,{id:b,nodeElement:a.target,force:!0})}),a(c)}));return(0,t.useEffect)(()=>()=>{b?.disconnect()},[b]),b}();return(0,s.jsx)("div",{className:"react-flow__nodes",style:eu,children:h.map(b=>(0,s.jsx)(eT,{id:b,nodeTypes:a.nodeTypes,nodeExtent:a.nodeExtent,onClick:a.onNodeClick,onMouseEnter:a.onNodeMouseEnter,onMouseMove:a.onNodeMouseMove,onMouseLeave:a.onNodeMouseLeave,onContextMenu:a.onNodeContextMenu,onDoubleClick:a.onNodeDoubleClick,noDragClassName:a.noDragClassName,noPanClassName:a.noPanClassName,rfId:a.rfId,disableKeyboardA11y:a.disableKeyboardA11y,resizeObserver:i,nodesDraggable:c,nodesConnectable:d,nodesFocusable:e,elementsSelectable:f,nodeClickDistance:a.nodeClickDistance,onError:g},b))})}eV.displayName="NodeRenderer";let eW=(0,t.memo)(eV),eX={[o.Arrow]:({color:a="none",strokeWidth:b=1})=>{let c={strokeWidth:b,...a&&{stroke:a}};return(0,s.jsx)("polyline",{className:"arrow",style:c,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},[o.ArrowClosed]:({color:a="none",strokeWidth:b=1})=>{let c={strokeWidth:b,...a&&{stroke:a,fill:a}};return(0,s.jsx)("polyline",{className:"arrowclosed",style:c,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}},eY=({id:a,type:b,color:c,width:d=12.5,height:e=12.5,markerUnits:f="strokeWidth",strokeWidth:g,orient:h="auto-start-reverse"})=>{let i,j=(i=dQ(),(0,t.useMemo)(()=>{let a;return Object.prototype.hasOwnProperty.call(eX,b)?eX[b]:(i.getState().onError?.("009",(a=b,`Marker type "${a}" doesn't exist.`)),null)},[b]));return j?(0,s.jsx)("marker",{className:"react-flow__arrowhead",id:a,markerWidth:`${d}`,markerHeight:`${e}`,viewBox:"-10 -10 20 20",markerUnits:f,orient:h,refX:"0",refY:"0",children:(0,s.jsx)(j,{color:c,strokeWidth:g})}):null},eZ=({defaultColor:a,rfId:b})=>{let c=dP(a=>a.edges),d=dP(a=>a.defaultEdgeOptions),e=(0,t.useMemo)(()=>(function(a,{id:b,defaultColor:c,defaultMarkerStart:d,defaultMarkerEnd:e}){let f=new Set;return a.reduce((a,g)=>([g.markerStart||d,g.markerEnd||e].forEach(d=>{if(d&&"object"==typeof d){let e=c6(d,b);f.has(e)||(a.push({id:e,color:d.color||c,...d}),f.add(e))}}),a),[]).sort((a,b)=>a.id.localeCompare(b.id))})(c,{id:b,defaultColor:a,defaultMarkerStart:d?.markerStart,defaultMarkerEnd:d?.markerEnd}),[c,d,b,a]);return e.length?(0,s.jsx)("svg",{className:"react-flow__marker","aria-hidden":"true",children:(0,s.jsx)("defs",{children:e.map(a=>(0,s.jsx)(eY,{id:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,strokeWidth:a.strokeWidth,orient:a.orient},a.id))})}):null};eZ.displayName="MarkerDefinitions";var e$=(0,t.memo)(eZ);function e_({x:a,y:b,label:c,labelStyle:d,labelShowBg:e=!0,labelBgStyle:f,labelBgPadding:g=[2,4],labelBgBorderRadius:h=2,children:i,className:j,...k}){let[l,m]=(0,t.useState)({x:1,y:0,width:0,height:0}),n=v(["react-flow__edge-textwrapper",j]),o=(0,t.useRef)(null);return((0,t.useEffect)(()=>{if(o.current){let a=o.current.getBBox();m({x:a.x,y:a.y,width:a.width,height:a.height})}},[c]),c)?(0,s.jsxs)("g",{transform:`translate(${a-l.width/2} ${b-l.height/2})`,className:n,visibility:l.width?"visible":"hidden",...k,children:[e&&(0,s.jsx)("rect",{width:l.width+2*g[0],x:-g[0],y:-g[1],height:l.height+2*g[1],className:"react-flow__edge-textbg",style:f,rx:h,ry:h}),(0,s.jsx)("text",{className:"react-flow__edge-text",y:l.height/2,dy:"0.3em",ref:o,style:d,children:c}),i]}):null}e_.displayName="EdgeText";let e0=(0,t.memo)(e_);function e1({path:a,labelX:b,labelY:c,label:d,labelStyle:e,labelShowBg:f,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:i,interactionWidth:j=20,...k}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{...k,d:a,fill:"none",className:v(["react-flow__edge-path",k.className])}),j?(0,s.jsx)("path",{d:a,fill:"none",strokeOpacity:0,strokeWidth:j,className:"react-flow__edge-interaction"}):null,d&&cy(b)&&cy(c)?(0,s.jsx)(e0,{x:b,y:c,label:d,labelStyle:e,labelShowBg:f,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:i}):null]})}function e2({pos:a,x1:b,y1:c,x2:d,y2:e}){return a===p.Left||a===p.Right?[.5*(b+d),c]:[b,.5*(c+e)]}function e3({sourceX:a,sourceY:b,sourcePosition:c=p.Bottom,targetX:d,targetY:e,targetPosition:f=p.Top}){let[g,h]=e2({pos:c,x1:a,y1:b,x2:d,y2:e}),[i,j]=e2({pos:f,x1:d,y1:e,x2:a,y2:b}),[k,l,m,n]=cS({sourceX:a,sourceY:b,targetX:d,targetY:e,sourceControlX:g,sourceControlY:h,targetControlX:i,targetControlY:j});return[`M${a},${b} C${g},${h} ${i},${j} ${d},${e}`,k,l,m,n]}function e4(a){return(0,t.memo)(({id:b,sourceX:c,sourceY:d,targetX:e,targetY:f,sourcePosition:g,targetPosition:h,label:i,labelStyle:j,labelShowBg:k,labelBgStyle:l,labelBgPadding:m,labelBgBorderRadius:n,style:o,markerEnd:p,markerStart:q,interactionWidth:r})=>{let[t,u,v]=e3({sourceX:c,sourceY:d,sourcePosition:g,targetX:e,targetY:f,targetPosition:h}),w=a.isInternal?void 0:b;return(0,s.jsx)(e1,{id:w,path:t,labelX:u,labelY:v,label:i,labelStyle:j,labelShowBg:k,labelBgStyle:l,labelBgPadding:m,labelBgBorderRadius:n,style:o,markerEnd:p,markerStart:q,interactionWidth:r})})}let e5=e4({isInternal:!1}),e6=e4({isInternal:!0});function e7(a){return(0,t.memo)(({id:b,sourceX:c,sourceY:d,targetX:e,targetY:f,label:g,labelStyle:h,labelShowBg:i,labelBgStyle:j,labelBgPadding:k,labelBgBorderRadius:l,style:m,sourcePosition:n=p.Bottom,targetPosition:o=p.Top,markerEnd:q,markerStart:r,pathOptions:t,interactionWidth:u})=>{let[v,w,x]=c1({sourceX:c,sourceY:d,sourcePosition:n,targetX:e,targetY:f,targetPosition:o,borderRadius:t?.borderRadius,offset:t?.offset,stepPosition:t?.stepPosition}),y=a.isInternal?void 0:b;return(0,s.jsx)(e1,{id:y,path:v,labelX:w,labelY:x,label:g,labelStyle:h,labelShowBg:i,labelBgStyle:j,labelBgPadding:k,labelBgBorderRadius:l,style:m,markerEnd:q,markerStart:r,interactionWidth:u})})}e5.displayName="SimpleBezierEdge",e6.displayName="SimpleBezierEdgeInternal";let e8=e7({isInternal:!1}),e9=e7({isInternal:!0});function fa(a){return(0,t.memo)(({id:b,...c})=>{let d=a.isInternal?void 0:b;return(0,s.jsx)(e8,{...c,id:d,pathOptions:(0,t.useMemo)(()=>({borderRadius:0,offset:c.pathOptions?.offset}),[c.pathOptions?.offset])})})}e8.displayName="SmoothStepEdge",e9.displayName="SmoothStepEdgeInternal";let fb=fa({isInternal:!1}),fc=fa({isInternal:!0});function fd(a){return(0,t.memo)(({id:b,sourceX:c,sourceY:d,targetX:e,targetY:f,label:g,labelStyle:h,labelShowBg:i,labelBgStyle:j,labelBgPadding:k,labelBgBorderRadius:l,style:m,markerEnd:n,markerStart:o,interactionWidth:p})=>{let[q,r,t]=cZ({sourceX:c,sourceY:d,targetX:e,targetY:f}),u=a.isInternal?void 0:b;return(0,s.jsx)(e1,{id:u,path:q,labelX:r,labelY:t,label:g,labelStyle:h,labelShowBg:i,labelBgStyle:j,labelBgPadding:k,labelBgBorderRadius:l,style:m,markerEnd:n,markerStart:o,interactionWidth:p})})}fb.displayName="StepEdge",fc.displayName="StepEdgeInternal";let fe=fd({isInternal:!1}),ff=fd({isInternal:!0});function fg(a){return(0,t.memo)(({id:b,sourceX:c,sourceY:d,targetX:e,targetY:f,sourcePosition:g=p.Bottom,targetPosition:h=p.Top,label:i,labelStyle:j,labelShowBg:k,labelBgStyle:l,labelBgPadding:m,labelBgBorderRadius:n,style:o,markerEnd:q,markerStart:r,pathOptions:t,interactionWidth:u})=>{let[v,w,x]=cV({sourceX:c,sourceY:d,sourcePosition:g,targetX:e,targetY:f,targetPosition:h,curvature:t?.curvature}),y=a.isInternal?void 0:b;return(0,s.jsx)(e1,{id:y,path:v,labelX:w,labelY:x,label:i,labelStyle:j,labelShowBg:k,labelBgStyle:l,labelBgPadding:m,labelBgBorderRadius:n,style:o,markerEnd:q,markerStart:r,interactionWidth:u})})}fe.displayName="StraightEdge",ff.displayName="StraightEdgeInternal";let fh=fg({isInternal:!1}),fi=fg({isInternal:!0});fh.displayName="BezierEdge",fi.displayName="BezierEdgeInternal";let fj={default:fi,straight:ff,step:fc,smoothstep:e9,simplebezier:e6},fk={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},fl="react-flow__edgeupdater";function fm({position:a,centerX:b,centerY:c,radius:d=10,onMouseDown:e,onMouseEnter:f,onMouseOut:g,type:h}){return(0,s.jsx)("circle",{onMouseDown:e,onMouseEnter:f,onMouseOut:g,className:v([fl,`${fl}-${h}`]),cx:a===p.Left?b-d:a===p.Right?b+d:b,cy:a===p.Top?c-d:a===p.Bottom?c+d:c,r:d,stroke:"transparent",fill:"transparent"})}function fn({isReconnectable:a,reconnectRadius:b,edge:c,sourceX:d,sourceY:e,targetX:f,targetY:g,sourcePosition:h,targetPosition:i,onReconnect:j,onReconnectStart:k,onReconnectEnd:l,setReconnecting:m,setUpdateHover:n}){let o=dQ(),p=(a,b)=>{if(0!==a.button)return;let{autoPanOnConnect:d,domNode:e,isValidConnection:f,connectionMode:g,connectionRadius:h,lib:i,onConnectStart:n,onConnectEnd:p,cancelConnection:q,nodeLookup:r,rfId:s,panBy:t,updateConnection:u}=o.getState(),v="target"===b.type;dp(a.nativeEvent,{autoPanOnConnect:d,connectionMode:g,connectionRadius:h,domNode:e,handleId:b.id,nodeId:b.nodeId,nodeLookup:r,isTarget:v,edgeUpdaterType:b.type,lib:i,flowId:s,cancelConnection:q,panBy:t,isValidConnection:f,onConnect:a=>j?.(c,a),onConnectStart:(d,e)=>{m(!0),k?.(a,c,b.type),n?.(d,e)},onConnectEnd:p,onReconnectEnd:(a,d)=>{m(!1),l?.(a,c,b.type,d)},updateConnection:u,getTransform:()=>o.getState().transform,getFromHandle:()=>o.getState().connection.fromHandle,dragThreshold:o.getState().connectionDragThreshold,handleDomNode:a.currentTarget})},q=()=>n(!0),r=()=>n(!1);return(0,s.jsxs)(s.Fragment,{children:[(!0===a||"source"===a)&&(0,s.jsx)(fm,{position:h,centerX:d,centerY:e,radius:b,onMouseDown:a=>p(a,{nodeId:c.target,id:c.targetHandle??null,type:"target"}),onMouseEnter:q,onMouseOut:r,type:"source"}),(!0===a||"target"===a)&&(0,s.jsx)(fm,{position:i,centerX:f,centerY:g,radius:b,onMouseDown:a=>p(a,{nodeId:c.source,id:c.sourceHandle??null,type:"source"}),onMouseEnter:q,onMouseOut:r,type:"target"})]})}var fo=(0,t.memo)(function({id:a,edgesFocusable:b,edgesReconnectable:c,elementsSelectable:d,onClick:e,onDoubleClick:f,onContextMenu:g,onMouseEnter:h,onMouseMove:i,onMouseLeave:j,reconnectRadius:l,onReconnect:m,onReconnectStart:n,onReconnectEnd:o,rfId:q,edgeTypes:r,noPanClassName:u,onError:w,disableKeyboardA11y:x}){let y,z=dP(b=>b.edgeLookup.get(a)),A=dP(a=>a.defaultEdgeOptions),B=(z=A?{...A,...z}:z).type||"default",C=r?.[B]||fj[B];void 0===C&&(w?.("011",(y=B,`Edge type "${y}" not found. Using fallback type "default".`)),B="default",C=r?.default||fj.default);let D=!!(z.focusable||b&&void 0===z.focusable),E=void 0!==m&&(z.reconnectable||c&&void 0===z.reconnectable),F=!!(z.selectable||d&&void 0===z.selectable),G=(0,t.useRef)(null),[H,I]=(0,t.useState)(!1),[J,K]=(0,t.useState)(!1),L=dQ(),{zIndex:M,sourceX:N,sourceY:O,targetX:P,targetY:Q,sourcePosition:R,targetPosition:S}=dP((0,t.useCallback)(b=>{let c=b.nodeLookup.get(z.source),d=b.nodeLookup.get(z.target);if(!c||!d)return{zIndex:z.zIndex,...fk};let e=function(a){let{sourceNode:b,targetNode:c}=a;if(!c2(b)||!c2(c))return null;let d=b.internals.handleBounds||c3(b.handles),e=c.internals.handleBounds||c3(c.handles),f=c5(d?.source??[],a.sourceHandle),g=c5(a.connectionMode===k.Strict?e?.target??[]:(e?.target??[]).concat(e?.source??[]),a.targetHandle);if(!f||!g)return a.onError?.("008",((a,{id:b,sourceHandle:c,targetHandle:d})=>`Couldn't create edge for ${a} handle id: "${"source"===a?c:d}", edge id: ${b}.`)(!f?"source":"target",{id:a.id,sourceHandle:a.sourceHandle,targetHandle:a.targetHandle})),null;let h=f?.position||p.Bottom,i=g?.position||p.Top,j=c4(b,f,h),l=c4(c,g,i);return{sourceX:j.x,sourceY:j.y,targetX:l.x,targetY:l.y,sourcePosition:h,targetPosition:i}}({id:a,sourceNode:c,targetNode:d,sourceHandle:z.sourceHandle||null,targetHandle:z.targetHandle||null,connectionMode:b.connectionMode,onError:w});return{zIndex:function({sourceNode:a,targetNode:b,selected:c=!1,zIndex:d=0,elevateOnSelect:e=!1,zIndexMode:f="basic"}){if("manual"===f)return d;let g=Math.max(a.parentId||e&&a.selected?a.internals.z:0,b.parentId||e&&b.selected?b.internals.z:0);return(e&&c?d+1e3:d)+g}({selected:z.selected,zIndex:z.zIndex,sourceNode:c,targetNode:d,elevateOnSelect:b.elevateEdgesOnSelect,zIndexMode:b.zIndexMode}),...e||fk}},[z.source,z.target,z.sourceHandle,z.targetHandle,z.selected,z.zIndex]),dL),T=(0,t.useMemo)(()=>z.markerStart?`url('#${c6(z.markerStart,q)}')`:void 0,[z.markerStart,q]),U=(0,t.useMemo)(()=>z.markerEnd?`url('#${c6(z.markerEnd,q)}')`:void 0,[z.markerEnd,q]);if(z.hidden||null===N||null===O||null===P||null===Q)return null;let V=f?a=>{f(a,{...z})}:void 0,W=g?a=>{g(a,{...z})}:void 0,X=h?a=>{h(a,{...z})}:void 0,Y=i?a=>{i(a,{...z})}:void 0,Z=j?a=>{j(a,{...z})}:void 0;return(0,s.jsx)("svg",{style:{zIndex:M},children:(0,s.jsxs)("g",{className:v(["react-flow__edge",`react-flow__edge-${B}`,z.className,u,{selected:z.selected,animated:z.animated,inactive:!F&&!e,updating:H,selectable:F}]),onClick:b=>{let{addSelectedEdges:c,unselectNodesAndEdges:d,multiSelectionActive:f}=L.getState();F&&(L.setState({nodesSelectionActive:!1}),z.selected&&f?(d({nodes:[],edges:[z]}),G.current?.blur()):c([a])),e&&e(b,z)},onDoubleClick:V,onContextMenu:W,onMouseEnter:X,onMouseMove:Y,onMouseLeave:Z,onKeyDown:D?b=>{if(!x&&b8.includes(b.key)&&F){let{unselectNodesAndEdges:c,addSelectedEdges:d}=L.getState();"Escape"===b.key?(G.current?.blur(),c({edges:[z]})):d([a])}}:void 0,tabIndex:D?0:void 0,role:z.ariaRole??(D?"group":"img"),"aria-roledescription":"edge","data-id":a,"data-testid":`rf__edge-${a}`,"aria-label":null===z.ariaLabel?void 0:z.ariaLabel||`Edge from ${z.source} to ${z.target}`,"aria-describedby":D?`${dU}-${q}`:void 0,ref:G,...z.domAttributes,children:[!J&&(0,s.jsx)(C,{id:a,source:z.source,target:z.target,type:z.type,selected:z.selected,animated:z.animated,selectable:F,deletable:z.deletable??!0,label:z.label,labelStyle:z.labelStyle,labelShowBg:z.labelShowBg,labelBgStyle:z.labelBgStyle,labelBgPadding:z.labelBgPadding,labelBgBorderRadius:z.labelBgBorderRadius,sourceX:N,sourceY:O,targetX:P,targetY:Q,sourcePosition:R,targetPosition:S,data:z.data,style:z.style,sourceHandleId:z.sourceHandle,targetHandleId:z.targetHandle,markerStart:T,markerEnd:U,pathOptions:"pathOptions"in z?z.pathOptions:void 0,interactionWidth:z.interactionWidth}),E&&(0,s.jsx)(fn,{edge:z,isReconnectable:E,reconnectRadius:l,onReconnect:m,onReconnectStart:n,onReconnectEnd:o,sourceX:N,sourceY:O,targetX:P,targetY:Q,sourcePosition:R,targetPosition:S,setUpdateHover:I,setReconnecting:K})]})})});let fp=a=>({edgesFocusable:a.edgesFocusable,edgesReconnectable:a.edgesReconnectable,elementsSelectable:a.elementsSelectable,connectionMode:a.connectionMode,onError:a.onError});function fq({defaultMarkerColor:a,onlyRenderVisibleElements:b,rfId:c,edgeTypes:d,noPanClassName:e,onReconnect:f,onEdgeContextMenu:g,onEdgeMouseEnter:h,onEdgeMouseMove:i,onEdgeMouseLeave:j,onEdgeClick:k,reconnectRadius:l,onEdgeDoubleClick:m,onReconnectStart:n,onReconnectEnd:o,disableKeyboardA11y:p}){let{edgesFocusable:q,edgesReconnectable:r,elementsSelectable:u,onError:v}=dP(fp,dL),w=dP((0,t.useCallback)(a=>{if(!b)return a.edges.map(a=>a.id);let c=[];if(a.width&&a.height)for(let b of a.edges){let d=a.nodeLookup.get(b.source),e=a.nodeLookup.get(b.target);d&&e&&function({sourceNode:a,targetNode:b,width:c,height:d,transform:e}){let f=cq(cu(a),cu(b));return f.x===f.x2&&(f.x2+=1),f.y===f.y2&&(f.y2+=1),cw({x:-e[0]/e[2],y:-e[1]/e[2],width:c/e[2],height:d/e[2]},cs(f))>0}({sourceNode:d,targetNode:e,width:a.width,height:a.height,transform:a.transform})&&c.push(b.id)}return c},[b]),dL);return(0,s.jsxs)("div",{className:"react-flow__edges",children:[(0,s.jsx)(e$,{defaultColor:a,rfId:c}),w.map(a=>(0,s.jsx)(fo,{id:a,edgesFocusable:q,edgesReconnectable:r,elementsSelectable:u,noPanClassName:e,onReconnect:f,onContextMenu:g,onMouseEnter:h,onMouseMove:i,onMouseLeave:j,onClick:k,reconnectRadius:l,onDoubleClick:m,onReconnectStart:n,onReconnectEnd:o,rfId:c,onError:v,edgeTypes:d,disableKeyboardA11y:p},a))]})}fq.displayName="EdgeRenderer";let fr=(0,t.memo)(fq),fs=a=>`translate(${a.transform[0]}px,${a.transform[1]}px) scale(${a.transform[2]})`;function ft({children:a}){let b=dP(fs);return(0,s.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:b},children:a})}let fu=a=>a.panZoom?.syncViewport;function fv(a){return a.connection.inProgress?{...a.connection,to:cB(a.connection.to,a.transform)}:{...a.connection}}let fw=a=>({nodesConnectable:a.nodesConnectable,isValid:a.connection.isValid,inProgress:a.connection.inProgress,width:a.width,height:a.height});function fx({containerStyle:a,style:b,type:c,component:d}){let{nodesConnectable:e,width:f,height:g,isValid:h,inProgress:i}=dP(fw,dL);return f&&e&&i?(0,s.jsx)("svg",{style:a,width:f,height:g,className:"react-flow__connectionline react-flow__container",children:(0,s.jsx)("g",{className:v(["react-flow__connection",cc(h)]),children:(0,s.jsx)(fy,{style:b,type:c,CustomComponent:d,isValid:h})})}):null}let fy=({style:a,type:b=n.Bezier,CustomComponent:c,isValid:d})=>{let{inProgress:e,from:f,fromNode:g,fromHandle:h,fromPosition:i,to:j,toNode:k,toHandle:l,toPosition:m,pointer:o}=dP(fv,dL);if(!e)return;if(c)return(0,s.jsx)(c,{connectionLineType:b,connectionLineStyle:a,fromNode:g,fromHandle:h,fromX:f.x,fromY:f.y,toX:j.x,toY:j.y,fromPosition:i,toPosition:m,connectionStatus:cc(d),toNode:k,toHandle:l,pointer:o});let p="",q={sourceX:f.x,sourceY:f.y,sourcePosition:i,targetX:j.x,targetY:j.y,targetPosition:m};switch(b){case n.Bezier:[p]=cV(q);break;case n.SimpleBezier:[p]=e3(q);break;case n.Step:[p]=c1({...q,borderRadius:0});break;case n.SmoothStep:[p]=c1(q);break;default:[p]=cZ(q)}return(0,s.jsx)("path",{d:p,fill:"none",className:"react-flow__connection-path",style:a})};fy.displayName="ConnectionLine";let fz={};function fA(a=fz){(0,t.useRef)(a),dQ(),(0,t.useEffect)(()=>{},[a])}function fB({nodeTypes:a,edgeTypes:b,onInit:c,onNodeClick:d,onEdgeClick:e,onNodeDoubleClick:f,onEdgeDoubleClick:g,onNodeMouseEnter:h,onNodeMouseMove:i,onNodeMouseLeave:j,onNodeContextMenu:k,onSelectionContextMenu:l,onSelectionStart:m,onSelectionEnd:n,connectionLineType:o,connectionLineStyle:p,connectionLineComponent:q,connectionLineContainerStyle:r,selectionKeyCode:u,selectionOnDrag:v,selectionMode:w,multiSelectionKeyCode:x,panActivationKeyCode:y,zoomActivationKeyCode:z,deleteKeyCode:A,onlyRenderVisibleElements:B,elementsSelectable:C,defaultViewport:D,translateExtent:E,minZoom:F,maxZoom:G,preventScrolling:H,defaultMarkerColor:I,zoomOnScroll:J,zoomOnPinch:K,panOnScroll:L,panOnScrollSpeed:M,panOnScrollMode:N,zoomOnDoubleClick:O,panOnDrag:P,onPaneClick:Q,onPaneMouseEnter:R,onPaneMouseMove:S,onPaneMouseLeave:T,onPaneScroll:U,onPaneContextMenu:V,paneClickDistance:W,nodeClickDistance:X,onEdgeContextMenu:Y,onEdgeMouseEnter:Z,onEdgeMouseMove:$,onEdgeMouseLeave:_,reconnectRadius:aa,onReconnect:ab,onReconnectStart:ac,onReconnectEnd:ad,noDragClassName:ae,noWheelClassName:af,noPanClassName:ag,disableKeyboardA11y:ah,nodeExtent:ai,rfId:aj,viewport:ak,onViewportChange:al}){let am,an,ao,ap;return fA(a),fA(b),dQ(),(0,t.useRef)(!1),(0,t.useEffect)(()=>{},[]),am=er(),an=(0,t.useRef)(!1),(0,t.useEffect)(()=>{!an.current&&am.viewportInitialized&&c&&(setTimeout(()=>c(am),1),an.current=!0)},[c,am.viewportInitialized]),ao=dP(fu),ap=dQ(),(0,t.useEffect)(()=>{ak&&(ao?.(ak),ap.setState({transform:[ak.x,ak.y,ak.zoom]}))},[ak,ao]),(0,s.jsx)(eR,{onPaneClick:Q,onPaneMouseEnter:R,onPaneMouseMove:S,onPaneMouseLeave:T,onPaneContextMenu:V,onPaneScroll:U,paneClickDistance:W,deleteKeyCode:A,selectionKeyCode:u,selectionOnDrag:v,selectionMode:w,onSelectionStart:m,onSelectionEnd:n,multiSelectionKeyCode:x,panActivationKeyCode:y,zoomActivationKeyCode:z,elementsSelectable:C,zoomOnScroll:J,zoomOnPinch:K,zoomOnDoubleClick:O,panOnScroll:L,panOnScrollSpeed:M,panOnScrollMode:N,panOnDrag:P,defaultViewport:D,translateExtent:E,minZoom:F,maxZoom:G,onSelectionContextMenu:l,preventScrolling:H,noDragClassName:ae,noWheelClassName:af,noPanClassName:ag,disableKeyboardA11y:ah,onViewportChange:al,isControlledViewport:!!ak,children:(0,s.jsxs)(ft,{children:[(0,s.jsx)(fr,{edgeTypes:b,onEdgeClick:e,onEdgeDoubleClick:g,onReconnect:ab,onReconnectStart:ac,onReconnectEnd:ad,onlyRenderVisibleElements:B,onEdgeContextMenu:Y,onEdgeMouseEnter:Z,onEdgeMouseMove:$,onEdgeMouseLeave:_,reconnectRadius:aa,defaultMarkerColor:I,noPanClassName:ag,disableKeyboardA11y:ah,rfId:aj}),(0,s.jsx)(fx,{style:p,type:o,component:q,containerStyle:r}),(0,s.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,s.jsx)(eW,{nodeTypes:a,onNodeClick:d,onNodeDoubleClick:f,onNodeMouseEnter:h,onNodeMouseMove:i,onNodeMouseLeave:j,onNodeContextMenu:k,nodeClickDistance:X,onlyRenderVisibleElements:B,noPanClassName:ag,noDragClassName:ae,disableKeyboardA11y:ah,nodeExtent:ai,rfId:aj}),(0,s.jsx)("div",{className:"react-flow__viewport-portal"})]})})}fB.displayName="GraphView";let fC=(0,t.memo)(fB),fD=({nodes:a,edges:b,defaultNodes:c,defaultEdges:d,width:e,height:f,fitView:g,fitViewOptions:h,minZoom:i=.5,maxZoom:j=2,nodeOrigin:l,nodeExtent:m,zIndexMode:n="basic"}={})=>{let o=new Map,p=new Map,q=new Map,r=new Map,s=d??b??[],t=c??a??[],u=l??[0,0],v=m??b7;dh(q,r,s);let w=db(t,o,p,{nodeOrigin:u,nodeExtent:v,zIndexMode:n}),x=[0,0,1];if(g&&e&&f){let{x:a,y:b,zoom:c}=cE(cg(o,{filter:a=>!!((a.width||a.initialWidth)&&(a.height||a.initialHeight))}),e,f,i,j,h?.padding??.1);x=[a,b,c]}return{rfId:"1",width:e??0,height:f??0,transform:x,nodes:t,nodesInitialized:w,nodeLookup:o,parentLookup:p,edges:s,edgeLookup:r,connectionLookup:q,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==c,hasDefaultEdges:void 0!==d,panZoom:null,minZoom:i,maxZoom:j,translateExtent:b7,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:k.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:u,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:g??!1,fitViewOptions:h,fitViewResolver:null,connection:{...ca},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:cz,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:b9,zIndexMode:n,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}};function fE({initialNodes:a,initialEdges:b,defaultNodes:c,defaultEdges:d,initialWidth:e,initialHeight:f,initialMinZoom:g,initialMaxZoom:h,initialFitViewOptions:i,fitView:j,nodeOrigin:k,nodeExtent:l,zIndexMode:m,children:n}){let[o]=(0,t.useState)(()=>(({nodes:a,edges:b,defaultNodes:c,defaultEdges:d,width:e,height:f,fitView:g,fitViewOptions:h,minZoom:i,maxZoom:j,nodeOrigin:k,nodeExtent:l,zIndexMode:m})=>{let n,o;return n=(n,o)=>{async function q(){let{nodeLookup:a,panZoom:b,fitViewOptions:c,fitViewResolver:d,width:e,height:f,minZoom:g,maxZoom:h}=o();b&&(await ci({nodes:a,width:e,height:f,panZoom:b,minZoom:g,maxZoom:h},c),d?.resolve(!0),n({fitViewResolver:null}))}return{...fD({nodes:a,edges:b,width:e,height:f,fitView:g,fitViewOptions:h,minZoom:i,maxZoom:j,nodeOrigin:k,nodeExtent:l,defaultNodes:c,defaultEdges:d,zIndexMode:m}),setNodes:a=>{let{nodeLookup:b,parentLookup:c,nodeOrigin:d,elevateNodesOnSelect:e,fitViewQueued:f,zIndexMode:g}=o(),h=db(a,b,c,{nodeOrigin:d,nodeExtent:l,elevateNodesOnSelect:e,checkEquality:!0,zIndexMode:g});f&&h?(q(),n({nodes:a,nodesInitialized:h,fitViewQueued:!1,fitViewOptions:void 0})):n({nodes:a,nodesInitialized:h})},setEdges:a=>{let{connectionLookup:b,edgeLookup:c}=o();dh(b,c,a),n({edges:a})},setDefaultNodesAndEdges:(a,b)=>{if(a){let{setNodes:b}=o();b(a),n({hasDefaultNodes:!0})}if(b){let{setEdges:a}=o();a(b),n({hasDefaultEdges:!0})}},updateNodeInternals:a=>{let{triggerNodeChanges:b,nodeLookup:c,parentLookup:d,domNode:e,nodeOrigin:f,nodeExtent:g,debug:h,fitViewQueued:i,zIndexMode:j}=o(),{changes:k,updatedInternals:l}=function(a,b,c,d,e,f,g){let h=d?.querySelector(".xyflow__viewport"),i=!1;if(!h)return{changes:[],updatedInternals:i};let j=[],k=window.getComputedStyle(h),{m22:l}=new window.DOMMatrixReadOnly(k.transform),m=[];for(let d of a.values()){let a=b.get(d.id);if(!a)continue;if(a.hidden){b.set(a.id,{...a,internals:{...a.internals,handleBounds:void 0}}),i=!0;continue}let h=cM(d.nodeElement),k=a.measured.width!==h.width||a.measured.height!==h.height;if(h.width&&h.height&&(k||!a.internals.handleBounds||d.force)){let n=d.nodeElement.getBoundingClientRect(),o=cG(a.extent)?a.extent:f,{positionAbsolute:p}=a.internals;a.parentId&&"parent"===a.extent?p=cn(p,h,b.get(a.parentId)):o&&(p=cm(p,o,h));let q={...a,measured:h,internals:{...a.internals,positionAbsolute:p,handleBounds:{source:cR("source",d.nodeElement,n,l,a.id),target:cR("target",d.nodeElement,n,l,a.id)}}};b.set(a.id,q),a.parentId&&dc(q,b,c,{nodeOrigin:e,zIndexMode:g}),i=!0,k&&(j.push({id:a.id,type:"dimensions",dimensions:h}),a.expandParent&&a.parentId&&m.push({id:a.id,parentId:a.parentId,rect:ct(q,e)}))}}if(m.length>0){let a=de(m,b,c,e);j.push(...a)}return{changes:j,updatedInternals:i}}(a,c,d,e,f,g,j);l&&(!function(a,b,c){let d=c9(c7,c);for(let c of a.values())if(c.parentId)dc(c,a,b,d);else{let a=cm(cf(c,d.nodeOrigin),cG(c.extent)?c.extent:d.nodeExtent,cH(c));c.internals.positionAbsolute=a}}(c,d,{nodeOrigin:f,nodeExtent:g,zIndexMode:j}),i?(q(),n({fitViewQueued:!1,fitViewOptions:void 0})):n({}),k?.length>0&&(h&&console.log("React Flow: trigger node changes",k),b?.(k)))},updateNodePositions:(a,b=!1)=>{let c=[],d=[],{nodeLookup:e,triggerNodeChanges:f,connection:g,updateConnection:h,onNodesChangeMiddlewareMap:i}=o();for(let[f,i]of a){let a=e.get(f),j=!!(a?.expandParent&&a?.parentId&&i?.position),k={id:f,type:"position",position:j?{x:Math.max(0,i.position.x),y:Math.max(0,i.position.y)}:i.position,dragging:b};if(a&&g.inProgress&&g.fromNode.id===a.id){let b=c4(a,g.fromHandle,p.Left,!0);h({...g,from:b})}j&&a.parentId&&c.push({id:f,parentId:a.parentId,rect:{...i.internals.positionAbsolute,width:i.measured.width??0,height:i.measured.height??0}}),d.push(k)}if(c.length>0){let{parentLookup:a,nodeOrigin:b}=o(),f=de(c,e,a,b);d.push(...f)}for(let a of i.values())d=a(d);f(d)},triggerNodeChanges:a=>{let{onNodesChange:b,setNodes:c,nodes:d,hasDefaultNodes:e,debug:f}=o();a?.length&&(e&&c(ef(a,d)),f&&console.log("React Flow: trigger node changes",a),b?.(a))},triggerEdgeChanges:a=>{let{onEdgesChange:b,setEdges:c,edges:d,hasDefaultEdges:e,debug:f}=o();a?.length&&(e&&c(ef(a,d)),f&&console.log("React Flow: trigger edge changes",a),b?.(a))},addSelectedNodes:a=>{let{multiSelectionActive:b,edgeLookup:c,nodeLookup:d,triggerNodeChanges:e,triggerEdgeChanges:f}=o();b?e(a.map(a=>eg(a,!0))):(e(eh(d,new Set([...a]),!0)),f(eh(c)))},addSelectedEdges:a=>{let{multiSelectionActive:b,edgeLookup:c,nodeLookup:d,triggerNodeChanges:e,triggerEdgeChanges:f}=o();b?f(a.map(a=>eg(a,!0))):(f(eh(c,new Set([...a]))),e(eh(d,new Set,!0)))},unselectNodesAndEdges:({nodes:a,edges:b}={})=>{let{edges:c,nodes:d,nodeLookup:e,triggerNodeChanges:f,triggerEdgeChanges:g}=o(),h=(a||d).map(a=>{let b=e.get(a.id);return b&&(b.selected=!1),eg(a.id,!1)}),i=(b||c).map(a=>eg(a.id,!1));f(h),g(i)},setMinZoom:a=>{let{panZoom:b,maxZoom:c}=o();b?.setScaleExtent([a,c]),n({minZoom:a})},setMaxZoom:a=>{let{panZoom:b,minZoom:c}=o();b?.setScaleExtent([c,a]),n({maxZoom:a})},setTranslateExtent:a=>{o().panZoom?.setTranslateExtent(a),n({translateExtent:a})},resetSelectedElements:()=>{let{edges:a,nodes:b,triggerNodeChanges:c,triggerEdgeChanges:d,elementsSelectable:e}=o();if(!e)return;let f=b.reduce((a,b)=>b.selected?[...a,eg(b.id,!1)]:a,[]),g=a.reduce((a,b)=>b.selected?[...a,eg(b.id,!1)]:a,[]);c(f),d(g)},setNodeExtent:a=>{let{nodes:b,nodeLookup:c,parentLookup:d,nodeOrigin:e,elevateNodesOnSelect:f,nodeExtent:g,zIndexMode:h}=o();(a[0][0]!==g[0][0]||a[0][1]!==g[0][1]||a[1][0]!==g[1][0]||a[1][1]!==g[1][1])&&(db(b,c,d,{nodeOrigin:e,nodeExtent:a,elevateNodesOnSelect:f,checkEquality:!1,zIndexMode:h}),n({nodeExtent:a}))},panBy:a=>{let{transform:b,width:c,height:d,panZoom:e,translateExtent:f}=o();return df({delta:a,panZoom:e,transform:b,translateExtent:f,width:c,height:d})},setCenter:async(a,b,c)=>{let{width:d,height:e,maxZoom:f,panZoom:g}=o();if(!g)return Promise.resolve(!1);let h=void 0!==c?.zoom?c.zoom:f;return await g.setViewport({x:d/2-a*h,y:e/2-b*h,zoom:h},{duration:c?.duration,ease:c?.ease,interpolate:c?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{n({connection:{...ca}})},updateConnection:a=>{n({connection:a})},reset:()=>n({...fD()})}},o=Object.is,n?dK(n,o):dK})({nodes:a,edges:b,defaultNodes:c,defaultEdges:d,width:e,height:f,fitView:j,minZoom:g,maxZoom:h,fitViewOptions:i,nodeOrigin:k,nodeExtent:l,zIndexMode:m}));return(0,s.jsx)(dN,{value:o,children:(0,s.jsx)(ep,{children:n})})}function fF({children:a,nodes:b,edges:c,defaultNodes:d,defaultEdges:e,width:f,height:g,fitView:h,fitViewOptions:i,minZoom:j,maxZoom:k,nodeOrigin:l,nodeExtent:m,zIndexMode:n}){return(0,t.useContext)(dM)?(0,s.jsx)(s.Fragment,{children:a}):(0,s.jsx)(fE,{initialNodes:b,initialEdges:c,defaultNodes:d,defaultEdges:e,initialWidth:f,initialHeight:g,fitView:h,initialFitViewOptions:i,initialMinZoom:j,initialMaxZoom:k,nodeOrigin:l,nodeExtent:m,zIndexMode:n,children:a})}let fG={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var fH=el(function({nodes:a,edges:b,defaultNodes:c,defaultEdges:d,className:e,nodeTypes:f,edgeTypes:g,onNodeClick:h,onEdgeClick:i,onInit:j,onMove:k,onMoveStart:o,onMoveEnd:p,onConnect:q,onConnectStart:r,onConnectEnd:u,onClickConnectStart:w,onClickConnectEnd:x,onNodeMouseEnter:y,onNodeMouseMove:z,onNodeMouseLeave:A,onNodeContextMenu:B,onNodeDoubleClick:C,onNodeDragStart:D,onNodeDrag:E,onNodeDragStop:F,onNodesDelete:G,onEdgesDelete:H,onDelete:I,onSelectionChange:J,onSelectionDragStart:K,onSelectionDrag:L,onSelectionDragStop:M,onSelectionContextMenu:N,onSelectionStart:O,onSelectionEnd:P,onBeforeDelete:Q,connectionMode:R,connectionLineType:S=n.Bezier,connectionLineStyle:T,connectionLineComponent:U,connectionLineContainerStyle:V,deleteKeyCode:W="Backspace",selectionKeyCode:X="Shift",selectionOnDrag:Y=!1,selectionMode:Z=m.Full,panActivationKeyCode:$="Space",multiSelectionKeyCode:_=cF()?"Meta":"Control",zoomActivationKeyCode:aa=cF()?"Meta":"Control",snapToGrid:ab,snapGrid:ac,onlyRenderVisibleElements:ad=!1,selectNodesOnDrag:ae,nodesDraggable:af,autoPanOnNodeFocus:ag,nodesConnectable:ah,nodesFocusable:ai,nodeOrigin:aj=d5,edgesFocusable:ak,edgesReconnectable:al,elementsSelectable:am=!0,defaultViewport:an=d6,minZoom:ao=.5,maxZoom:ap=2,translateExtent:aq=b7,preventScrolling:ar=!0,nodeExtent:as,defaultMarkerColor:at="#b1b1b7",zoomOnScroll:au=!0,zoomOnPinch:av=!0,panOnScroll:aw=!1,panOnScrollSpeed:ax=.5,panOnScrollMode:ay=l.Free,zoomOnDoubleClick:az=!0,panOnDrag:aA=!0,onPaneClick:aB,onPaneMouseEnter:aC,onPaneMouseMove:aD,onPaneMouseLeave:aE,onPaneScroll:aF,onPaneContextMenu:aG,paneClickDistance:aH=1,nodeClickDistance:aI=0,children:aJ,onReconnect:aK,onReconnectStart:aL,onReconnectEnd:aM,onEdgeContextMenu:aN,onEdgeDoubleClick:aO,onEdgeMouseEnter:aP,onEdgeMouseMove:aQ,onEdgeMouseLeave:aR,reconnectRadius:aS=10,onNodesChange:aT,onEdgesChange:aU,noDragClassName:aV="nodrag",noWheelClassName:aW="nowheel",noPanClassName:aX="nopan",fitView:aY,fitViewOptions:aZ,connectOnClick:a$,attributionPosition:a_,proOptions:a0,defaultEdgeOptions:a1,elevateNodesOnSelect:a2=!0,elevateEdgesOnSelect:a3=!1,disableKeyboardA11y:a4=!1,autoPanOnConnect:a5,autoPanOnNodeDrag:a6,autoPanSpeed:a7,connectionRadius:a8,isValidConnection:a9,onError:ba,style:bb,id:bc,nodeDragThreshold:bd,connectionDragThreshold:be,viewport:bf,onViewportChange:bg,width:bh,height:bi,colorMode:bj="light",debug:bk,onScroll:bl,ariaLabelConfig:bm,zIndexMode:bn="basic",...bo},bp){let bq=bc||"1",br=function(a){let[b,c]=(0,t.useState)("system"===a?null:a);return(0,t.useEffect)(()=>"system"!==a?void c(a):(c("light"),()=>{}),[a]),null!==b?b:"light"}(bj),bs=(0,t.useCallback)(a=>{a.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),bl?.(a)},[bl]);return(0,s.jsx)("div",{"data-testid":"rf__wrapper",...bo,onScroll:bs,style:{...bb,...fG},ref:bp,className:v(["react-flow",e,br]),id:bc,role:"application",children:(0,s.jsxs)(fF,{nodes:a,edges:b,width:bh,height:bi,fitView:aY,fitViewOptions:aZ,minZoom:ao,maxZoom:ap,nodeOrigin:aj,nodeExtent:as,zIndexMode:bn,children:[(0,s.jsx)(fC,{onInit:j,onNodeClick:h,onEdgeClick:i,onNodeMouseEnter:y,onNodeMouseMove:z,onNodeMouseLeave:A,onNodeContextMenu:B,onNodeDoubleClick:C,nodeTypes:f,edgeTypes:g,connectionLineType:S,connectionLineStyle:T,connectionLineComponent:U,connectionLineContainerStyle:V,selectionKeyCode:X,selectionOnDrag:Y,selectionMode:Z,deleteKeyCode:W,multiSelectionKeyCode:_,panActivationKeyCode:$,zoomActivationKeyCode:aa,onlyRenderVisibleElements:ad,defaultViewport:an,translateExtent:aq,minZoom:ao,maxZoom:ap,preventScrolling:ar,zoomOnScroll:au,zoomOnPinch:av,zoomOnDoubleClick:az,panOnScroll:aw,panOnScrollSpeed:ax,panOnScrollMode:ay,panOnDrag:aA,onPaneClick:aB,onPaneMouseEnter:aC,onPaneMouseMove:aD,onPaneMouseLeave:aE,onPaneScroll:aF,onPaneContextMenu:aG,paneClickDistance:aH,nodeClickDistance:aI,onSelectionContextMenu:N,onSelectionStart:O,onSelectionEnd:P,onReconnect:aK,onReconnectStart:aL,onReconnectEnd:aM,onEdgeContextMenu:aN,onEdgeDoubleClick:aO,onEdgeMouseEnter:aP,onEdgeMouseMove:aQ,onEdgeMouseLeave:aR,reconnectRadius:aS,defaultMarkerColor:at,noDragClassName:aV,noWheelClassName:aW,noPanClassName:aX,rfId:bq,disableKeyboardA11y:a4,nodeExtent:as,viewport:bf,onViewportChange:bg}),(0,s.jsx)(ea,{nodes:a,edges:b,defaultNodes:c,defaultEdges:d,onConnect:q,onConnectStart:r,onConnectEnd:u,onClickConnectStart:w,onClickConnectEnd:x,nodesDraggable:af,autoPanOnNodeFocus:ag,nodesConnectable:ah,nodesFocusable:ai,edgesFocusable:ak,edgesReconnectable:al,elementsSelectable:am,elevateNodesOnSelect:a2,elevateEdgesOnSelect:a3,minZoom:ao,maxZoom:ap,nodeExtent:as,onNodesChange:aT,onEdgesChange:aU,snapToGrid:ab,snapGrid:ac,connectionMode:R,translateExtent:aq,connectOnClick:a$,defaultEdgeOptions:a1,fitView:aY,fitViewOptions:aZ,onNodesDelete:G,onEdgesDelete:H,onDelete:I,onNodeDragStart:D,onNodeDrag:E,onNodeDragStop:F,onSelectionDrag:L,onSelectionDragStart:K,onSelectionDragStop:M,onMove:k,onMoveStart:o,onMoveEnd:p,noPanClassName:aX,nodeOrigin:aj,rfId:bq,autoPanOnConnect:a5,autoPanOnNodeDrag:a6,autoPanSpeed:a7,onError:ba,connectionRadius:a8,isValidConnection:a9,selectNodesOnDrag:ae,nodeDragThreshold:bd,connectionDragThreshold:be,onBeforeDelete:Q,debug:bk,ariaLabelConfig:bm,zIndexMode:bn}),(0,s.jsx)(d4,{onSelectionChange:J}),aJ,(0,s.jsx)(d$,{proOptions:a0,position:a_}),(0,s.jsx)(dY,{rfId:bq,disableKeyboardA11y:a4})]})})});function fI({dimensions:a,lineWidth:b,variant:c,className:d}){return(0,s.jsx)("path",{strokeWidth:b,d:`M${a[0]/2} 0 V${a[1]} M0 ${a[1]/2} H${a[0]}`,className:v(["react-flow__background-pattern",c,d])})}function fJ({radius:a,className:b}){return(0,s.jsx)("circle",{cx:a,cy:a,r:a,className:v(["react-flow__background-pattern","dots",b])})}(i=r||(r={})).Lines="lines",i.Dots="dots",i.Cross="cross";let fK={[r.Dots]:1,[r.Lines]:1,[r.Cross]:6},fL=a=>({transform:a.transform,patternId:`pattern-${a.rfId}`});function fM({id:a,variant:b=r.Dots,gap:c=20,size:d,lineWidth:e=1,offset:f=0,color:g,bgColor:h,style:i,className:j,patternClassName:k}){let l=(0,t.useRef)(null),{transform:m,patternId:n}=dP(fL,dL),o=d||fK[b],p=b===r.Dots,q=b===r.Cross,u=Array.isArray(c)?c:[c,c],w=[u[0]*m[2]||1,u[1]*m[2]||1],x=o*m[2],y=Array.isArray(f)?f:[f,f],z=q?[x,x]:w,A=[y[0]*m[2]||1+z[0]/2,y[1]*m[2]||1+z[1]/2],B=`${n}${a||""}`;return(0,s.jsxs)("svg",{className:v(["react-flow__background",j]),style:{...i,...eu,"--xy-background-color-props":h,"--xy-background-pattern-color-props":g},ref:l,"data-testid":"rf__background",children:[(0,s.jsx)("pattern",{id:B,x:m[0]%w[0],y:m[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${A[0]},-${A[1]})`,children:p?(0,s.jsx)(fJ,{radius:x/2,className:k}):(0,s.jsx)(fI,{dimensions:z,lineWidth:e,variant:b,className:k})}),(0,s.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${B})`})]})}fM.displayName="Background";let fN=(0,t.memo)(fM);function fO(){return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,s.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function fP(){return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,s.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function fQ(){return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,s.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function fR(){return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,s.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function fS(){return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,s.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function fT({children:a,className:b,...c}){return(0,s.jsx)("button",{type:"button",className:v(["react-flow__controls-button",b]),...c,children:a})}let fU=a=>({isInteractive:a.nodesDraggable||a.nodesConnectable||a.elementsSelectable,minZoomReached:a.transform[2]<=a.minZoom,maxZoomReached:a.transform[2]>=a.maxZoom,ariaLabelConfig:a.ariaLabelConfig});function fV({style:a,showZoom:b=!0,showFitView:c=!0,showInteractive:d=!0,fitViewOptions:e,onZoomIn:f,onZoomOut:g,onFitView:h,onInteractiveChange:i,className:j,children:k,position:l="bottom-left",orientation:m="vertical","aria-label":n}){let o=dQ(),{isInteractive:p,minZoomReached:q,maxZoomReached:r,ariaLabelConfig:t}=dP(fU,dL),{zoomIn:u,zoomOut:w,fitView:x}=er();return(0,s.jsxs)(dZ,{className:v(["react-flow__controls","horizontal"===m?"horizontal":"vertical",j]),position:l,style:a,"data-testid":"rf__controls","aria-label":n??t["controls.ariaLabel"],children:[b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(fT,{onClick:()=>{u(),f?.()},className:"react-flow__controls-zoomin",title:t["controls.zoomIn.ariaLabel"],"aria-label":t["controls.zoomIn.ariaLabel"],disabled:r,children:(0,s.jsx)(fO,{})}),(0,s.jsx)(fT,{onClick:()=>{w(),g?.()},className:"react-flow__controls-zoomout",title:t["controls.zoomOut.ariaLabel"],"aria-label":t["controls.zoomOut.ariaLabel"],disabled:q,children:(0,s.jsx)(fP,{})})]}),c&&(0,s.jsx)(fT,{className:"react-flow__controls-fitview",onClick:()=>{x(e),h?.()},title:t["controls.fitView.ariaLabel"],"aria-label":t["controls.fitView.ariaLabel"],children:(0,s.jsx)(fQ,{})}),d&&(0,s.jsx)(fT,{className:"react-flow__controls-interactive",onClick:()=>{o.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),i?.(!p)},title:t["controls.interactive.ariaLabel"],"aria-label":t["controls.interactive.ariaLabel"],children:p?(0,s.jsx)(fS,{}):(0,s.jsx)(fR,{})}),k]})}fV.displayName="Controls",(0,t.memo)(fV);let fW=(0,t.memo)(function({id:a,x:b,y:c,width:d,height:e,style:f,color:g,strokeColor:h,strokeWidth:i,className:j,borderRadius:k,shapeRendering:l,selected:m,onClick:n}){let{background:o,backgroundColor:p}=f||{};return(0,s.jsx)("rect",{className:v(["react-flow__minimap-node",{selected:m},j]),x:b,y:c,rx:k,ry:k,width:d,height:e,style:{fill:g||o||p,stroke:h,strokeWidth:i},shapeRendering:l,onClick:n?b=>n(b,a):void 0})}),fX=a=>a.nodes.map(a=>a.id),fY=a=>a instanceof Function?a:()=>a,fZ=(0,t.memo)(function({id:a,nodeColorFunc:b,nodeStrokeColorFunc:c,nodeClassNameFunc:d,nodeBorderRadius:e,nodeStrokeWidth:f,shapeRendering:g,NodeComponent:h,onClick:i}){let{node:j,x:k,y:l,width:m,height:n}=dP(b=>{let{internals:c}=b.nodeLookup.get(a),d=c.userNode,{x:e,y:f}=c.positionAbsolute,{width:g,height:h}=cH(d);return{node:d,x:e,y:f,width:g,height:h}},dL);return j&&!j.hidden&&cI(j)?(0,s.jsx)(h,{x:k,y:l,width:m,height:n,style:j.style,selected:!!j.selected,className:d(j),color:b(j),borderRadius:e,strokeColor:c(j),strokeWidth:f,shapeRendering:g,onClick:i,id:j.id}):null});var f$=(0,t.memo)(function({nodeStrokeColor:a,nodeColor:b,nodeClassName:c="",nodeBorderRadius:d=5,nodeStrokeWidth:e,nodeComponent:f=fW,onClick:g}){let h=dP(fX,dL),i=fY(b),j=fY(a),k=fY(c);return(0,s.jsx)(s.Fragment,{children:h.map(a=>(0,s.jsx)(fZ,{id:a,nodeColorFunc:i,nodeStrokeColorFunc:j,nodeClassNameFunc:k,nodeBorderRadius:d,nodeStrokeWidth:e,NodeComponent:f,onClick:g,shapeRendering:"crispEdges"},a))})});let f_=a=>!a.hidden,f0=a=>{let b={x:-a.transform[0]/a.transform[2],y:-a.transform[1]/a.transform[2],width:a.width/a.transform[2],height:a.height/a.transform[2]};return{viewBB:b,boundingRect:a.nodeLookup.size>0?cv(cg(a.nodeLookup,{filter:f_}),b):b,rfId:a.rfId,panZoom:a.panZoom,translateExtent:a.translateExtent,flowWidth:a.width,flowHeight:a.height,ariaLabelConfig:a.ariaLabelConfig}};function f1({style:a,className:b,nodeStrokeColor:c,nodeColor:d,nodeClassName:e="",nodeBorderRadius:f=5,nodeStrokeWidth:g,nodeComponent:h,bgColor:i,maskColor:j,maskStrokeColor:k,maskStrokeWidth:l,position:m="bottom-right",onClick:n,onNodeClick:o,pannable:p=!1,zoomable:q=!1,ariaLabel:r,inversePan:u,zoomStep:w=1,offsetScale:x=5}){let y=dQ(),z=(0,t.useRef)(null),{boundingRect:A,viewBB:B,rfId:C,panZoom:D,translateExtent:E,flowWidth:F,flowHeight:G,ariaLabelConfig:H}=dP(f0,dL),I=a?.width??200,J=a?.height??150,K=Math.max(A.width/I,A.height/J),L=K*I,M=K*J,N=x*K,O=A.x-(L-A.width)/2-N,P=A.y-(M-A.height)/2-N,Q=L+2*N,R=M+2*N,S=`react-flow__minimap-desc-${C}`,T=(0,t.useRef)(0),U=(0,t.useRef)();T.current=K,(0,t.useEffect)(()=>{if(z.current&&D)return U.current=function({domNode:a,panZoom:b,getTransform:c,getViewScale:d}){let e=an(a);return{update:function({translateExtent:a,width:f,height:g,zoomStep:h=1,pannable:i=!0,zoomable:j=!0,inversePan:k=!1}){let l=[0,0],m=b5().on("start",a=>{("mousedown"===a.sourceEvent.type||"touchstart"===a.sourceEvent.type)&&(l=[a.sourceEvent.clientX??a.sourceEvent.touches[0].clientX,a.sourceEvent.clientY??a.sourceEvent.touches[0].clientY])}).on("zoom",i?e=>{let h=c();if("mousemove"!==e.sourceEvent.type&&"touchmove"!==e.sourceEvent.type||!b)return;let i=[e.sourceEvent.clientX??e.sourceEvent.touches[0].clientX,e.sourceEvent.clientY??e.sourceEvent.touches[0].clientY],j=[i[0]-l[0],i[1]-l[1]];l=i;let m=d()*Math.max(h[2],Math.log(h[2]))*(k?-1:1),n={x:h[0]-j[0]*m,y:h[1]-j[1]*m};b.setViewportConstrained({x:n.x,y:n.y,zoom:h[2]},[[0,0],[f,g]],a)}:null).on("zoom.wheel",j?a=>{if("wheel"!==a.sourceEvent.type||!b)return;let d=c(),e=a.sourceEvent.ctrlKey&&cF()?10:1,f=-a.sourceEvent.deltaY*(1===a.sourceEvent.deltaMode?.05:a.sourceEvent.deltaMode?1:.002)*h,g=d[2]*Math.pow(2,f*e);b.scaleTo(g)}:null);e.call(m,{})},destroy:function(){e.on("zoom",null)},pointer:ao}}({domNode:z.current,panZoom:D,getTransform:()=>y.getState().transform,getViewScale:()=>T.current}),()=>{U.current?.destroy()}},[D]),(0,t.useEffect)(()=>{U.current?.update({translateExtent:E,width:F,height:G,inversePan:u,pannable:p,zoomStep:w,zoomable:q})},[p,q,u,w,E,F,G]);let V=n?a=>{let[b,c]=U.current?.pointer(a)||[0,0];n(a,{x:b,y:c})}:void 0,W=o?(0,t.useCallback)((a,b)=>{o(a,y.getState().nodeLookup.get(b).internals.userNode)},[]):void 0,X=r??H["minimap.ariaLabel"];return(0,s.jsx)(dZ,{position:m,style:{...a,"--xy-minimap-background-color-props":"string"==typeof i?i:void 0,"--xy-minimap-mask-background-color-props":"string"==typeof j?j:void 0,"--xy-minimap-mask-stroke-color-props":"string"==typeof k?k:void 0,"--xy-minimap-mask-stroke-width-props":"number"==typeof l?l*K:void 0,"--xy-minimap-node-background-color-props":"string"==typeof d?d:void 0,"--xy-minimap-node-stroke-color-props":"string"==typeof c?c:void 0,"--xy-minimap-node-stroke-width-props":"number"==typeof g?g:void 0},className:v(["react-flow__minimap",b]),"data-testid":"rf__minimap",children:(0,s.jsxs)("svg",{width:I,height:J,viewBox:`${O} ${P} ${Q} ${R}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":S,ref:z,onClick:V,children:[X&&(0,s.jsx)("title",{id:S,children:X}),(0,s.jsx)(f$,{onClick:W,nodeColor:d,nodeStrokeColor:c,nodeBorderRadius:f,nodeClassName:e,nodeStrokeWidth:g,nodeComponent:h}),(0,s.jsx)("path",{className:"react-flow__minimap-mask",d:`M${O-N},${P-N}h${Q+2*N}v${R+2*N}h${-Q-2*N}z
        M${B.x},${B.y}h${B.width}v${B.height}h${-B.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}f1.displayName="MiniMap",(0,t.memo)(f1);let f2={[q.Line]:"right",[q.Handle]:"bottom-right"};(0,t.memo)(function({nodeId:a,position:b,variant:c=q.Handle,className:d,style:e,children:f,color:g,minWidth:h=10,minHeight:i=10,maxWidth:j=Number.MAX_VALUE,maxHeight:k=Number.MAX_VALUE,keepAspectRatio:l=!1,resizeDirection:m,autoScale:n=!0,shouldResize:o,onResizeStart:p,onResize:r,onResizeEnd:u}){let w,x=eH(),y="string"==typeof a?a:x,z=dQ(),A=(0,t.useRef)(null),B=c===q.Handle,C=dP((0,t.useCallback)((w=B&&n,a=>w?`${Math.max(1/a.transform[2],1)}`:void 0),[B,n]),dL),D=(0,t.useRef)(null),E=b??f2[c];(0,t.useEffect)(()=>{if(A.current&&y)return D.current||(D.current=function({domNode:a,nodeId:b,getStoreItems:c,onChange:d,onEnd:e}){let f=an(a),g={controlDirection:dx("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};return{update:function({controlPosition:a,boundaries:h,keepAspectRatio:i,resizeDirection:j,onResizeStart:k,onResize:l,onResizeEnd:m,shouldResize:n}){let o,p,q,r,s={...dB},t={...dC};g={boundaries:h,resizeDirection:j,keepAspectRatio:i,controlDirection:dx(a)};let u=null,v=[],w=!1,x=aB().on("start",a=>{let{nodeLookup:d,transform:e,snapGrid:f,snapToGrid:g,nodeOrigin:h,paneDomNode:i}=c();if(!(o=d.get(b)))return;u=i?.getBoundingClientRect()??null;let{xSnapped:j,ySnapped:l}=cL(a.sourceEvent,{transform:e,snapGrid:f,snapToGrid:g,containerBounds:u});if(t={...s={width:o.measured.width??0,height:o.measured.height??0,x:o.position.x??0,y:o.position.y??0},pointerX:j,pointerY:l,aspectRatio:s.width/s.height},p=void 0,o.parentId&&("parent"===o.extent||o.expandParent)){var m;q=(p=d.get(o.parentId))&&"parent"===o.extent?[[0,0],[(m=p).measured.width,m.measured.height]]:void 0}for(let[a,c]of(v=[],r=void 0,d))if(c.parentId===b&&(v.push({id:a,position:{...c.position},extent:c.extent}),"parent"===c.extent||c.expandParent)){let a=function(a,b,c){let d=b.position.x+a.position.x,e=b.position.y+a.position.y,f=a.measured.width??0,g=a.measured.height??0,h=c[0]*f,i=c[1]*g;return[[d-h,e-i],[d+f-h,e+g-i]]}(c,o,c.origin??h);r=r?[[Math.min(a[0][0],r[0][0]),Math.min(a[0][1],r[0][1])],[Math.max(a[1][0],r[1][0]),Math.max(a[1][1],r[1][1])]]:a}k?.(a,{...s})}).on("drag",a=>{let{transform:b,snapGrid:e,snapToGrid:f,nodeOrigin:h}=c(),i=cL(a.sourceEvent,{transform:b,snapGrid:e,snapToGrid:f,containerBounds:u}),j=[];if(!o)return;let{x:k,y:m,width:x,height:y}=s,z={},A=o.origin??h,{width:B,height:C,x:D,y:E}=function(a,b,c,d,e,f,g,h){var i,j,k,l;let{affectsX:m,affectsY:n}=b,{isHorizontal:o,isVertical:p}=b,q=o&&p,{xSnapped:r,ySnapped:s}=c,{minWidth:t,maxWidth:u,minHeight:v,maxHeight:w}=d,{x:x,y:y,width:z,height:A,aspectRatio:B}=a,C=Math.floor(o?r-a.pointerX:0),D=Math.floor(p?s-a.pointerY:0),E=z+(m?-C:C),F=A+(n?-D:D),G=-f[0]*z,H=-f[1]*A,I=dA(E,t,u),J=dA(F,v,w);if(g){let a=0,b=0;m&&C<0?a=dy(x+C+G,g[0][0]):!m&&C>0&&(a=dz(x+E+G,g[1][0])),n&&D<0?b=dy(y+D+H,g[0][1]):!n&&D>0&&(b=dz(y+F+H,g[1][1])),I=Math.max(I,a),J=Math.max(J,b)}if(h){let a=0,b=0;m&&C>0?a=dz(x+C,h[0][0]):!m&&C<0&&(a=dy(x+E,h[1][0])),n&&D>0?b=dz(y+D,h[0][1]):!n&&D<0&&(b=dy(y+F,h[1][1])),I=Math.max(I,a),J=Math.max(J,b)}if(e){if(o){(I=Math.max(I,dA(E/B,v,w)*B),g)&&(I=Math.max(I,(m||n)&&(!m||n||!q)?dy(y+H+(m?C:-C)/B,g[0][1])*B:dz(y+H+E/B,g[1][1])*B));h&&(I=Math.max(I,(m||n)&&(!m||n||!q)?dz(y+(m?C:-C)/B,h[0][1])*B:dy(y+E/B,h[1][1])*B))}if(p){(J=Math.max(J,dA(F*B,t,u)/B),g)&&(J=Math.max(J,(m||n)&&(!n||m||!q)?dy(x+(n?D:-D)*B+G,g[0][0])/B:dz(x+F*B+G,g[1][0])/B));h&&(J=Math.max(J,(m||n)&&(!n||m||!q)?dz(x+(n?D:-D)*B,h[0][0])/B:dy(x+F*B,h[1][0])/B))}}D+=D<0?J:-J,C+=C<0?I:-I,e&&(q?E>F*B?D=((i=m,j=n,i?!j:j)?-C:C)/B:C=((k=m,l=n,k?!l:l)?-D:D)*B:o?(D=C/B,n=m):(C=D*B,m=n));let K=m?x+C:x,L=n?y+D:y;return{width:z+(m?-C:C),height:A+(n?-D:D),x:f[0]*C*(m?-1:1)+K,y:f[1]*D*(n?-1:1)+L}}(t,g.controlDirection,i,g.boundaries,g.keepAspectRatio,A,q,r),F=B!==x,G=C!==y,H=D!==k&&F,I=E!==m&&G;if(!H&&!I&&!F&&!G)return;if((H||I||1===A[0]||1===A[1])&&(z.x=H?D:s.x,z.y=I?E:s.y,s.x=z.x,s.y=z.y,v.length>0)){let a=D-k,b=E-m;for(let c of v)c.position={x:c.position.x-a+A[0]*(B-x),y:c.position.y-b+A[1]*(C-y)},j.push(c)}if((F||G)&&(z.width=F&&(!g.resizeDirection||"horizontal"===g.resizeDirection)?B:s.width,z.height=G&&(!g.resizeDirection||"vertical"===g.resizeDirection)?C:s.height,s.width=z.width,s.height=z.height),p&&o.expandParent){let a=A[0]*(z.width??0);z.x&&z.x<a&&(s.x=a,t.x=t.x-(z.x-a));let b=A[1]*(z.height??0);z.y&&z.y<b&&(s.y=b,t.y=t.y-(z.y-b))}let J=function({width:a,prevWidth:b,height:c,prevHeight:d,affectsX:e,affectsY:f}){let g=a-b,h=c-d,i=[g>0?1:g<0?-1:0,h>0?1:h<0?-1:0];return g&&e&&(i[0]=-1*i[0]),h&&f&&(i[1]=-1*i[1]),i}({width:s.width,prevWidth:x,height:s.height,prevHeight:y,affectsX:g.controlDirection.affectsX,affectsY:g.controlDirection.affectsY}),K={...s,direction:J};!1!==n?.(a,K)&&(w=!0,l?.(a,K),d(z,j))}).on("end",a=>{w&&(m?.(a,{...s}),e?.({...s}),w=!1)});f.call(x)},destroy:function(){f.on(".drag",null)}}}({domNode:A.current,nodeId:y,getStoreItems:()=>{let{nodeLookup:a,transform:b,snapGrid:c,snapToGrid:d,nodeOrigin:e,domNode:f}=z.getState();return{nodeLookup:a,transform:b,snapGrid:c,snapToGrid:d,nodeOrigin:e,paneDomNode:f}},onChange:(a,b)=>{let{triggerNodeChanges:c,nodeLookup:d,parentLookup:e,nodeOrigin:f}=z.getState(),g=[],h={x:a.x,y:a.y},i=d.get(y);if(i&&i.expandParent&&i.parentId){let b=i.origin??f,c=a.width??i.measured.width??0,j=a.height??i.measured.height??0,k=de([{id:i.id,parentId:i.parentId,rect:{width:c,height:j,...cJ({x:a.x??i.position.x,y:a.y??i.position.y},{width:c,height:j},i.parentId,d,b)}}],d,e,f);g.push(...k),h.x=a.x?Math.max(b[0]*c,a.x):void 0,h.y=a.y?Math.max(b[1]*j,a.y):void 0}if(void 0!==h.x&&void 0!==h.y){let a={id:y,type:"position",position:{...h}};g.push(a)}if(void 0!==a.width&&void 0!==a.height){let b={id:y,type:"dimensions",resizing:!0,setAttributes:!m||("horizontal"===m?"width":"height"),dimensions:{width:a.width,height:a.height}};g.push(b)}for(let a of b){let b={...a,type:"position"};g.push(b)}c(g)},onEnd:({width:a,height:b})=>{z.getState().triggerNodeChanges([{id:y,type:"dimensions",resizing:!1,dimensions:{width:a,height:b}}])}})),D.current.update({controlPosition:E,boundaries:{minWidth:h,minHeight:i,maxWidth:j,maxHeight:k},keepAspectRatio:l,resizeDirection:m,onResizeStart:p,onResize:r,onResizeEnd:u,shouldResize:o}),()=>{D.current?.destroy()}},[E,h,i,j,k,l,p,r,u,o]);let F=E.split("-");return(0,s.jsx)("div",{className:v(["react-flow__resize-control","nodrag",...F,c,d]),ref:A,style:{...e,scale:C,...g&&{[B?"backgroundColor":"borderColor"]:g}},children:f})});var f3=a.i(46271),f4=a.i(62036),f5=a.i(60137);let f6=(0,f5.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),f7=(0,f5.default)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),f8=(0,f5.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),f9=(0,f5.default)("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),ga=(0,f5.default)("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]),gb=(0,f5.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),gc=(0,f5.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),gd=(0,f5.default)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ge=(0,f5.default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);var gf=a.i(8406);let gg=(0,f5.default)("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);var gh=a.i(33508);let gi=(0,f5.default)("file-input",[["path",{d:"M4 11V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.706.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-1",key:"1q9hii"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]),gj=(0,f5.default)("file-output",[["path",{d:"M4.226 20.925A2 2 0 0 0 6 22h12a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v3.127",key:"wfxp4w"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]]),gk=(0,f5.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var gl=a.i(54347);let gm=(0,f5.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),gn=(0,f5.default)("workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),go=(a=new Map,b=null,c)=>({nextPart:a,validators:b,classGroupId:c}),gp=[],gq=(a,b,c)=>{if(0==a.length-b)return c.classGroupId;let d=a[b],e=c.nextPart.get(d);if(e){let c=gq(a,b+1,e);if(c)return c}let f=c.validators;if(null===f)return;let g=0===b?a.join("-"):a.slice(b).join("-"),h=f.length;for(let a=0;a<h;a++){let b=f[a];if(b.validator(g))return b.classGroupId}},gr=(a,b)=>{let c=go();for(let d in a)gs(a[d],c,d,b);return c},gs=(a,b,c,d)=>{let e=a.length;for(let f=0;f<e;f++)gt(a[f],b,c,d)},gt=(a,b,c,d)=>{"string"==typeof a?gu(a,b,c):"function"==typeof a?gv(a,b,c,d):gw(a,b,c,d)},gu=(a,b,c)=>{(""===a?b:gx(b,a)).classGroupId=c},gv=(a,b,c,d)=>{gy(a)?gs(a(d),b,c,d):(null===b.validators&&(b.validators=[]),b.validators.push({classGroupId:c,validator:a}))},gw=(a,b,c,d)=>{let e=Object.entries(a),f=e.length;for(let a=0;a<f;a++){let[f,g]=e[a];gs(g,gx(b,f),c,d)}},gx=(a,b)=>{let c=a,d=b.split("-"),e=d.length;for(let a=0;a<e;a++){let b=d[a],e=c.nextPart.get(b);e||(e=go(),c.nextPart.set(b,e)),c=e}return c},gy=a=>"isThemeGetter"in a&&!0===a.isThemeGetter,gz=[],gA=(a,b,c,d,e)=>({modifiers:a,hasImportantModifier:b,baseClassName:c,maybePostfixModifierPosition:d,isExternal:e}),gB=/\s+/,gC=a=>{let b;if("string"==typeof a)return a;let c="";for(let d=0;d<a.length;d++)a[d]&&(b=gC(a[d]))&&(c&&(c+=" "),c+=b);return c},gD=[],gE=a=>{let b=b=>b[a]||gD;return b.isThemeGetter=!0,b},gF=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,gG=/^\((?:(\w[\w-]*):)?(.+)\)$/i,gH=/^\d+\/\d+$/,gI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gJ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,gK=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,gL=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gM=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,gN=a=>gH.test(a),gO=a=>!!a&&!Number.isNaN(Number(a)),gP=a=>!!a&&Number.isInteger(Number(a)),gQ=a=>a.endsWith("%")&&gO(a.slice(0,-1)),gR=a=>gI.test(a),gS=()=>!0,gT=a=>gJ.test(a)&&!gK.test(a),gU=()=>!1,gV=a=>gL.test(a),gW=a=>gM.test(a),gX=a=>!gZ(a)&&!g3(a),gY=a=>ha(a,he,gU),gZ=a=>gF.test(a),g$=a=>ha(a,hf,gT),g_=a=>ha(a,hg,gO),g0=a=>ha(a,hc,gU),g1=a=>ha(a,hd,gW),g2=a=>ha(a,hi,gV),g3=a=>gG.test(a),g4=a=>hb(a,hf),g5=a=>hb(a,hh),g6=a=>hb(a,hc),g7=a=>hb(a,he),g8=a=>hb(a,hd),g9=a=>hb(a,hi,!0),ha=(a,b,c)=>{let d=gF.exec(a);return!!d&&(d[1]?b(d[1]):c(d[2]))},hb=(a,b,c=!1)=>{let d=gG.exec(a);return!!d&&(d[1]?b(d[1]):c)},hc=a=>"position"===a||"percentage"===a,hd=a=>"image"===a||"url"===a,he=a=>"length"===a||"size"===a||"bg-size"===a,hf=a=>"length"===a,hg=a=>"number"===a,hh=a=>"family-name"===a,hi=a=>"shadow"===a,hj=((a,...b)=>{let c,d,e,f,g=a=>{let b=d(a);if(b)return b;let f=((a,b)=>{let{parseClassName:c,getClassGroupId:d,getConflictingClassGroupIds:e,sortModifiers:f}=b,g=[],h=a.trim().split(gB),i="";for(let a=h.length-1;a>=0;a-=1){let b=h[a],{isExternal:j,modifiers:k,hasImportantModifier:l,baseClassName:m,maybePostfixModifierPosition:n}=c(b);if(j){i=b+(i.length>0?" "+i:i);continue}let o=!!n,p=d(o?m.substring(0,n):m);if(!p){if(!o||!(p=d(m))){i=b+(i.length>0?" "+i:i);continue}o=!1}let q=0===k.length?"":1===k.length?k[0]:f(k).join(":"),r=l?q+"!":q,s=r+p;if(g.indexOf(s)>-1)continue;g.push(s);let t=e(p,o);for(let a=0;a<t.length;++a){let b=t[a];g.push(r+b)}i=b+(i.length>0?" "+i:i)}return i})(a,c);return e(a,f),f};return f=h=>{var i;let j;return d=(c={cache:(a=>{if(a<1)return{get:()=>void 0,set:()=>{}};let b=0,c=Object.create(null),d=Object.create(null),e=(e,f)=>{c[e]=f,++b>a&&(b=0,d=c,c=Object.create(null))};return{get(a){let b=c[a];return void 0!==b?b:void 0!==(b=d[a])?(e(a,b),b):void 0},set(a,b){a in c?c[a]=b:e(a,b)}}})((i=b.reduce((a,b)=>b(a),a())).cacheSize),parseClassName:(a=>{let{prefix:b,experimentalParseClassName:c}=a,d=a=>{let b,c=[],d=0,e=0,f=0,g=a.length;for(let h=0;h<g;h++){let g=a[h];if(0===d&&0===e){if(":"===g){c.push(a.slice(f,h)),f=h+1;continue}if("/"===g){b=h;continue}}"["===g?d++:"]"===g?d--:"("===g?e++:")"===g&&e--}let h=0===c.length?a:a.slice(f),i=h,j=!1;return h.endsWith("!")?(i=h.slice(0,-1),j=!0):h.startsWith("!")&&(i=h.slice(1),j=!0),gA(c,j,i,b&&b>f?b-f:void 0)};if(b){let a=b+":",c=d;d=b=>b.startsWith(a)?c(b.slice(a.length)):gA(gz,!1,b,void 0,!0)}if(c){let a=d;d=b=>c({className:b,parseClassName:a})}return d})(i),sortModifiers:(j=new Map,i.orderSensitiveModifiers.forEach((a,b)=>{j.set(a,1e6+b)}),a=>{let b=[],c=[];for(let d=0;d<a.length;d++){let e=a[d],f="["===e[0],g=j.has(e);f||g?(c.length>0&&(c.sort(),b.push(...c),c=[]),b.push(e)):c.push(e)}return c.length>0&&(c.sort(),b.push(...c)),b}),...(a=>{let b=(a=>{let{theme:b,classGroups:c}=a;return gr(c,b)})(a),{conflictingClassGroups:c,conflictingClassGroupModifiers:d}=a;return{getClassGroupId:a=>{if(a.startsWith("[")&&a.endsWith("]")){var c;let b,d,e;return -1===(c=a).slice(1,-1).indexOf(":")?void 0:(d=(b=c.slice(1,-1)).indexOf(":"),(e=b.slice(0,d))?"arbitrary.."+e:void 0)}let d=a.split("-"),e=+(""===d[0]&&d.length>1);return gq(d,e,b)},getConflictingClassGroupIds:(a,b)=>{if(b){let b=d[a],e=c[a];if(b){if(e){let a=Array(e.length+b.length);for(let b=0;b<e.length;b++)a[b]=e[b];for(let c=0;c<b.length;c++)a[e.length+c]=b[c];return a}return b}return e||gp}return c[a]||gp}}})(i)}).cache.get,e=c.cache.set,f=g,g(h)},(...a)=>f(((...a)=>{let b,c,d=0,e="";for(;d<a.length;)(b=a[d++])&&(c=gC(b))&&(e&&(e+=" "),e+=c);return e})(...a))})(()=>{let a=gE("color"),b=gE("font"),c=gE("text"),d=gE("font-weight"),e=gE("tracking"),f=gE("leading"),g=gE("breakpoint"),h=gE("container"),i=gE("spacing"),j=gE("radius"),k=gE("shadow"),l=gE("inset-shadow"),m=gE("text-shadow"),n=gE("drop-shadow"),o=gE("blur"),p=gE("perspective"),q=gE("aspect"),r=gE("ease"),s=gE("animate"),t=()=>["auto","avoid","all","avoid-page","page","left","right","column"],u=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],v=()=>[...u(),g3,gZ],w=()=>["auto","hidden","clip","visible","scroll"],x=()=>["auto","contain","none"],y=()=>[g3,gZ,i],z=()=>[gN,"full","auto",...y()],A=()=>[gP,"none","subgrid",g3,gZ],B=()=>["auto",{span:["full",gP,g3,gZ]},gP,g3,gZ],C=()=>[gP,"auto",g3,gZ],D=()=>["auto","min","max","fr",g3,gZ],E=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],F=()=>["start","end","center","stretch","center-safe","end-safe"],G=()=>["auto",...y()],H=()=>[gN,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...y()],I=()=>[a,g3,gZ],J=()=>[...u(),g6,g0,{position:[g3,gZ]}],K=()=>["no-repeat",{repeat:["","x","y","space","round"]}],L=()=>["auto","cover","contain",g7,gY,{size:[g3,gZ]}],M=()=>[gQ,g4,g$],N=()=>["","none","full",j,g3,gZ],O=()=>["",gO,g4,g$],P=()=>["solid","dashed","dotted","double"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>[gO,gQ,g6,g0],S=()=>["","none",o,g3,gZ],T=()=>["none",gO,g3,gZ],U=()=>["none",gO,g3,gZ],V=()=>[gO,g3,gZ],W=()=>[gN,"full",...y()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[gR],breakpoint:[gR],color:[gS],container:[gR],"drop-shadow":[gR],ease:["in","out","in-out"],font:[gX],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[gR],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[gR],shadow:[gR],spacing:["px",gO],text:[gR],"text-shadow":[gR],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",gN,gZ,g3,q]}],container:["container"],columns:[{columns:[gO,gZ,g3,h]}],"break-after":[{"break-after":t()}],"break-before":[{"break-before":t()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:v()}],overflow:[{overflow:w()}],"overflow-x":[{"overflow-x":w()}],"overflow-y":[{"overflow-y":w()}],overscroll:[{overscroll:x()}],"overscroll-x":[{"overscroll-x":x()}],"overscroll-y":[{"overscroll-y":x()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:z()}],"inset-x":[{"inset-x":z()}],"inset-y":[{"inset-y":z()}],start:[{start:z()}],end:[{end:z()}],top:[{top:z()}],right:[{right:z()}],bottom:[{bottom:z()}],left:[{left:z()}],visibility:["visible","invisible","collapse"],z:[{z:[gP,"auto",g3,gZ]}],basis:[{basis:[gN,"full","auto",h,...y()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[gO,gN,"auto","initial","none",gZ]}],grow:[{grow:["",gO,g3,gZ]}],shrink:[{shrink:["",gO,g3,gZ]}],order:[{order:[gP,"first","last","none",g3,gZ]}],"grid-cols":[{"grid-cols":A()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":A()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":D()}],"auto-rows":[{"auto-rows":D()}],gap:[{gap:y()}],"gap-x":[{"gap-x":y()}],"gap-y":[{"gap-y":y()}],"justify-content":[{justify:[...E(),"normal"]}],"justify-items":[{"justify-items":[...F(),"normal"]}],"justify-self":[{"justify-self":["auto",...F()]}],"align-content":[{content:["normal",...E()]}],"align-items":[{items:[...F(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...F(),{baseline:["","last"]}]}],"place-content":[{"place-content":E()}],"place-items":[{"place-items":[...F(),"baseline"]}],"place-self":[{"place-self":["auto",...F()]}],p:[{p:y()}],px:[{px:y()}],py:[{py:y()}],ps:[{ps:y()}],pe:[{pe:y()}],pt:[{pt:y()}],pr:[{pr:y()}],pb:[{pb:y()}],pl:[{pl:y()}],m:[{m:G()}],mx:[{mx:G()}],my:[{my:G()}],ms:[{ms:G()}],me:[{me:G()}],mt:[{mt:G()}],mr:[{mr:G()}],mb:[{mb:G()}],ml:[{ml:G()}],"space-x":[{"space-x":y()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":y()}],"space-y-reverse":["space-y-reverse"],size:[{size:H()}],w:[{w:[h,"screen",...H()]}],"min-w":[{"min-w":[h,"screen","none",...H()]}],"max-w":[{"max-w":[h,"screen","none","prose",{screen:[g]},...H()]}],h:[{h:["screen","lh",...H()]}],"min-h":[{"min-h":["screen","lh","none",...H()]}],"max-h":[{"max-h":["screen","lh",...H()]}],"font-size":[{text:["base",c,g4,g$]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[d,g3,g_]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",gQ,gZ]}],"font-family":[{font:[g5,gZ,b]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[e,g3,gZ]}],"line-clamp":[{"line-clamp":[gO,"none",g3,g_]}],leading:[{leading:[f,...y()]}],"list-image":[{"list-image":["none",g3,gZ]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",g3,gZ]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:I()}],"text-color":[{text:I()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...P(),"wavy"]}],"text-decoration-thickness":[{decoration:[gO,"from-font","auto",g3,g$]}],"text-decoration-color":[{decoration:I()}],"underline-offset":[{"underline-offset":[gO,"auto",g3,gZ]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",g3,gZ]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",g3,gZ]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:J()}],"bg-repeat":[{bg:K()}],"bg-size":[{bg:L()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},gP,g3,gZ],radial:["",g3,gZ],conic:[gP,g3,gZ]},g8,g1]}],"bg-color":[{bg:I()}],"gradient-from-pos":[{from:M()}],"gradient-via-pos":[{via:M()}],"gradient-to-pos":[{to:M()}],"gradient-from":[{from:I()}],"gradient-via":[{via:I()}],"gradient-to":[{to:I()}],rounded:[{rounded:N()}],"rounded-s":[{"rounded-s":N()}],"rounded-e":[{"rounded-e":N()}],"rounded-t":[{"rounded-t":N()}],"rounded-r":[{"rounded-r":N()}],"rounded-b":[{"rounded-b":N()}],"rounded-l":[{"rounded-l":N()}],"rounded-ss":[{"rounded-ss":N()}],"rounded-se":[{"rounded-se":N()}],"rounded-ee":[{"rounded-ee":N()}],"rounded-es":[{"rounded-es":N()}],"rounded-tl":[{"rounded-tl":N()}],"rounded-tr":[{"rounded-tr":N()}],"rounded-br":[{"rounded-br":N()}],"rounded-bl":[{"rounded-bl":N()}],"border-w":[{border:O()}],"border-w-x":[{"border-x":O()}],"border-w-y":[{"border-y":O()}],"border-w-s":[{"border-s":O()}],"border-w-e":[{"border-e":O()}],"border-w-t":[{"border-t":O()}],"border-w-r":[{"border-r":O()}],"border-w-b":[{"border-b":O()}],"border-w-l":[{"border-l":O()}],"divide-x":[{"divide-x":O()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":O()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...P(),"hidden","none"]}],"divide-style":[{divide:[...P(),"hidden","none"]}],"border-color":[{border:I()}],"border-color-x":[{"border-x":I()}],"border-color-y":[{"border-y":I()}],"border-color-s":[{"border-s":I()}],"border-color-e":[{"border-e":I()}],"border-color-t":[{"border-t":I()}],"border-color-r":[{"border-r":I()}],"border-color-b":[{"border-b":I()}],"border-color-l":[{"border-l":I()}],"divide-color":[{divide:I()}],"outline-style":[{outline:[...P(),"none","hidden"]}],"outline-offset":[{"outline-offset":[gO,g3,gZ]}],"outline-w":[{outline:["",gO,g4,g$]}],"outline-color":[{outline:I()}],shadow:[{shadow:["","none",k,g9,g2]}],"shadow-color":[{shadow:I()}],"inset-shadow":[{"inset-shadow":["none",l,g9,g2]}],"inset-shadow-color":[{"inset-shadow":I()}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:I()}],"ring-offset-w":[{"ring-offset":[gO,g$]}],"ring-offset-color":[{"ring-offset":I()}],"inset-ring-w":[{"inset-ring":O()}],"inset-ring-color":[{"inset-ring":I()}],"text-shadow":[{"text-shadow":["none",m,g9,g2]}],"text-shadow-color":[{"text-shadow":I()}],opacity:[{opacity:[gO,g3,gZ]}],"mix-blend":[{"mix-blend":[...Q(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Q()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[gO]}],"mask-image-linear-from-pos":[{"mask-linear-from":R()}],"mask-image-linear-to-pos":[{"mask-linear-to":R()}],"mask-image-linear-from-color":[{"mask-linear-from":I()}],"mask-image-linear-to-color":[{"mask-linear-to":I()}],"mask-image-t-from-pos":[{"mask-t-from":R()}],"mask-image-t-to-pos":[{"mask-t-to":R()}],"mask-image-t-from-color":[{"mask-t-from":I()}],"mask-image-t-to-color":[{"mask-t-to":I()}],"mask-image-r-from-pos":[{"mask-r-from":R()}],"mask-image-r-to-pos":[{"mask-r-to":R()}],"mask-image-r-from-color":[{"mask-r-from":I()}],"mask-image-r-to-color":[{"mask-r-to":I()}],"mask-image-b-from-pos":[{"mask-b-from":R()}],"mask-image-b-to-pos":[{"mask-b-to":R()}],"mask-image-b-from-color":[{"mask-b-from":I()}],"mask-image-b-to-color":[{"mask-b-to":I()}],"mask-image-l-from-pos":[{"mask-l-from":R()}],"mask-image-l-to-pos":[{"mask-l-to":R()}],"mask-image-l-from-color":[{"mask-l-from":I()}],"mask-image-l-to-color":[{"mask-l-to":I()}],"mask-image-x-from-pos":[{"mask-x-from":R()}],"mask-image-x-to-pos":[{"mask-x-to":R()}],"mask-image-x-from-color":[{"mask-x-from":I()}],"mask-image-x-to-color":[{"mask-x-to":I()}],"mask-image-y-from-pos":[{"mask-y-from":R()}],"mask-image-y-to-pos":[{"mask-y-to":R()}],"mask-image-y-from-color":[{"mask-y-from":I()}],"mask-image-y-to-color":[{"mask-y-to":I()}],"mask-image-radial":[{"mask-radial":[g3,gZ]}],"mask-image-radial-from-pos":[{"mask-radial-from":R()}],"mask-image-radial-to-pos":[{"mask-radial-to":R()}],"mask-image-radial-from-color":[{"mask-radial-from":I()}],"mask-image-radial-to-color":[{"mask-radial-to":I()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":u()}],"mask-image-conic-pos":[{"mask-conic":[gO]}],"mask-image-conic-from-pos":[{"mask-conic-from":R()}],"mask-image-conic-to-pos":[{"mask-conic-to":R()}],"mask-image-conic-from-color":[{"mask-conic-from":I()}],"mask-image-conic-to-color":[{"mask-conic-to":I()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:J()}],"mask-repeat":[{mask:K()}],"mask-size":[{mask:L()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",g3,gZ]}],filter:[{filter:["","none",g3,gZ]}],blur:[{blur:S()}],brightness:[{brightness:[gO,g3,gZ]}],contrast:[{contrast:[gO,g3,gZ]}],"drop-shadow":[{"drop-shadow":["","none",n,g9,g2]}],"drop-shadow-color":[{"drop-shadow":I()}],grayscale:[{grayscale:["",gO,g3,gZ]}],"hue-rotate":[{"hue-rotate":[gO,g3,gZ]}],invert:[{invert:["",gO,g3,gZ]}],saturate:[{saturate:[gO,g3,gZ]}],sepia:[{sepia:["",gO,g3,gZ]}],"backdrop-filter":[{"backdrop-filter":["","none",g3,gZ]}],"backdrop-blur":[{"backdrop-blur":S()}],"backdrop-brightness":[{"backdrop-brightness":[gO,g3,gZ]}],"backdrop-contrast":[{"backdrop-contrast":[gO,g3,gZ]}],"backdrop-grayscale":[{"backdrop-grayscale":["",gO,g3,gZ]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[gO,g3,gZ]}],"backdrop-invert":[{"backdrop-invert":["",gO,g3,gZ]}],"backdrop-opacity":[{"backdrop-opacity":[gO,g3,gZ]}],"backdrop-saturate":[{"backdrop-saturate":[gO,g3,gZ]}],"backdrop-sepia":[{"backdrop-sepia":["",gO,g3,gZ]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":y()}],"border-spacing-x":[{"border-spacing-x":y()}],"border-spacing-y":[{"border-spacing-y":y()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",g3,gZ]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[gO,"initial",g3,gZ]}],ease:[{ease:["linear","initial",r,g3,gZ]}],delay:[{delay:[gO,g3,gZ]}],animate:[{animate:["none",s,g3,gZ]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,g3,gZ]}],"perspective-origin":[{"perspective-origin":v()}],rotate:[{rotate:T()}],"rotate-x":[{"rotate-x":T()}],"rotate-y":[{"rotate-y":T()}],"rotate-z":[{"rotate-z":T()}],scale:[{scale:U()}],"scale-x":[{"scale-x":U()}],"scale-y":[{"scale-y":U()}],"scale-z":[{"scale-z":U()}],"scale-3d":["scale-3d"],skew:[{skew:V()}],"skew-x":[{"skew-x":V()}],"skew-y":[{"skew-y":V()}],transform:[{transform:[g3,gZ,"","none","gpu","cpu"]}],"transform-origin":[{origin:v()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:W()}],"translate-x":[{"translate-x":W()}],"translate-y":[{"translate-y":W()}],"translate-z":[{"translate-z":W()}],"translate-none":["translate-none"],accent:[{accent:I()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:I()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",g3,gZ]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":y()}],"scroll-mx":[{"scroll-mx":y()}],"scroll-my":[{"scroll-my":y()}],"scroll-ms":[{"scroll-ms":y()}],"scroll-me":[{"scroll-me":y()}],"scroll-mt":[{"scroll-mt":y()}],"scroll-mr":[{"scroll-mr":y()}],"scroll-mb":[{"scroll-mb":y()}],"scroll-ml":[{"scroll-ml":y()}],"scroll-p":[{"scroll-p":y()}],"scroll-px":[{"scroll-px":y()}],"scroll-py":[{"scroll-py":y()}],"scroll-ps":[{"scroll-ps":y()}],"scroll-pe":[{"scroll-pe":y()}],"scroll-pt":[{"scroll-pt":y()}],"scroll-pr":[{"scroll-pr":y()}],"scroll-pb":[{"scroll-pb":y()}],"scroll-pl":[{"scroll-pl":y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",g3,gZ]}],fill:[{fill:["none",...I()]}],"stroke-w":[{stroke:[gO,g4,g$,g_]}],stroke:[{stroke:["none",...I()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});var hk=a.i(50194);function hl(...a){return hj(function(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d}(a))}let hm={input:{icon:gi,gradient:"from-sky-400 to-blue-600",glow:"shadow-sky-500/20",text:"text-sky-100",badge:"bg-sky-500/20 text-sky-200 border-sky-500/30"},style:{icon:gl.Palette,gradient:"from-amber-300 to-orange-500",glow:"shadow-amber-500/20",text:"text-amber-100",badge:"bg-amber-500/20 text-amber-200 border-amber-500/30"},customization:{icon:gm,gradient:"from-slate-400 to-zinc-600",glow:"shadow-slate-500/20",text:"text-slate-100",badge:"bg-slate-500/20 text-slate-200 border-slate-500/30"},processing:{icon:gf.Sparkles,gradient:"from-fuchsia-400 to-purple-600",glow:"shadow-purple-500/30",text:"text-purple-100",badge:"bg-purple-500/20 text-purple-200 border-purple-500/30"},output:{icon:gj,gradient:"from-emerald-400 to-teal-600",glow:"shadow-emerald-500/20",text:"text-emerald-100",badge:"bg-emerald-500/20 text-emerald-200 border-emerald-500/30"},capsule:{icon:gn,gradient:"from-rose-400 to-pink-600",glow:"shadow-rose-500/30",text:"text-rose-100",badge:"bg-rose-500/20 text-rose-200 border-rose-500/30"}},hn=(0,t.memo)(function({data:a,type:b,selected:c}){let{t:d}=(0,hk.useLanguage)(),e=b||"customization",f=hm[e],g=f.icon,h="capsule"===e,i=h&&!!a.locked,j=a.status??"idle",k="running"===j?"bg-amber-500/20 text-amber-200 border-amber-500/30":"success"===j?"bg-emerald-500/20 text-emerald-200 border-emerald-500/30":"error"===j?"bg-rose-500/20 text-rose-200 border-rose-500/30":f.badge,l="output"===e?a.generationPreview:void 0,m=Array.isArray(l?.beat_sheet)?l?.beat_sheet:[],n=Array.isArray(l?.storyboard)?l?.storyboard:[],o=m.length>0||n.length>0;return(0,s.jsxs)(f3.motion.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},whileHover:{scale:1.02,y:-2},transition:{duration:.2},className:hl("relative min-w-[240px] rounded-2xl border bg-slate-950/80 px-4 py-4 backdrop-blur-xl transition-all duration-300",c?`border-transparent ring-2 ring-offset-2 ring-offset-slate-950 ring-${f.gradient.split("-")[1]}-400`:"border-slate-800",f.glow,c&&"shadow-2xl"),children:[c&&(0,s.jsx)("div",{className:hl("absolute inset-0 -z-10 rounded-2xl opacity-20 bg-gradient-to-br",f.gradient)}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:hl("flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br shadow-inner",f.gradient),children:(0,s.jsx)(g,{className:"h-4 w-4 text-white",strokeWidth:2.5})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:hl("text-xs font-bold uppercase tracking-wider opacity-60",f.text),children:e}),(0,s.jsx)("div",{className:"text-sm font-bold text-slate-100 leading-tight",children:a.label})]})]}),h&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-[10px] uppercase tracking-widest",children:[(0,s.jsx)("span",{className:"rounded-full border border-rose-400/30 bg-rose-500/10 px-2 py-0.5 text-rose-200",children:"Sealed"}),i&&(0,s.jsxs)("span",{className:"flex items-center gap-1 rounded-full border border-slate-400/30 bg-slate-500/10 px-2 py-0.5 text-slate-200",children:[(0,s.jsx)(gk,{className:"h-3 w-3"}),"Locked"]})]})]}),a.subtitle&&(0,s.jsx)("div",{className:"mb-2 rounded-md bg-slate-900/50 px-3 py-2 text-xs font-medium text-slate-400",children:a.subtitle}),o&&(0,s.jsxs)("div",{className:"mb-3 rounded-md border border-emerald-500/20 bg-emerald-500/5 px-3 py-2 text-xs text-slate-200",children:[(0,s.jsx)("div",{className:"text-[10px] uppercase tracking-widest text-emerald-300",children:d("generationPreview")}),m.length>0&&(0,s.jsx)("div",{className:"mt-2 space-y-1",children:m.slice(0,2).map((a,b)=>(0,s.jsxs)("div",{className:"text-[11px] text-slate-300",children:[String(a.beat??`Beat ${b+1}`),":"," ",String(a.note??"")]},b))}),n.length>0&&(0,s.jsx)("div",{className:"mt-2 space-y-1",children:n.slice(0,2).map((a,b)=>{let c=String(a.dominant_color??"#334155"),d=String(a.accent_color??"#64748b");return(0,s.jsxs)("div",{className:"flex items-center gap-2 text-[11px] text-slate-300",children:[(0,s.jsxs)("span",{className:"text-slate-400",children:["Shot ",String(a.shot??b+1)]}),(0,s.jsx)("span",{className:"h-2 w-2 rounded-full",style:{backgroundColor:c}}),(0,s.jsx)("span",{className:"h-2 w-2 rounded-full",style:{backgroundColor:d}}),(0,s.jsx)("span",{className:"truncate",children:String(a.composition??"composition")})]},b)})})]}),(0,s.jsx)("div",{className:"flex items-center justify-between mt-2",children:(0,s.jsx)("span",{className:hl("px-2 py-0.5 rounded text-[10px] font-medium border",k),children:"running"===j?d("running"):"success"===j?"DONE":"error"===j?d("error"):"ACTIVE"})}),"input"!==e&&(0,s.jsx)(eJ,{type:"target",position:p.Left,className:hl("!h-4 !w-2 !rounded-full !border-2 !border-slate-950 transition-colors","bg-slate-400 hover:bg-white")}),"output"!==e&&(0,s.jsx)(eJ,{type:"source",position:p.Right,className:hl("!h-4 !w-2 !rounded-full !border-2 !border-slate-950 transition-colors","bg-slate-400 hover:bg-white")})]})});var ho=a.i(19032);let hp=(0,f5.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),hq=(0,f5.default)("sliders-vertical",[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]]),hr={style:{style_intensity:{type:"number",min:.4,max:1,step:.05,default:.6},color_bias:{type:"enum",options:["cool","neutral","warm"],default:"neutral"},composition:{type:"enum",options:["symmetry","rule_of_thirds","centered","leading_lines"],default:"rule_of_thirds"},pacing:{type:"enum",options:["slow","medium","fast"],default:"medium"}},customization:{tone:{type:"enum",options:["hopeful","tense","melancholic","playful"],default:"hopeful"},music_mood:{type:"enum",options:["ambient","orchestral","electronic","acoustic"],default:"ambient"},personal_theme:{type:"string",default:""},motif:{type:"string",default:""}},processing:{mode:{type:"enum",options:["auto","ga","rl"],default:"auto"},target_profile:{type:"enum",options:["balanced","cinematic","experimental"],default:"balanced"},iterations:{type:"number",min:1,max:50,step:1,default:10},temperature:{type:"number",min:.1,max:1,step:.05,default:.7}}};function hs({selectedNode:a,onClose:b,onUpdate:c,onDelete:d}){let{t:e}=(0,hk.useLanguage)(),[f,g]=(0,t.useState)(null),[h,i]=(0,t.useState)(null),[j,k]=(0,t.useState)(!1),[l,m]=(0,t.useState)("idle"),[n,o]=(0,t.useState)(null),[p,q]=(0,t.useState)(null),[r,u]=(0,t.useState)([]),[v,w]=(0,t.useState)(!1),[x,y]=(0,t.useState)(null);(0,t.useEffect)(()=>{if(!a||"capsule"!==a.type||!a.data.capsuleId){g(null),i(null),k(!1),u([]),y(null),w(!1);return}let b=!0;return k(!0),i(null),ho.api.getCapsuleSpec(a.data.capsuleId,a.data.capsuleVersion).then(a=>{b&&g(a)}).catch(a=>{b&&i(a instanceof Error?a.message:"Failed to load capsule spec")}).finally(()=>{b&&k(!1)}),()=>{b=!1}},[a]),(0,t.useEffect)(()=>{m("idle"),o(null),q(null)},[a?.id]);let z=(0,t.useMemo)(()=>{let a=f?.spec;return a?.exposedParams||null},[f]),A=(0,t.useMemo)(()=>a?"capsule"===a.type?z:hr[a.type]||null:null,[a,z]);(0,t.useEffect)(()=>{if(!a||!A||a.data.params)return;let b={};Object.entries(A).forEach(([a,c])=>{if(void 0!==c.default){b[a]=c.default;return}"number"===c.type?b[a]="number"==typeof c.min?c.min:0:"enum"===c.type?b[a]=c.options?.[0]??"":"boolean"===c.type?b[a]=!1:b[a]=""}),c(a.id,{params:b})},[a,A,c]);let B=a?.data?.params||{},C=a?.data?.capsuleVersion||f?.version||"latest",D=(b,d)=>{let e=d.default??("number"===d.type?d.min??0:"enum"===d.type?d.options?.[0]??"":"boolean"!==d.type&&""),f=B[b]??e;return"enum"===d.type?(0,s.jsx)("select",{value:String(f),onChange:d=>c(a.id,{params:{...B,[b]:d.target.value}}),className:"w-full rounded border border-white/10 bg-slate-900/50 px-2 py-1.5 text-xs text-slate-100",children:(d.options||[]).map(a=>(0,s.jsx)("option",{value:a,children:a},a))}):"boolean"===d.type?(0,s.jsx)("button",{onClick:()=>c(a.id,{params:{...B,[b]:!f}}),className:`w-full rounded border px-2 py-1.5 text-xs ${f?"border-emerald-400/40 bg-emerald-500/10 text-emerald-200":"border-white/10 bg-slate-900/50 text-slate-400"}`,children:f?"Enabled":"Disabled"}):"number"===d.type?(0,s.jsx)("input",{type:"range",min:d.min??0,max:d.max??1,step:d.step??.05,value:Number(f),onChange:d=>c(a.id,{params:{...B,[b]:parseFloat(d.target.value)}}),className:"w-full accent-rose-400"}):(0,s.jsx)("input",{type:"text",value:String(f),onChange:d=>c(a.id,{params:{...B,[b]:d.target.value}}),className:"w-full rounded border border-white/10 bg-slate-900/50 px-2 py-1.5 text-xs text-slate-100"})},E=(0,t.useCallback)(async a=>{w(!0),y(null);try{let b=await ho.api.listCapsuleRuns(a,5);u(b)}catch(a){y(a instanceof Error?a.message:"Failed to load run history")}finally{w(!1)}},[]);(0,t.useEffect)(()=>{a&&"capsule"===a.type&&a.data.capsuleId&&E(a.data.capsuleId)},[a,E]);let F=async()=>{if(a&&"capsule"===a.type&&a.data.capsuleId){m("running"),o(null),c(a.id,{status:"running"}),!a.data.capsuleVersion&&f?.version&&c(a.id,{capsuleVersion:f.version});try{let b=await ho.api.runCapsule({capsule_id:a.data.capsuleId,capsule_version:C,inputs:{},params:B,node_id:a.id});q(b),m("success"),c(a.id,{status:"success",capsuleVersion:a.data.capsuleVersion||b.version||C}),await E(a.data.capsuleId)}catch(b){o(b instanceof Error?b.message:"Capsule run failed"),m("error"),c(a.id,{status:"error"})}}};return(0,s.jsx)(f4.AnimatePresence,{children:a&&(0,s.jsxs)(f3.motion.aside,{initial:{x:"100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"absolute right-0 top-0 h-full w-80 border-l border-white/10 bg-slate-950/80 p-6 backdrop-blur-2xl shadow-2xl z-20",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-sky-500/20 text-sky-400",children:(0,s.jsx)(hq,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:e("inspectorTitle")}),(0,s.jsxs)("p",{className:"text-base font-bold text-slate-100 capitalize",children:[a.type," ",e("inspectorTitle").replace("Inspector","Node")]})]})]}),(0,s.jsx)("button",{onClick:b,className:"rounded-full p-2 text-slate-400 hover:bg-white/5 hover:text-white transition-colors",children:(0,s.jsx)(gh.X,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:e("nodeLabel")}),(0,s.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-slate-900/50 px-3 py-2.5 text-sm text-slate-100 placeholder:text-slate-600 focus:border-sky-500/50 focus:outline-none focus:ring-1 focus:ring-sky-500/50 transition-all",value:a.data.label,onChange:b=>c(a.id,{label:b.target.value}),placeholder:e("nodeLabel")})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:e("nodeSubtitle")}),(0,s.jsx)("textarea",{className:"w-full resize-none rounded-lg border border-white/10 bg-slate-900/50 px-3 py-2.5 text-sm text-slate-100 placeholder:text-slate-600 focus:border-sky-500/50 focus:outline-none focus:ring-1 focus:ring-sky-500/50 transition-all",rows:3,value:a.data.subtitle||"",onChange:b=>c(a.id,{subtitle:b.target.value}),placeholder:e("nodeSubtitle")})]}),(0,s.jsxs)("div",{className:"rounded-lg bg-black/20 p-4 border border-white/5 space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"ID"}),(0,s.jsx)("span",{className:"font-mono text-slate-300",children:a.id})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"X, Y"}),(0,s.jsxs)("span",{className:"font-mono text-slate-300",children:[Math.round(a.position.x),","," ",Math.round(a.position.y)]})]})]}),"capsule"!==a.type&&A&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"h-1 w-1 rounded-full bg-sky-400"}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-widest text-sky-400",children:e("nodeParams")})]}),(0,s.jsx)("div",{className:"rounded-lg border border-white/10 bg-slate-900/40 p-4 space-y-3",children:Object.entries(A).map(([a,b])=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-[10px] font-medium text-slate-400 uppercase",children:a.replace(/_/g," ")}),D(a,b)]},a))})]}),"capsule"===a.type&&a.data.capsuleId&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"h-1 w-1 rounded-full bg-rose-400"}),(0,s.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-widest text-rose-400",children:"Capsule Parameters"})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-rose-500/20 bg-rose-500/5 p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start gap-2 rounded-md border border-white/5 bg-black/20 px-3 py-2 text-[11px] text-slate-300",children:[(0,s.jsx)(gk,{className:"mt-0.5 h-3 w-3 text-rose-300"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-200",children:e("sealedDesc")}),a.data.locked&&(0,s.jsx)("div",{className:"text-slate-400",children:e("lockedDesc")})]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Capsule"}),(0,s.jsx)("span",{className:"font-mono text-rose-200",children:a.data.capsuleId})]}),a.data.capsuleVersion&&(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-slate-400",children:e("version")}),(0,s.jsx)("span",{className:"font-mono text-rose-200",children:String(a.data.capsuleVersion)})]}),j&&(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"Loading capsule spec..."}),h&&(0,s.jsx)("div",{className:"text-xs text-rose-300",children:h}),z&&(0,s.jsx)("div",{className:"space-y-3 pt-2 border-t border-white/5",children:Object.entries(z).map(([a,b])=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-[10px] font-medium text-slate-400 uppercase",children:a.replace(/_/g," ")}),D(a,b)]},a))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("button",{onClick:F,disabled:"running"===l,className:"w-full rounded-lg border border-rose-500/30 bg-rose-500/10 px-3 py-2 text-xs font-semibold text-rose-100 hover:bg-rose-500/20 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:["running"===l?(0,s.jsx)("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-rose-200 border-t-transparent"}):(0,s.jsx)(ge,{className:"h-4 w-4"}),e("running"===l?"running":"runCapsule")]}),n&&(0,s.jsx)("div",{className:"text-xs text-rose-300",children:n}),p&&(0,s.jsxs)("div",{className:"rounded-lg border border-emerald-500/20 bg-emerald-500/5 p-3 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-semibold text-emerald-200",children:e("runSummary")}),(0,s.jsx)("span",{className:"text-slate-400 uppercase",children:p.status})]}),p.cached&&(0,s.jsx)("div",{className:"mt-1 text-[10px] text-emerald-300 uppercase",children:e("cachedResult")}),(0,s.jsx)("div",{className:"mt-2 text-slate-200",children:String(p.summary?.message??e("generating"))}),(0,s.jsxs)("div",{className:"mt-2 text-[10px] text-slate-400",children:[e("runId"),": ",p.run_id]}),(0,s.jsxs)("div",{className:"mt-2 space-y-1 text-[10px] text-slate-500",children:[(0,s.jsxs)("div",{children:[e("evidenceRefs"),": ",p.evidence_refs?.length??0]}),(p.evidence_refs||[]).map(a=>(0,s.jsx)("div",{className:"rounded border border-white/5 bg-black/20 px-2 py-1 text-slate-300",children:a},a))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-[10px] uppercase tracking-widest text-slate-400",children:[(0,s.jsx)("span",{children:e("runHistory")}),v&&(0,s.jsx)("span",{className:"text-slate-500",children:e("loading")})]}),x&&(0,s.jsx)("div",{className:"text-xs text-rose-300",children:x}),0===r.length&&!v&&!x&&(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e("noRuns")}),r.map(a=>(0,s.jsxs)("div",{className:"rounded-lg border border-white/5 bg-slate-900/50 px-3 py-2 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-mono text-slate-300",children:a.run_id.slice(0,8)}),(0,s.jsx)("span",{className:"text-[10px] uppercase text-slate-500",children:a.status})]}),(0,s.jsx)("div",{className:"mt-1 text-slate-400",children:String(a.summary?.message??"Capsule executed")}),(0,s.jsx)("div",{className:"mt-1 text-[10px] text-slate-500",children:new Date(a.created_at).toLocaleString()})]},a.run_id))]})]})]}),(0,s.jsx)("div",{className:"absolute bottom-6 left-6 right-6",children:d&&(0,s.jsxs)("button",{onClick:()=>d(a.id),className:"group flex w-full items-center justify-center gap-2 rounded-lg border border-rose-500/20 bg-rose-500/10 px-4 py-3 text-sm font-semibold text-rose-200 hover:bg-rose-500/20 hover:border-rose-500/30 transition-all",children:[(0,s.jsx)(hp,{className:"h-4 w-4 opacity-70 group-hover:opacity-100"}),e("deleteNode")]})})]})})}let ht=(0,f5.default)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),hu=(0,f5.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),hv=(0,f5.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),hw=(0,f5.default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);function hx({preview:a,isLoading:b,onClose:c}){let{t:d}=(0,hk.useLanguage)();return a||b?(0,s.jsx)(f4.AnimatePresence,{children:(0,s.jsxs)(f3.motion.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 h-full w-[400px] bg-gradient-to-b from-gray-900/95 to-gray-950/95 backdrop-blur-xl border-l border-white/10 z-50 overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-5 border-b border-white/10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-violet-500/20 to-cyan-500/20 flex items-center justify-center",children:(0,s.jsx)(hv,{className:"w-5 h-5 text-violet-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:d("storyboardPreview")}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:d("generatedDesc")})]})]}),(0,s.jsx)("button",{onClick:c,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:(0,s.jsx)(gh.X,{className:"w-5 h-5 text-gray-400"})})]}),b&&(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(f3.motion.div,{animate:{rotate:360},transition:{repeat:1/0,duration:2,ease:"linear"},children:(0,s.jsx)(gf.Sparkles,{className:"w-12 h-12 text-violet-400 mx-auto mb-4"})}),(0,s.jsx)("p",{className:"text-gray-400",children:d("generating")})]})}),a&&!b&&(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-5 space-y-6",children:[(0,s.jsxs)("section",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(gl.Palette,{className:"w-4 h-4 text-violet-400"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:d("colorPalette")})]}),(0,s.jsx)("div",{className:"flex gap-2",children:a.palette.map((a,b)=>(0,s.jsxs)(f3.motion.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1*b},className:"group relative",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl shadow-lg cursor-pointer transition-transform hover:scale-110",style:{backgroundColor:a}}),(0,s.jsx)("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 px-2 py-1 bg-gray-800 rounded text-[10px] text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:a})]},b))})]}),(0,s.jsxs)("section",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(ht,{className:"w-4 h-4 text-cyan-400"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:d("sceneBreakdown")})]}),(0,s.jsx)("div",{className:"space-y-3",children:a.scenes.map((a,b)=>(0,s.jsx)(hy,{scene:a,index:b,t:d},b))})]}),(0,s.jsxs)("section",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(gf.Sparkles,{className:"w-4 h-4 text-amber-400"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:d("styleSignature")})]}),(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-4",children:[(0,s.jsx)("div",{className:"flex gap-1 h-16 items-end",children:a.style_vector.slice(0,12).map((a,b)=>(0,s.jsx)(f3.motion.div,{initial:{height:0},animate:{height:`${100*a}%`},transition:{delay:.05*b,type:"spring"},className:"flex-1 bg-gradient-to-t from-violet-600 to-violet-400 rounded-t"},b))}),(0,s.jsx)("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"16-dimensional style embedding"})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(hw,{className:"w-4 h-4 text-emerald-400"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:d("evidenceRefs")})]}),0===a.evidence_refs.length?(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"No evidence refs returned."}):(0,s.jsx)("div",{className:"space-y-2",children:a.evidence_refs.map((a,b)=>(0,s.jsx)("div",{className:"rounded-lg border border-white/5 bg-gray-900/50 px-3 py-2 text-[11px] text-gray-300",children:a},b))})]})]}),a&&(0,s.jsx)("div",{className:"p-5 border-t border-white/10 bg-gray-900/50",children:(0,s.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:[d("runId"),": ",a.run_id,"  ",a.capsule_id]})})]})}):null}function hy({scene:a,index:b,t:c}){return(0,s.jsxs)(f3.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*b},className:"bg-gray-800/50 rounded-xl p-4 border border-white/5",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-violet-600 to-cyan-600 flex items-center justify-center text-xs font-bold text-white",children:a.scene_number}),(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:a.composition})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[(0,s.jsx)(hu,{className:"w-3 h-3"}),a.duration_hint]})]}),(0,s.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded border border-white/20",style:{backgroundColor:a.dominant_color}}),(0,s.jsx)("span",{className:"text-[10px] text-gray-500",children:c("primary")})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded border border-white/20",style:{backgroundColor:a.accent_color}}),(0,s.jsx)("span",{className:"text-[10px] text-gray-500",children:c("accent")})]})]}),(0,s.jsx)("div",{className:"text-xs text-gray-400 bg-gray-900/50 rounded-lg px-3 py-2",children:a.pacing_note})]})}let hz=(0,f5.default)("clapperboard",[["path",{d:"M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z",key:"1tn4o7"}],["path",{d:"m6.2 5.3 3.1 3.9",key:"iuk76l"}],["path",{d:"m12.4 3.4 3.1 4",key:"6hsd6n"}],["path",{d:"M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z",key:"ltgou9"}]]),hA=(0,f5.default)("list-checks",[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]]),hB=(0,f5.default)("panels-top-left",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);function hC({run:a,isLoading:b,onClose:c}){let{t:d}=(0,hk.useLanguage)();if(!a&&!b)return null;let e=Array.isArray(a?.spec?.beat_sheet)?a?.spec?.beat_sheet:[],f=Array.isArray(a?.spec?.storyboard)?a?.spec?.storyboard:[];return(0,s.jsx)(f4.AnimatePresence,{children:(0,s.jsxs)(f3.motion.div,{initial:{opacity:0,x:-300},animate:{opacity:1,x:0},exit:{opacity:0,x:-300},transition:{type:"spring",damping:25,stiffness:200},className:"fixed left-0 top-0 h-full w-[420px] bg-gradient-to-b from-emerald-950/95 to-slate-950/95 backdrop-blur-xl border-r border-white/10 z-50 overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-5 border-b border-white/10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-emerald-500/15 flex items-center justify-center",children:(0,s.jsx)(hz,{className:"w-5 h-5 text-emerald-300"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:d("generationPreview")}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:d("beatSheetStoryboardDesc")})]})]}),(0,s.jsx)("button",{onClick:c,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:(0,s.jsx)(gh.X,{className:"w-5 h-5 text-slate-400"})})]}),b&&(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(f3.motion.div,{animate:{rotate:360},transition:{repeat:1/0,duration:2,ease:"linear"},children:(0,s.jsx)(hB,{className:"w-10 h-10 text-emerald-300 mx-auto mb-4"})}),(0,s.jsx)("p",{className:"text-slate-400",children:d("generating")})]})}),!b&&a&&(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-5 space-y-6",children:[(0,s.jsxs)("section",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(hA,{className:"w-4 h-4 text-emerald-300"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:d("beatSheet")})]}),0===e.length?(0,s.jsx)("div",{className:"text-xs text-slate-500",children:d("noBeatSheet")}):(0,s.jsx)("div",{className:"space-y-2",children:e.map((a,b)=>(0,s.jsxs)("div",{className:"rounded-lg border border-white/5 bg-slate-900/50 px-3 py-2 text-xs",children:[(0,s.jsx)("div",{className:"text-slate-200 font-semibold",children:String(a.beat||`Beat ${b+1}`)}),(0,s.jsx)("div",{className:"text-slate-400 mt-1",children:String(a.note)})]},`${String(a.beat)}-${b}`))})]}),(0,s.jsxs)("section",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(hz,{className:"w-4 h-4 text-sky-300"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-white",children:d("storyboard")})]}),0===f.length?(0,s.jsx)("div",{className:"text-xs text-slate-500",children:d("noStoryboard")}):(0,s.jsx)("div",{className:"space-y-2",children:f.map((a,b)=>(0,s.jsxs)("div",{className:"rounded-lg border border-white/5 bg-slate-900/50 px-3 py-2 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-slate-200 font-semibold",children:[d("shot")," ",String(a.shot||b+1)]}),(0,s.jsx)("span",{className:"text-[10px] text-slate-500",children:String(a.pacing_note)})]}),(0,s.jsx)("div",{className:"mt-1 text-slate-400",children:String(a.composition)}),(0,s.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-[10px] text-slate-500",children:[(0,s.jsx)("span",{className:"h-3 w-3 rounded-full border border-white/10",style:{backgroundColor:String(a.dominant_color)}}),(0,s.jsx)("span",{className:"h-3 w-3 rounded-full border border-white/10",style:{backgroundColor:String(a.accent_color)}}),(0,s.jsx)("span",{children:String(a.dominant_color)})]})]},`${String(a.shot)}-${b}`))})]})]}),a&&(0,s.jsxs)("div",{className:"p-4 border-t border-white/10 text-[10px] text-slate-500 text-center",children:[d("runId"),": ",a.id,"  ",a.status]})]})})}let hD={input:hn,style:hn,customization:hn,processing:hn,output:hn,capsule:hn},hE=[{id:"input-1",type:"input",position:{x:100,y:300},data:{label:"Prompt Input",subtitle:"User request"}},{id:"processing-1",type:"processing",position:{x:450,y:300},data:{label:"Reasoning Core",subtitle:"LLM + GA"}},{id:"output-1",type:"output",position:{x:800,y:300},data:{label:"Final Response",subtitle:"Rendered Output"}}],hF=[];function hG(){let a=(0,u.useSearchParams)().get("id"),{t:b}=(0,hk.useLanguage)(),[c,d,e]=function(a){let[b,c]=(0,t.useState)(a),d=(0,t.useCallback)(a=>c(b=>ef(a,b)),[]);return[b,c,d]}(hE),[f,g,h]=function(a){let[b,c]=(0,t.useState)(a),d=(0,t.useCallback)(a=>c(b=>ef(a,b)),[]);return[b,c,d]}(hF),[i,j]=(0,t.useState)(null),[k,l]=(0,t.useState)(null),[m,n]=(0,t.useState)(b("untitledProject")),[o,p]=(0,t.useState)(!1),[q,r]=(0,t.useState)(!1),[v,w]=(0,t.useState)(!1),[x,y]=(0,t.useState)([]),[z,A]=(0,t.useState)(!1),[B,C]=(0,t.useState)(null),[D,E]=(0,t.useState)(!1),[F,G]=(0,t.useState)([]),[H,I]=(0,t.useState)(!1),[J,K]=(0,t.useState)(null),[L,M]=(0,t.useState)(!1),[N,O]=(0,t.useState)(!1),[P,Q]=(0,t.useState)(null),[R,S]=(0,t.useState)(!1),[T,U]=(0,t.useState)(null),V=(0,t.useRef)(null),[W,X]=(0,t.useState)(!1),{takeSnapshot:Y,undo:Z,redo:$,canUndo:_,canRedo:aa}=function(){let[a,b]=(0,t.useState)([]),[c,d]=(0,t.useState)([]),e=(0,t.useCallback)((a,c)=>{b(b=>{let d=[...b,{nodes:a.map(a=>({...a})),edges:c.map(a=>({...a}))}];return d.length>50&&d.shift(),d}),d([])},[]);return{takeSnapshot:e,undo:(0,t.useCallback)((c,e)=>{if(0===a.length)return null;let f=[...a],g=f.pop();return g?(b(f),d(a=>[{nodes:c,edges:e},...a]),g):null},[a]),redo:(0,t.useCallback)((a,e)=>{if(0===c.length)return null;let f=[...c],g=f.shift();return g?(d(f),b(b=>[...b,{nodes:a,edges:e}]),g):null},[c]),canUndo:a.length>0,canRedo:c.length>0,pastDepth:a.length}}(),ab=(0,t.useCallback)(a=>{d(b=>b.map(b=>"output"===b.type?{...b,data:{...b.data,...a}}:b)),j(b=>b&&"output"===b.type?{...b,data:{...b.data,...a}}:b)},[d]);(0,t.useEffect)(()=>()=>{V.current&&clearInterval(V.current)},[]);let ac=(0,t.useCallback)(()=>{V.current&&(clearInterval(V.current),V.current=null)},[]),ad=(0,t.useCallback)(a=>{V.current&&clearInterval(V.current),V.current=setInterval(async()=>{try{let b=await ho.api.getGenerationRun(a);if(Q(b),U(b.status),"done"===b.status){let a=Array.isArray(b.spec?.beat_sheet)?b.spec.beat_sheet:[],c=Array.isArray(b.spec?.storyboard)?b.spec.storyboard:[];ab({status:"success",generationPreview:{beat_sheet:a,storyboard:c}})}else"failed"===b.status&&ab({status:"error"});("done"===b.status||"failed"===b.status)&&(ac(),S(!1),X(!0))}catch(a){C(a instanceof Error?a.message:"Failed to fetch run status"),ab({status:"error"}),ac(),S(!1)}},1500)},[ac,ab]),ae=(0,t.useCallback)(async()=>{E(!0),C(null);try{let a=c.find(a=>"processing"===a.type),b="string"==typeof a?.data?.params?.target_profile?a.data.params.target_profile:"balanced",e=await ho.api.optimizeParams(c,f,b);G(e.recommendations),I(!0);let g=c.find(a=>"capsule"===a.type);if(g&&g.data.capsuleId){M(!0),O(!0);try{let a=await ho.api.runCapsule({canvas_id:k||void 0,node_id:g.id,capsule_id:g.data.capsuleId,capsule_version:g.data.capsuleVersion||"latest",inputs:{},params:g.data.params||{}});a.version&&g.data.capsuleVersion!==a.version&&d(b=>b.map(b=>b.id===g.id?{...b,data:{...b.data,capsuleVersion:a.version}}:b));let b=await ho.api.getStoryboardPreview(g.data.capsuleId,a.run_id,3);K(b)}catch(a){console.error("Preview error:",a)}finally{M(!1)}}}catch(a){C(a instanceof Error?a.message:"Optimization failed")}finally{E(!1)}},[c,f,k]),af=(0,t.useCallback)(async()=>{if(!k)return void C("Save the canvas before generating.");S(!0),ab({status:"running",generationPreview:void 0}),C(null);try{let a=await ho.api.createGenerationRun(k);Q(a),U(a.status),X(!0),ad(a.id)}catch(a){C(a instanceof Error?a.message:"Generation failed to start"),ab({status:"error"}),S(!1)}},[k,ad,ab]),ag=(0,t.useCallback)(a=>{let b=c.map(b=>"capsule"===b.type?{...b,data:{...b.data,params:{...b.data.params,...a}}}:b);d(b),Y(b,f),I(!1)},[c,f,d,Y]);(0,t.useEffect)(()=>{a&&!k&&(w(!0),ho.api.loadCanvas(a).then(a=>{l(a.id),n(a.title),p(a.is_public),d(a.graph_data.nodes),g(a.graph_data.edges),Y(a.graph_data.nodes,a.graph_data.edges)}).catch(a=>{C(a instanceof Error?a.message:"Failed to load canvas")}).finally(()=>w(!1)))},[a,k,d,g,Y]),(0,t.useEffect)(()=>{a||Y(hE,hF)},[Y,a]);let ah=(0,t.useCallback)(a=>{g(b=>{let d=cY({...a,animated:!0,style:{stroke:"#38bdf8",strokeWidth:2.5}},b);return Y(c,d),d})},[c,g,Y]),ai=(0,t.useCallback)(a=>{let b=[...c,{id:"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`node-${Date.now()}`,type:a,position:{x:400+100*Math.random(),y:300+100*Math.random()},data:{label:`New ${a}`,subtitle:"Configure in inspector"}}];d(b),Y(b,f)},[f,c,d,Y]),aj=(0,t.useCallback)(()=>{let a=Z(c,f);a&&(d(a.nodes),g(a.edges))},[Z,c,f,d,g]),ak=(0,t.useCallback)(()=>{let a=$(c,f);a&&(d(a.nodes),g(a.edges))},[$,c,f,d,g]),al=(0,t.useCallback)((a,b)=>{d(c.map(c=>c.id===a?{...c,data:{...c.data,...b}}:c)),j(c=>c&&c.id===a?{...c,data:{...c.data,...b}}:c)},[c,d]),am=(0,t.useCallback)(a=>{let b=c.filter(b=>b.id!==a),e=f.filter(b=>b.source!==a&&b.target!==a);d(b),g(e),j(null),Y(b,e)},[f,c,g,d,Y]),an=(0,t.useCallback)(async()=>{r(!0),C(null);try{let a={title:m,graph_data:{nodes:c,edges:f},is_public:o},b=k?await ho.api.updateCanvas(k,a):await ho.api.createCanvas(a);l(b.id)}catch(a){C(a instanceof Error?a.message:"Save failed")}finally{r(!1)}},[k,f,o,c,m]),ao=(0,t.useCallback)(async()=>{w(!0),C(null);try{let a=await ho.api.listCanvases();y(a),A(!0)}catch(a){C(a instanceof Error?a.message:"Load failed")}finally{w(!1)}},[]),ap=(0,t.useCallback)(async a=>{w(!0),C(null);try{let b=await ho.api.loadCanvas(a.id);l(b.id),n(b.title),p(b.is_public),d(b.graph_data.nodes),g(b.graph_data.edges),ac(),Q(null),U(null),S(!1),A(!1),Y(b.graph_data.nodes,b.graph_data.edges)}catch(a){C(a instanceof Error?a.message:"Load failed")}finally{w(!1)}},[g,d,Y,ac]),aq=(0,t.useCallback)(()=>{l(null),n(b("newProject")),p(!1),d(hE),g(hF),j(null),ac(),Q(null),U(null),S(!1),Y(hE,hF)},[g,d,Y,ac,b]),ar=(0,t.useMemo)(()=>[{kind:"input",label:b("nodeInput")},{kind:"style",label:b("nodeStyle")},{kind:"customization",label:b("nodeCustom")},{kind:"processing",label:b("nodeProcess")},{kind:"output",label:b("nodeOutput")}],[b]);return(0,s.jsxs)("div",{className:"h-screen w-screen bg-slate-950 text-slate-100 overflow-hidden relative",children:[(0,s.jsxs)("header",{className:"absolute top-0 left-0 right-0 z-10 px-6 py-4 flex items-center justify-between pointer-events-none",children:[(0,s.jsxs)("div",{className:"pointer-events-auto flex items-center gap-4 bg-slate-950/50 backdrop-blur-md p-2 rounded-2xl border border-white/10 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex flex-col px-2",children:[(0,s.jsx)("span",{className:"text-[10px] uppercase tracking-widest text-sky-400 font-bold",children:b("appName")}),(0,s.jsx)("input",{className:"bg-transparent text-sm font-bold text-slate-100 focus:outline-none w-40",value:m,onChange:a=>n(a.target.value),placeholder:"Project Name"})]}),(0,s.jsx)("div",{className:"h-6 w-px bg-white/10"}),(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)("button",{onClick:an,disabled:q,className:"group p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white transition-colors",title:b("save"),children:(0,s.jsx)(f6,{className:`h-4 w-4 ${q?"animate-spin":""}`})}),(0,s.jsx)("button",{onClick:ao,disabled:v,className:"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white transition-colors",title:b("openProject"),children:(0,s.jsx)(f7,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:aq,className:"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white transition-colors",title:b("newProject"),children:(0,s.jsx)(f8,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"pointer-events-auto flex gap-2",children:[(0,s.jsxs)("div",{className:"bg-slate-950/50 backdrop-blur-md p-2 rounded-2xl border border-white/10 shadow-xl flex gap-1",children:[(0,s.jsx)("button",{onClick:aj,disabled:!_,className:"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white disabled:opacity-30",children:(0,s.jsx)(f9,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:ak,disabled:!aa,className:"p-2 rounded-lg hover:bg-white/10 text-slate-400 hover:text-white disabled:opacity-30",children:(0,s.jsx)(ga,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:af,disabled:R,className:"bg-emerald-500 hover:bg-emerald-400 text-white px-4 py-2 rounded-xl text-sm font-semibold shadow-lg shadow-emerald-500/20 transition-all flex items-center gap-2 disabled:opacity-50",children:[R?(0,s.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):(0,s.jsx)(gf.Sparkles,{className:"h-4 w-4"}),R?b("generating"):b("generate")]}),T&&(0,s.jsx)("span",{className:"text-[10px] uppercase tracking-widest text-emerald-200/80",children:T})]}),(0,s.jsxs)("button",{onClick:ae,disabled:D,className:"bg-sky-500 hover:bg-sky-400 text-white px-4 py-2 rounded-xl text-sm font-semibold shadow-lg shadow-sky-500/20 transition-all flex items-center gap-2 disabled:opacity-50",children:[D?(0,s.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):(0,s.jsx)(ge,{className:"h-4 w-4 fill-current"}),D?b("optimizing"):b("run")]})]})]}),(0,s.jsx)(f4.AnimatePresence,{children:B&&(0,s.jsx)(f3.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-20 left-1/2 -translate-x-1/2 z-50 bg-rose-500/90 text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium backdrop-blur",children:B})}),(0,s.jsx)("div",{className:"absolute inset-0 z-0",children:(0,s.jsxs)(fH,{nodes:c,edges:f,onNodesChange:e,onEdgesChange:h,onConnect:ah,onNodeClick:(a,b)=>j(b),fitView:!0,nodeTypes:hD,proOptions:{hideAttribution:!0},minZoom:.2,maxZoom:2,onPaneClick:()=>j(null),children:[(0,s.jsx)(fN,{color:"#334155",gap:40,size:1}),(0,s.jsxs)(dZ,{position:"bottom-right",className:"mb-8 mr-8 flex flex-col gap-2",children:[(0,s.jsx)("button",{className:"bg-slate-900/80 p-2 rounded-lg border border-white/10 text-slate-400 hover:text-white hover:bg-white/10",title:"Zoom In",children:(0,s.jsx)(gc,{className:"h-5 w-5"})}),(0,s.jsx)("button",{className:"bg-slate-900/80 p-2 rounded-lg border border-white/10 text-slate-400 hover:text-white hover:bg-white/10",title:"Zoom Out",children:(0,s.jsx)(gd,{className:"h-5 w-5"})}),(0,s.jsx)("button",{className:"bg-slate-900/80 p-2 rounded-lg border border-white/10 text-slate-400 hover:text-white hover:bg-white/10",title:"Fit View",children:(0,s.jsx)(gb,{className:"h-5 w-5"})})]})]})}),(0,s.jsx)("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-10",children:(0,s.jsx)(f3.motion.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},className:"flex items-center gap-2 p-2 bg-slate-950/60 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-2xl",children:ar.map(a=>(0,s.jsxs)("button",{onClick:()=>ai(a.kind),className:"group relative flex flex-col items-center justify-center w-16 h-16 rounded-xl border border-transparent hover:border-white/10 hover:bg-white/5 transition-all",children:[(0,s.jsx)("div",{className:"h-8 w-8 rounded bg-slate-800 group-hover:bg-sky-500/20 group-hover:text-sky-400 flex items-center justify-center transition-colors text-slate-400 mb-1",children:(0,s.jsx)(gg,{className:"h-5 w-5"})}),(0,s.jsx)("span",{className:"text-[10px] font-medium text-slate-400 group-hover:text-slate-100",children:a.label})]},a.kind))})}),(0,s.jsx)(hs,{selectedNode:i,onClose:()=>j(null),onUpdate:al,onDelete:am}),N&&(0,s.jsx)(hx,{preview:J,isLoading:L,onClose:()=>{O(!1),K(null)}}),W&&(0,s.jsx)(hC,{run:P,isLoading:R,onClose:()=>X(!1)}),(0,s.jsx)(f4.AnimatePresence,{children:z&&(0,s.jsx)(f3.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:()=>A(!1),children:(0,s.jsxs)(f3.motion.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-lg rounded-2xl border border-white/10 bg-slate-950 shadow-2xl overflow-hidden",onClick:a=>a.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-white/5",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:b("openProject")}),(0,s.jsxs)("button",{onClick:()=>A(!1),className:"text-slate-400 hover:text-white",children:[(0,s.jsx)(gb,{className:"h-4 w-4 rotate-45"})," "]})]}),(0,s.jsx)("div",{className:"p-2 max-h-96 overflow-y-auto",children:0===x.length?(0,s.jsx)("div",{className:"p-8 text-center text-slate-500",children:b("noSavedProjects")}):(0,s.jsx)("div",{className:"grid gap-1",children:x.map(a=>(0,s.jsxs)("button",{onClick:()=>ap(a),className:"flex items-center justify-between w-full p-4 rounded-xl hover:bg-white/5 text-left border border-transparent hover:border-white/5 transition-all group",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-slate-200 group-hover:text-sky-400 transition-colors",children:a.title}),(0,s.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:["Updated ",new Date(a.updated_at).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(f7,{className:"h-4 w-4 text-slate-400"})})]},a.id))})})]})})}),(0,s.jsx)(f4.AnimatePresence,{children:H&&F.length>0&&(0,s.jsx)(f3.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,s.jsxs)(f3.motion.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-lg rounded-2xl border border-white/10 bg-slate-950/95 p-6 shadow-2xl backdrop-blur-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-bold text-slate-100",children:b("gaRecommendations")}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:b("topRecommendations")})]}),(0,s.jsx)("button",{onClick:()=>I(!1),className:"p-2 rounded-lg hover:bg-white/5 text-slate-400 hover:text-white",children:(0,s.jsx)(gh.X,{className:"h-4 w-4"})})]}),(0,s.jsx)("div",{className:"space-y-3",children:F.map((a,c)=>(0,s.jsxs)("div",{className:"rounded-xl border border-white/10 bg-slate-900/50 p-4 hover:border-sky-500/30 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("span",{className:"text-xs font-bold text-sky-400 uppercase",children:[b("recommendation")," ",c+1]}),(0,s.jsxs)("span",{className:"text-xs font-mono text-slate-500",children:[b("score"),": ",a.fitness_score.toFixed(1)]})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 text-xs mb-3",children:Object.entries(a.params).slice(0,4).map(([a,b])=>(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-slate-500",children:a.replace(/_/g," ")}),(0,s.jsx)("span",{className:"font-mono text-slate-300",children:"number"==typeof b?b.toFixed(2):String(b)})]},a))}),(0,s.jsx)("button",{onClick:()=>ag(a.params),className:"w-full py-2 rounded-lg bg-sky-500/10 text-sky-400 text-xs font-semibold hover:bg-sky-500/20 transition-colors",children:"Apply This Set"})]},c))})]})})})]})}function hH(){return(0,s.jsx)(fE,{children:(0,s.jsx)(hG,{})})}function hI(){return(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)("div",{className:"h-screen w-screen flex items-center justify-center bg-slate-950 text-slate-400",children:"Loading canvas..."}),children:(0,s.jsx)(hH,{})})}a.s(["default",()=>hI],16646)}];

//# sourceMappingURL=_16a6bd19._.js.map